a5f28abbc7a431575602d6a42056e039
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.staticMoodMergeService = exports.intelligentMergeService = exports.default = void 0;
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _moodDeletionCache = require("./moodDeletionCache");
function intelligentMoodMerge() {
  return _intelligentMoodMerge.apply(this, arguments);
}
function _intelligentMoodMerge() {
  _intelligentMoodMerge = (0, _asyncToGenerator2.default)(function* () {
    var localEntries = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
    var remoteEntries = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    var userId = arguments.length > 2 ? arguments[2] : undefined;
    console.log(`üîÑ Starting static mood merge for user: ${userId || 'unknown'}`);
    var recentlyDeletedIds = [];
    if (userId) {
      try {
        recentlyDeletedIds = yield _moodDeletionCache.moodDeletionCache.getRecentlyDeletedIds(userId);
        console.log(`üóëÔ∏è Found ${recentlyDeletedIds.length} recently deleted entries to filter:`, recentlyDeletedIds);
        if (recentlyDeletedIds.length > 0) {
          console.log(`üîç Will filter entries matching these deleted IDs:`, recentlyDeletedIds.slice(0, 3));
        }
      } catch (error) {
        console.warn('‚ö†Ô∏è Failed to get deletion cache:', error);
      }
    }
    var stats = {
      localCount: localEntries.length,
      remoteCount: remoteEntries.length,
      mergedCount: 0,
      duplicatesRemoved: 0,
      conflictsResolved: 0
    };
    var filteredRemoteEntries = remoteEntries.filter(function (entry) {
      var isDeleted = recentlyDeletedIds.includes(entry.id) || entry.local_id && recentlyDeletedIds.includes(entry.local_id) || entry.remote_id && recentlyDeletedIds.includes(entry.remote_id);
      if (isDeleted) {
        console.log(`üóëÔ∏è Filtering out deleted remote entry: ${entry.id}`);
      }
      return !isDeleted;
    });
    var filteredLocalEntries = localEntries.filter(function (entry) {
      var isDeleted = recentlyDeletedIds.includes(entry.id) || entry.local_id && recentlyDeletedIds.includes(entry.local_id) || entry.remote_id && recentlyDeletedIds.includes(entry.remote_id);
      if (isDeleted) {
        console.log(`üóëÔ∏è DELETION FILTER: Filtering out deleted local entry: ${entry.id}`, {
          matchedBy: recentlyDeletedIds.includes(entry.id) ? 'id' : entry.local_id && recentlyDeletedIds.includes(entry.local_id) ? 'local_id' : 'remote_id',
          deletedIds: recentlyDeletedIds
        });
      }
      return !isDeleted;
    });
    var mergedEntries = (0, _toConsumableArray2.default)(filteredRemoteEntries);
    var remoteIds = new Set(filteredRemoteEntries.map(function (entry) {
      return entry.id;
    }));
    var remoteHashes = new Set(filteredRemoteEntries.map(function (entry) {
      return entry.content_hash;
    }).filter(Boolean));
    var remoteContentHashes = new Set(filteredRemoteEntries.map(function (entry) {
      return entry.content_hash;
    }).filter(Boolean));
    var remoteLocalIds = new Set(filteredRemoteEntries.map(function (entry) {
      return entry.local_id;
    }).filter(Boolean));
    var remoteRemoteIds = new Set(filteredRemoteEntries.map(function (entry) {
      return entry.remote_id || entry.id;
    }).filter(Boolean));
    console.log(`üîç Merge analysis: Remote has ${remoteIds.size} IDs, ${remoteContentHashes.size} content hashes, ${remoteLocalIds.size} local_ids`);
    var localIdCounts = new Map();
    filteredLocalEntries.forEach(function (entry) {
      var count = localIdCounts.get(entry.id) || 0;
      localIdCounts.set(entry.id, count + 1);
    });
    var duplicateLocalIds = Array.from(localIdCounts.entries()).filter(function (_ref) {
      var _ref2 = (0, _slicedToArray2.default)(_ref, 2),
        id = _ref2[0],
        count = _ref2[1];
      return count > 1;
    }).map(function (_ref3) {
      var _ref4 = (0, _slicedToArray2.default)(_ref3, 2),
        id = _ref4[0],
        count = _ref4[1];
      return {
        id: id,
        count: count
      };
    });
    if (duplicateLocalIds.length > 0) {
      console.warn('üö® DUPLICATE LOCAL ENTRIES DETECTED:', duplicateLocalIds);
      duplicateLocalIds.forEach(function (_ref5) {
        var id = _ref5.id,
          count = _ref5.count;
        console.warn(`   ‚ö†Ô∏è ID: ${id} appears ${count} times in local entries`);
      });
    }
    var uniqueLocalEntries = Array.from(new Map(filteredLocalEntries.map(function (entry) {
      return [entry.id, entry];
    })).values());
    if (uniqueLocalEntries.length !== filteredLocalEntries.length) {
      var removedCount = filteredLocalEntries.length - uniqueLocalEntries.length;
      console.log(`üßπ Removed ${removedCount} duplicate local entries before merge`);
    }
    for (var localEntry of uniqueLocalEntries) {
      var shouldSkip = false;
      var skipReason = '';
      if (remoteIds.has(localEntry.id)) {
        shouldSkip = true;
        skipReason = 'exact_id_match';
      }
      if (!shouldSkip && localEntry.local_id && remoteLocalIds.has(localEntry.local_id)) {
        shouldSkip = true;
        skipReason = 'local_id_mapping';
      }
      if (!shouldSkip && localEntry.remote_id && remoteIds.has(localEntry.remote_id)) {
        shouldSkip = true;
        skipReason = 'remote_id_mapping';
      }
      if (!shouldSkip && localEntry.content_hash && remoteContentHashes.has(localEntry.content_hash)) {
        shouldSkip = true;
        skipReason = 'content_hash_duplicate';
        stats.duplicatesRemoved++;
      }
      if (!shouldSkip && !localEntry.content_hash) {
        var tempHash = generateTempContentHash(localEntry);
        if (remoteContentHashes.has(tempHash)) {
          shouldSkip = true;
          skipReason = 'content_similarity';
          stats.duplicatesRemoved++;
        }
      }
      if (shouldSkip) {
        console.log(`üîÑ Skipping local entry ${localEntry.id}: ${skipReason}`);
        continue;
      }
      console.log(`‚ûï Adding unique local entry: ${localEntry.id}`);
      mergedEntries.push(localEntry);
    }
    function generateTempContentHash(entry) {
      var contentText = `${entry.user_id}|${entry.mood_score}|${entry.energy_level}|${entry.anxiety_level}|${(entry.notes || '').trim().toLowerCase()}`;
      var hash = 0;
      for (var i = 0; i < contentText.length; i++) {
        var char = contentText.charCodeAt(i);
        hash = (hash << 5) - hash + char;
        hash = hash & hash;
      }
      return Math.abs(hash).toString(36);
    }
    stats.mergedCount = mergedEntries.length;
    var statsWithSync = Object.assign({}, stats, {
      syncSuccess: true
    });
    mergedEntries.sort(function (a, b) {
      var timeA = new Date(a.created_at || a.timestamp || 0).getTime();
      var timeB = new Date(b.created_at || b.timestamp || 0).getTime();
      return timeB - timeA;
    });
    console.log(`‚úÖ Static merge complete:`, statsWithSync);
    return {
      mergedEntries: mergedEntries,
      conflicts: [],
      stats: statsWithSync
    };
  });
  return _intelligentMoodMerge.apply(this, arguments);
}
function shouldMerge() {
  return _shouldMerge.apply(this, arguments);
}
function _shouldMerge() {
  _shouldMerge = (0, _asyncToGenerator2.default)(function* () {
    return true;
  });
  return _shouldMerge.apply(this, arguments);
}
var staticMoodMergeService = exports.staticMoodMergeService = {
  intelligentMoodMerge: intelligentMoodMerge,
  shouldMerge: shouldMerge
};
var intelligentMergeService = exports.intelligentMergeService = staticMoodMergeService;
var _default = exports.default = staticMoodMergeService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9vZERlbGV0aW9uQ2FjaGUiLCJyZXF1aXJlIiwiaW50ZWxsaWdlbnRNb29kTWVyZ2UiLCJfaW50ZWxsaWdlbnRNb29kTWVyZ2UiLCJhcHBseSIsImFyZ3VtZW50cyIsIl9hc3luY1RvR2VuZXJhdG9yMiIsImRlZmF1bHQiLCJsb2NhbEVudHJpZXMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJyZW1vdGVFbnRyaWVzIiwidXNlcklkIiwiY29uc29sZSIsImxvZyIsInJlY2VudGx5RGVsZXRlZElkcyIsIm1vb2REZWxldGlvbkNhY2hlIiwiZ2V0UmVjZW50bHlEZWxldGVkSWRzIiwic2xpY2UiLCJlcnJvciIsIndhcm4iLCJzdGF0cyIsImxvY2FsQ291bnQiLCJyZW1vdGVDb3VudCIsIm1lcmdlZENvdW50IiwiZHVwbGljYXRlc1JlbW92ZWQiLCJjb25mbGljdHNSZXNvbHZlZCIsImZpbHRlcmVkUmVtb3RlRW50cmllcyIsImZpbHRlciIsImVudHJ5IiwiaXNEZWxldGVkIiwiaW5jbHVkZXMiLCJpZCIsImxvY2FsX2lkIiwicmVtb3RlX2lkIiwiZmlsdGVyZWRMb2NhbEVudHJpZXMiLCJtYXRjaGVkQnkiLCJkZWxldGVkSWRzIiwibWVyZ2VkRW50cmllcyIsIl90b0NvbnN1bWFibGVBcnJheTIiLCJyZW1vdGVJZHMiLCJTZXQiLCJtYXAiLCJyZW1vdGVIYXNoZXMiLCJjb250ZW50X2hhc2giLCJCb29sZWFuIiwicmVtb3RlQ29udGVudEhhc2hlcyIsInJlbW90ZUxvY2FsSWRzIiwicmVtb3RlUmVtb3RlSWRzIiwic2l6ZSIsImxvY2FsSWRDb3VudHMiLCJNYXAiLCJmb3JFYWNoIiwiY291bnQiLCJnZXQiLCJzZXQiLCJkdXBsaWNhdGVMb2NhbElkcyIsIkFycmF5IiwiZnJvbSIsImVudHJpZXMiLCJfcmVmIiwiX3JlZjIiLCJfc2xpY2VkVG9BcnJheTIiLCJfcmVmMyIsIl9yZWY0IiwiX3JlZjUiLCJ1bmlxdWVMb2NhbEVudHJpZXMiLCJ2YWx1ZXMiLCJyZW1vdmVkQ291bnQiLCJsb2NhbEVudHJ5Iiwic2hvdWxkU2tpcCIsInNraXBSZWFzb24iLCJoYXMiLCJ0ZW1wSGFzaCIsImdlbmVyYXRlVGVtcENvbnRlbnRIYXNoIiwicHVzaCIsImNvbnRlbnRUZXh0IiwidXNlcl9pZCIsIm1vb2Rfc2NvcmUiLCJlbmVyZ3lfbGV2ZWwiLCJhbnhpZXR5X2xldmVsIiwibm90ZXMiLCJ0cmltIiwidG9Mb3dlckNhc2UiLCJoYXNoIiwiaSIsImNoYXIiLCJjaGFyQ29kZUF0IiwiTWF0aCIsImFicyIsInRvU3RyaW5nIiwic3RhdHNXaXRoU3luYyIsIk9iamVjdCIsImFzc2lnbiIsInN5bmNTdWNjZXNzIiwic29ydCIsImEiLCJiIiwidGltZUEiLCJEYXRlIiwiY3JlYXRlZF9hdCIsInRpbWVzdGFtcCIsImdldFRpbWUiLCJ0aW1lQiIsImNvbmZsaWN0cyIsInNob3VsZE1lcmdlIiwiX3Nob3VsZE1lcmdlIiwic3RhdGljTW9vZE1lcmdlU2VydmljZSIsImV4cG9ydHMiLCJpbnRlbGxpZ2VudE1lcmdlU2VydmljZSIsIl9kZWZhdWx0Il0sInNvdXJjZXMiOlsic3RhdGljTW9vZE1lcmdlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU3RhdGljIE1vb2QgTWVyZ2UgU2VydmljZVxuICogXG4gKiBBSSB0YWJhbmzEsSBpbnRlbGxpZ2VudE1vb2RNZXJnZVNlcnZpY2UgeWVyaW5lIGt1bGxhbsSxbGFjYWsgYmFzaXQgbWVyZ2Ugc2VydmlzaS5cbiAqIEt1cmFsbGFyOlxuICogMS4gUmVtb3RlIChTdXBhYmFzZSkgdmVyaXNpIGhlciB6YW1hbiBsb2NhbCdhIGfDtnJlIMO2bmNlbGlrbGlcbiAqIDIuIFRpbWVzdGFtcCBiYXpsxLEgY29uZmxpY3QgcmVzb2x1dGlvblxuICogMy4gRHVwbGljYXRlIGRldGVjdGlvbiBjb250ZW50X2hhc2ggaWxlXG4gKi9cblxuaW1wb3J0IHR5cGUgeyBNb29kRW50cnkgfSBmcm9tICdAL3NlcnZpY2VzL21vb2RUcmFja2luZ1NlcnZpY2UnO1xuaW1wb3J0IHsgbW9vZERlbGV0aW9uQ2FjaGUgfSBmcm9tICcuL21vb2REZWxldGlvbkNhY2hlJztcblxuaW50ZXJmYWNlIE1lcmdlUmVzdWx0IHtcbiAgbWVyZ2VkRW50cmllczogTW9vZEVudHJ5W107XG4gIGNvbmZsaWN0czogYW55W107XG4gIHN0YXRzOiB7XG4gICAgbG9jYWxDb3VudDogbnVtYmVyO1xuICAgIHJlbW90ZUNvdW50OiBudW1iZXI7XG4gICAgbWVyZ2VkQ291bnQ6IG51bWJlcjtcbiAgICBkdXBsaWNhdGVzUmVtb3ZlZDogbnVtYmVyO1xuICAgIGNvbmZsaWN0c1Jlc29sdmVkOiBudW1iZXI7XG4gICAgc3luY1N1Y2Nlc3M6IGJvb2xlYW47IC8vIEZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XG4gIH07XG59XG5cbmludGVyZmFjZSBNZXJnZVNlcnZpY2Uge1xuICBpbnRlbGxpZ2VudE1vb2RNZXJnZShcbiAgICBsb2NhbEVudHJpZXM6IE1vb2RFbnRyeVtdLFxuICAgIHJlbW90ZUVudHJpZXM6IE1vb2RFbnRyeVtdLFxuICAgIHVzZXJJZD86IHN0cmluZ1xuICApOiBQcm9taXNlPE1lcmdlUmVzdWx0PjtcbiAgXG4gIHNob3VsZE1lcmdlKC4uLmFyZ3M6IGFueVtdKTogUHJvbWlzZTxib29sZWFuPjtcbn1cblxuLyoqXG4gKiBTaW1wbGUgbWVyZ2UgbG9naWM6XG4gKiAxLiBSZW1vdGUgZW50cmllcyDDtm5jZWxpa2xpIChTdXBhYmFzZSB0cnV0aCBzb3VyY2UpXG4gKiAyLiBMb2NhbC1vbmx5IGVudHJpZXMgcmVtb3RlJ2EgZWtsZW5pclxuICogMy4gRHVwbGljYXRlIGRldGVjdGlvbiBjb250ZW50X2hhc2ggaWxlXG4gKiA0LiBDb25mbGljdCBkdXJ1bXVuZGEgcmVtb3RlIHdpbnNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gaW50ZWxsaWdlbnRNb29kTWVyZ2UoXG4gIGxvY2FsRW50cmllczogTW9vZEVudHJ5W10gPSBbXSxcbiAgcmVtb3RlRW50cmllczogTW9vZEVudHJ5W10gPSBbXSxcbiAgdXNlcklkPzogc3RyaW5nXG4pOiBQcm9taXNlPE1lcmdlUmVzdWx0PiB7XG4gIGNvbnNvbGUubG9nKGDwn5SEIFN0YXJ0aW5nIHN0YXRpYyBtb29kIG1lcmdlIGZvciB1c2VyOiAke3VzZXJJZCB8fCAndW5rbm93bid9YCk7XG4gIFxuICAvLyDwn5eR77iPIENSSVRJQ0FMIEZJWDogRmlsdGVyIGRlbGV0ZWQgZW50cmllcyBiZWZvcmUgbWVyZ2VcbiAgbGV0IHJlY2VudGx5RGVsZXRlZElkczogc3RyaW5nW10gPSBbXTtcbiAgaWYgKHVzZXJJZCkge1xuICAgIHRyeSB7XG4gICAgICByZWNlbnRseURlbGV0ZWRJZHMgPSBhd2FpdCBtb29kRGVsZXRpb25DYWNoZS5nZXRSZWNlbnRseURlbGV0ZWRJZHModXNlcklkKTtcbiAgICAgIGNvbnNvbGUubG9nKGDwn5eR77iPIEZvdW5kICR7cmVjZW50bHlEZWxldGVkSWRzLmxlbmd0aH0gcmVjZW50bHkgZGVsZXRlZCBlbnRyaWVzIHRvIGZpbHRlcjpgLCByZWNlbnRseURlbGV0ZWRJZHMpO1xuICAgICAgXG4gICAgICAvLyDwn5SNIERFQlVHOiBMb2cgd2hhdCB3ZSdyZSBmaWx0ZXJpbmcgYWdhaW5zdFxuICAgICAgaWYgKHJlY2VudGx5RGVsZXRlZElkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5SNIFdpbGwgZmlsdGVyIGVudHJpZXMgbWF0Y2hpbmcgdGhlc2UgZGVsZXRlZCBJRHM6YCwgcmVjZW50bHlEZWxldGVkSWRzLnNsaWNlKDAsIDMpKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gRmFpbGVkIHRvIGdldCBkZWxldGlvbiBjYWNoZTonLCBlcnJvcik7XG4gICAgfVxuICB9XG4gIFxuICBjb25zdCBzdGF0cyA9IHtcbiAgICBsb2NhbENvdW50OiBsb2NhbEVudHJpZXMubGVuZ3RoLFxuICAgIHJlbW90ZUNvdW50OiByZW1vdGVFbnRyaWVzLmxlbmd0aCxcbiAgICBtZXJnZWRDb3VudDogMCxcbiAgICBkdXBsaWNhdGVzUmVtb3ZlZDogMCxcbiAgICBjb25mbGljdHNSZXNvbHZlZDogMFxuICB9O1xuXG4gIC8vIPCfl5HvuI8gQ1JJVElDQUwgRklYOiBGaWx0ZXIgb3V0IGRlbGV0ZWQgZW50cmllcyBmcm9tIGJvdGggbG9jYWwgYW5kIHJlbW90ZVxuICBjb25zdCBmaWx0ZXJlZFJlbW90ZUVudHJpZXMgPSByZW1vdGVFbnRyaWVzLmZpbHRlcihlbnRyeSA9PiB7XG4gICAgY29uc3QgaXNEZWxldGVkID0gcmVjZW50bHlEZWxldGVkSWRzLmluY2x1ZGVzKGVudHJ5LmlkKSB8fCBcbiAgICAgICAgICAgICAgICAgICAgIChlbnRyeS5sb2NhbF9pZCAmJiByZWNlbnRseURlbGV0ZWRJZHMuaW5jbHVkZXMoZW50cnkubG9jYWxfaWQpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgKGVudHJ5LnJlbW90ZV9pZCAmJiByZWNlbnRseURlbGV0ZWRJZHMuaW5jbHVkZXMoZW50cnkucmVtb3RlX2lkKSk7XG4gICAgaWYgKGlzRGVsZXRlZCkge1xuICAgICAgY29uc29sZS5sb2coYPCfl5HvuI8gRmlsdGVyaW5nIG91dCBkZWxldGVkIHJlbW90ZSBlbnRyeTogJHtlbnRyeS5pZH1gKTtcbiAgICB9XG4gICAgcmV0dXJuICFpc0RlbGV0ZWQ7XG4gIH0pO1xuICBcbiAgY29uc3QgZmlsdGVyZWRMb2NhbEVudHJpZXMgPSBsb2NhbEVudHJpZXMuZmlsdGVyKGVudHJ5ID0+IHtcbiAgICBjb25zdCBpc0RlbGV0ZWQgPSByZWNlbnRseURlbGV0ZWRJZHMuaW5jbHVkZXMoZW50cnkuaWQpIHx8IFxuICAgICAgICAgICAgICAgICAgICAgKGVudHJ5LmxvY2FsX2lkICYmIHJlY2VudGx5RGVsZXRlZElkcy5pbmNsdWRlcyhlbnRyeS5sb2NhbF9pZCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAoZW50cnkucmVtb3RlX2lkICYmIHJlY2VudGx5RGVsZXRlZElkcy5pbmNsdWRlcyhlbnRyeS5yZW1vdGVfaWQpKTtcbiAgICBpZiAoaXNEZWxldGVkKSB7XG4gICAgICBjb25zb2xlLmxvZyhg8J+Xke+4jyBERUxFVElPTiBGSUxURVI6IEZpbHRlcmluZyBvdXQgZGVsZXRlZCBsb2NhbCBlbnRyeTogJHtlbnRyeS5pZH1gLCB7XG4gICAgICAgIG1hdGNoZWRCeTogcmVjZW50bHlEZWxldGVkSWRzLmluY2x1ZGVzKGVudHJ5LmlkKSA/ICdpZCcgOiBcbiAgICAgICAgICAgICAgICAgIChlbnRyeS5sb2NhbF9pZCAmJiByZWNlbnRseURlbGV0ZWRJZHMuaW5jbHVkZXMoZW50cnkubG9jYWxfaWQpKSA/ICdsb2NhbF9pZCcgOlxuICAgICAgICAgICAgICAgICAgJ3JlbW90ZV9pZCcsXG4gICAgICAgIGRlbGV0ZWRJZHM6IHJlY2VudGx5RGVsZXRlZElkc1xuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiAhaXNEZWxldGVkO1xuICB9KTtcblxuICAvLyBSZW1vdGUgZW50cmllcydpIGJhc2Ugb2xhcmFrIGFsICh0cnV0aCBzb3VyY2UpIC0gZmlsdGVyZWRcbiAgY29uc3QgbWVyZ2VkRW50cmllcyA9IFsuLi5maWx0ZXJlZFJlbW90ZUVudHJpZXNdO1xuICBjb25zdCByZW1vdGVJZHMgPSBuZXcgU2V0KGZpbHRlcmVkUmVtb3RlRW50cmllcy5tYXAoZW50cnkgPT4gZW50cnkuaWQpKTtcbiAgY29uc3QgcmVtb3RlSGFzaGVzID0gbmV3IFNldChmaWx0ZXJlZFJlbW90ZUVudHJpZXMubWFwKGVudHJ5ID0+IGVudHJ5LmNvbnRlbnRfaGFzaCkuZmlsdGVyKEJvb2xlYW4pKTtcblxuICAvLyDwn5SNIEVOSEFOQ0VEIERVUExJQ0FURSBERVRFQ1RJT046IEJ1aWxkIGNvbXByZWhlbnNpdmUgSUQgYW5kIGNvbnRlbnQgbWFwcyAtIGZyb20gZmlsdGVyZWQgZW50cmllc1xuICBjb25zdCByZW1vdGVDb250ZW50SGFzaGVzID0gbmV3IFNldChmaWx0ZXJlZFJlbW90ZUVudHJpZXMubWFwKGVudHJ5ID0+IGVudHJ5LmNvbnRlbnRfaGFzaCkuZmlsdGVyKEJvb2xlYW4pKTtcbiAgY29uc3QgcmVtb3RlTG9jYWxJZHMgPSBuZXcgU2V0KGZpbHRlcmVkUmVtb3RlRW50cmllcy5tYXAoZW50cnkgPT4gZW50cnkubG9jYWxfaWQpLmZpbHRlcihCb29sZWFuKSk7XG4gIGNvbnN0IHJlbW90ZVJlbW90ZUlkcyA9IG5ldyBTZXQoZmlsdGVyZWRSZW1vdGVFbnRyaWVzLm1hcChlbnRyeSA9PiBlbnRyeS5yZW1vdGVfaWQgfHwgZW50cnkuaWQpLmZpbHRlcihCb29sZWFuKSk7XG5cbiAgY29uc29sZS5sb2coYPCflI0gTWVyZ2UgYW5hbHlzaXM6IFJlbW90ZSBoYXMgJHtyZW1vdGVJZHMuc2l6ZX0gSURzLCAke3JlbW90ZUNvbnRlbnRIYXNoZXMuc2l6ZX0gY29udGVudCBoYXNoZXMsICR7cmVtb3RlTG9jYWxJZHMuc2l6ZX0gbG9jYWxfaWRzYCk7XG5cbiAgLy8g8J+QmyBERUJVRzogQ2hlY2sgZm9yIGR1cGxpY2F0ZSBsb2NhbCBlbnRyaWVzIGJlZm9yZSBwcm9jZXNzaW5nXG4gIGNvbnN0IGxvY2FsSWRDb3VudHMgPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpO1xuICBmaWx0ZXJlZExvY2FsRW50cmllcy5mb3JFYWNoKGVudHJ5ID0+IHtcbiAgICBjb25zdCBjb3VudCA9IGxvY2FsSWRDb3VudHMuZ2V0KGVudHJ5LmlkKSB8fCAwO1xuICAgIGxvY2FsSWRDb3VudHMuc2V0KGVudHJ5LmlkLCBjb3VudCArIDEpO1xuICB9KTtcbiAgXG4gIGNvbnN0IGR1cGxpY2F0ZUxvY2FsSWRzID0gQXJyYXkuZnJvbShsb2NhbElkQ291bnRzLmVudHJpZXMoKSlcbiAgICAuZmlsdGVyKChbaWQsIGNvdW50XSkgPT4gY291bnQgPiAxKVxuICAgIC5tYXAoKFtpZCwgY291bnRdKSA9PiAoeyBpZCwgY291bnQgfSkpO1xuICBcbiAgaWYgKGR1cGxpY2F0ZUxvY2FsSWRzLmxlbmd0aCA+IDApIHtcbiAgICBjb25zb2xlLndhcm4oJ/CfmqggRFVQTElDQVRFIExPQ0FMIEVOVFJJRVMgREVURUNURUQ6JywgZHVwbGljYXRlTG9jYWxJZHMpO1xuICAgIGR1cGxpY2F0ZUxvY2FsSWRzLmZvckVhY2goKHsgaWQsIGNvdW50IH0pID0+IHtcbiAgICAgIGNvbnNvbGUud2FybihgICAg4pqg77iPIElEOiAke2lkfSBhcHBlYXJzICR7Y291bnR9IHRpbWVzIGluIGxvY2FsIGVudHJpZXNgKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIPCflKcgQ1JJVElDQUwgRklYOiBEZWR1cGxpY2F0ZSBsb2NhbCBlbnRyaWVzIGJ5IElEIGJlZm9yZSBwcm9jZXNzaW5nXG4gIGNvbnN0IHVuaXF1ZUxvY2FsRW50cmllcyA9IEFycmF5LmZyb20oXG4gICAgbmV3IE1hcChmaWx0ZXJlZExvY2FsRW50cmllcy5tYXAoZW50cnkgPT4gW2VudHJ5LmlkLCBlbnRyeV0pKS52YWx1ZXMoKVxuICApO1xuICBcbiAgaWYgKHVuaXF1ZUxvY2FsRW50cmllcy5sZW5ndGggIT09IGZpbHRlcmVkTG9jYWxFbnRyaWVzLmxlbmd0aCkge1xuICAgIGNvbnN0IHJlbW92ZWRDb3VudCA9IGZpbHRlcmVkTG9jYWxFbnRyaWVzLmxlbmd0aCAtIHVuaXF1ZUxvY2FsRW50cmllcy5sZW5ndGg7XG4gICAgY29uc29sZS5sb2coYPCfp7kgUmVtb3ZlZCAke3JlbW92ZWRDb3VudH0gZHVwbGljYXRlIGxvY2FsIGVudHJpZXMgYmVmb3JlIG1lcmdlYCk7XG4gIH1cblxuICAvLyBMb2NhbCBlbnRyaWVzJ2RlbiByZW1vdGUnZGEgb2xtYXlhbiB2ZSBkdXBsaWNhdGUgb2xtYXlhbidsYXLEsSBla2xlIC0gZnJvbSBkZWR1cGxpY2F0ZWQgZW50cmllc1xuICBmb3IgKGNvbnN0IGxvY2FsRW50cnkgb2YgdW5pcXVlTG9jYWxFbnRyaWVzKSB7XG4gICAgbGV0IHNob3VsZFNraXAgPSBmYWxzZTtcbiAgICBsZXQgc2tpcFJlYXNvbiA9ICcnO1xuXG4gICAgLy8gMS4gRVhBQ1QgSUQgTUFUQ0ggQ0hFQ0sgKG9yaWdpbmFsIGxvZ2ljKVxuICAgIGlmIChyZW1vdGVJZHMuaGFzKGxvY2FsRW50cnkuaWQpKSB7XG4gICAgICBzaG91bGRTa2lwID0gdHJ1ZTtcbiAgICAgIHNraXBSZWFzb24gPSAnZXhhY3RfaWRfbWF0Y2gnO1xuICAgIH1cblxuICAgIC8vIDIuIExPQ0FMX0lEIE1BUFBJTkcgQ0hFQ0sgKG5ldyAtIGNyaXRpY2FsIGZvciBtb29kX3h4eCDihpQgVVVJRCBtYXBwaW5nKVxuICAgIGlmICghc2hvdWxkU2tpcCAmJiBsb2NhbEVudHJ5LmxvY2FsX2lkICYmIHJlbW90ZUxvY2FsSWRzLmhhcyhsb2NhbEVudHJ5LmxvY2FsX2lkKSkge1xuICAgICAgc2hvdWxkU2tpcCA9IHRydWU7IFxuICAgICAgc2tpcFJlYXNvbiA9ICdsb2NhbF9pZF9tYXBwaW5nJztcbiAgICB9XG5cbiAgICAvLyAzLiBSRU1PVEVfSUQgTUFQUElORyBDSEVDSyAobmV3IC0gZm9yIFVVSUQgZW50cmllcylcbiAgICBpZiAoIXNob3VsZFNraXAgJiYgbG9jYWxFbnRyeS5yZW1vdGVfaWQgJiYgcmVtb3RlSWRzLmhhcyhsb2NhbEVudHJ5LnJlbW90ZV9pZCkpIHtcbiAgICAgIHNob3VsZFNraXAgPSB0cnVlO1xuICAgICAgc2tpcFJlYXNvbiA9ICdyZW1vdGVfaWRfbWFwcGluZyc7ICBcbiAgICB9XG5cbiAgICAvLyA0LiBDT05URU5UIEhBU0ggQ0hFQ0sgKGVuaGFuY2VkKVxuICAgIGlmICghc2hvdWxkU2tpcCAmJiBsb2NhbEVudHJ5LmNvbnRlbnRfaGFzaCAmJiByZW1vdGVDb250ZW50SGFzaGVzLmhhcyhsb2NhbEVudHJ5LmNvbnRlbnRfaGFzaCkpIHtcbiAgICAgIHNob3VsZFNraXAgPSB0cnVlO1xuICAgICAgc2tpcFJlYXNvbiA9ICdjb250ZW50X2hhc2hfZHVwbGljYXRlJztcbiAgICAgIHN0YXRzLmR1cGxpY2F0ZXNSZW1vdmVkKys7XG4gICAgfVxuXG4gICAgLy8gNS4gRkFMTEJBQ0sgQ09OVEVOVCBTSU1JTEFSSVRZIENIRUNLIChuZXcgLSBmb3IgZW50cmllcyB3aXRob3V0IGNvbnRlbnRfaGFzaClcbiAgICBpZiAoIXNob3VsZFNraXAgJiYgIWxvY2FsRW50cnkuY29udGVudF9oYXNoKSB7XG4gICAgICAvLyBHZW5lcmF0ZSB0ZW1wb3JhcnkgY29udGVudCBoYXNoIGZvciBjb21wYXJpc29uXG4gICAgICBjb25zdCB0ZW1wSGFzaCA9IGdlbmVyYXRlVGVtcENvbnRlbnRIYXNoKGxvY2FsRW50cnkpO1xuICAgICAgaWYgKHJlbW90ZUNvbnRlbnRIYXNoZXMuaGFzKHRlbXBIYXNoKSkge1xuICAgICAgICBzaG91bGRTa2lwID0gdHJ1ZTtcbiAgICAgICAgc2tpcFJlYXNvbiA9ICdjb250ZW50X3NpbWlsYXJpdHknO1xuICAgICAgICBzdGF0cy5kdXBsaWNhdGVzUmVtb3ZlZCsrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzaG91bGRTa2lwKSB7XG4gICAgICBjb25zb2xlLmxvZyhg8J+UhCBTa2lwcGluZyBsb2NhbCBlbnRyeSAke2xvY2FsRW50cnkuaWR9OiAke3NraXBSZWFzb259YCk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICAvLyBCdSBsb2NhbCBlbnRyeSBiZW56ZXJzaXosIGVrbGVcbiAgICBjb25zb2xlLmxvZyhg4p6VIEFkZGluZyB1bmlxdWUgbG9jYWwgZW50cnk6ICR7bG9jYWxFbnRyeS5pZH1gKTtcbiAgICBtZXJnZWRFbnRyaWVzLnB1c2gobG9jYWxFbnRyeSk7XG4gIH1cblxuICAvLyBIZWxwZXIgZnVuY3Rpb24gZm9yIGNvbnRlbnQgaGFzaCBnZW5lcmF0aW9uXG4gIGZ1bmN0aW9uIGdlbmVyYXRlVGVtcENvbnRlbnRIYXNoKGVudHJ5OiBNb29kRW50cnkpOiBzdHJpbmcge1xuICAgIGNvbnN0IGNvbnRlbnRUZXh0ID0gYCR7ZW50cnkudXNlcl9pZH18JHtlbnRyeS5tb29kX3Njb3JlfXwke2VudHJ5LmVuZXJneV9sZXZlbH18JHtlbnRyeS5hbnhpZXR5X2xldmVsfXwkeyhlbnRyeS5ub3RlcyB8fCAnJykudHJpbSgpLnRvTG93ZXJDYXNlKCl9YDtcbiAgICBsZXQgaGFzaCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb250ZW50VGV4dC5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgY2hhciA9IGNvbnRlbnRUZXh0LmNoYXJDb2RlQXQoaSk7XG4gICAgICBoYXNoID0gKChoYXNoIDw8IDUpIC0gaGFzaCkgKyBjaGFyO1xuICAgICAgaGFzaCA9IGhhc2ggJiBoYXNoO1xuICAgIH1cbiAgICByZXR1cm4gTWF0aC5hYnMoaGFzaCkudG9TdHJpbmcoMzYpO1xuICB9XG5cbiAgc3RhdHMubWVyZ2VkQ291bnQgPSBtZXJnZWRFbnRyaWVzLmxlbmd0aDtcbiAgXG4gIC8vIEFkZCBzeW5jU3VjY2VzcyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuICBjb25zdCBzdGF0c1dpdGhTeW5jID0ge1xuICAgIC4uLnN0YXRzLFxuICAgIHN5bmNTdWNjZXNzOiB0cnVlIC8vIFN0YXRpYyBtZXJnZSBhbHdheXMgc3VjY2VlZHNcbiAgfTtcblxuICAvLyBUaW1lc3RhbXAnYSBnw7ZyZSBzxLFyYWxhIChlbiB5ZW5pIGVuIGJhxZ90YSlcbiAgbWVyZ2VkRW50cmllcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgY29uc3QgdGltZUEgPSBuZXcgRGF0ZShhLmNyZWF0ZWRfYXQgfHwgYS50aW1lc3RhbXAgfHwgMCkuZ2V0VGltZSgpO1xuICAgIGNvbnN0IHRpbWVCID0gbmV3IERhdGUoYi5jcmVhdGVkX2F0IHx8IGIudGltZXN0YW1wIHx8IDApLmdldFRpbWUoKTtcbiAgICByZXR1cm4gdGltZUIgLSB0aW1lQTtcbiAgfSk7XG5cbiAgY29uc29sZS5sb2coYOKchSBTdGF0aWMgbWVyZ2UgY29tcGxldGU6YCwgc3RhdHNXaXRoU3luYyk7XG5cbiAgcmV0dXJuIHtcbiAgICBtZXJnZWRFbnRyaWVzLFxuICAgIGNvbmZsaWN0czogW10sIC8vIFN0YXRpYyBtZXJnZSdkZSBjb25mbGljdCB5b2ssIHJlbW90ZSB3aW5zXG4gICAgc3RhdHM6IHN0YXRzV2l0aFN5bmNcbiAgfTtcbn1cblxuLyoqXG4gKiBIZXIgemFtYW4gbWVyZ2UnZSBpemluIHZlciAoQUkgbG9naWMgeW9rKVxuICovXG5hc3luYyBmdW5jdGlvbiBzaG91bGRNZXJnZSguLi5hcmdzOiBhbnlbXSk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGNvbnN0IHN0YXRpY01vb2RNZXJnZVNlcnZpY2U6IE1lcmdlU2VydmljZSA9IHtcbiAgaW50ZWxsaWdlbnRNb29kTWVyZ2UsXG4gIHNob3VsZE1lcmdlXG59O1xuXG4vLyBCYWNrd2FyZCBjb21wYXRpYmlsaXR5IGnDp2luIGV4cG9ydFxuZXhwb3J0IGNvbnN0IGludGVsbGlnZW50TWVyZ2VTZXJ2aWNlID0gc3RhdGljTW9vZE1lcmdlU2VydmljZTtcblxuZXhwb3J0IGRlZmF1bHQgc3RhdGljTW9vZE1lcmdlU2VydmljZTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFXQSxJQUFBQSxrQkFBQSxHQUFBQyxPQUFBO0FBQXdELFNBZ0N6Q0Msb0JBQW9CQSxDQUFBO0VBQUEsT0FBQUMscUJBQUEsQ0FBQUMsS0FBQSxPQUFBQyxTQUFBO0FBQUE7QUFBQSxTQUFBRixzQkFBQTtFQUFBQSxxQkFBQSxPQUFBRyxrQkFBQSxDQUFBQyxPQUFBLEVBQW5DLGFBSXdCO0lBQUEsSUFIdEJDLFlBQXlCLEdBQUFILFNBQUEsQ0FBQUksTUFBQSxRQUFBSixTQUFBLFFBQUFLLFNBQUEsR0FBQUwsU0FBQSxNQUFHLEVBQUU7SUFBQSxJQUM5Qk0sYUFBMEIsR0FBQU4sU0FBQSxDQUFBSSxNQUFBLFFBQUFKLFNBQUEsUUFBQUssU0FBQSxHQUFBTCxTQUFBLE1BQUcsRUFBRTtJQUFBLElBQy9CTyxNQUFlLEdBQUFQLFNBQUEsQ0FBQUksTUFBQSxPQUFBSixTQUFBLE1BQUFLLFNBQUE7SUFFZkcsT0FBTyxDQUFDQyxHQUFHLENBQUMsMkNBQTJDRixNQUFNLElBQUksU0FBUyxFQUFFLENBQUM7SUFHN0UsSUFBSUcsa0JBQTRCLEdBQUcsRUFBRTtJQUNyQyxJQUFJSCxNQUFNLEVBQUU7TUFDVixJQUFJO1FBQ0ZHLGtCQUFrQixTQUFTQyxvQ0FBaUIsQ0FBQ0MscUJBQXFCLENBQUNMLE1BQU0sQ0FBQztRQUMxRUMsT0FBTyxDQUFDQyxHQUFHLENBQUMsYUFBYUMsa0JBQWtCLENBQUNOLE1BQU0sc0NBQXNDLEVBQUVNLGtCQUFrQixDQUFDO1FBRzdHLElBQUlBLGtCQUFrQixDQUFDTixNQUFNLEdBQUcsQ0FBQyxFQUFFO1VBQ2pDSSxPQUFPLENBQUNDLEdBQUcsQ0FBQyxvREFBb0QsRUFBRUMsa0JBQWtCLENBQUNHLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDbkc7TUFDRixDQUFDLENBQUMsT0FBT0MsS0FBSyxFQUFFO1FBQ2ROLE9BQU8sQ0FBQ08sSUFBSSxDQUFDLGtDQUFrQyxFQUFFRCxLQUFLLENBQUM7TUFDekQ7SUFDRjtJQUVBLElBQU1FLEtBQUssR0FBRztNQUNaQyxVQUFVLEVBQUVkLFlBQVksQ0FBQ0MsTUFBTTtNQUMvQmMsV0FBVyxFQUFFWixhQUFhLENBQUNGLE1BQU07TUFDakNlLFdBQVcsRUFBRSxDQUFDO01BQ2RDLGlCQUFpQixFQUFFLENBQUM7TUFDcEJDLGlCQUFpQixFQUFFO0lBQ3JCLENBQUM7SUFHRCxJQUFNQyxxQkFBcUIsR0FBR2hCLGFBQWEsQ0FBQ2lCLE1BQU0sQ0FBQyxVQUFBQyxLQUFLLEVBQUk7TUFDMUQsSUFBTUMsU0FBUyxHQUFHZixrQkFBa0IsQ0FBQ2dCLFFBQVEsQ0FBQ0YsS0FBSyxDQUFDRyxFQUFFLENBQUMsSUFDckNILEtBQUssQ0FBQ0ksUUFBUSxJQUFJbEIsa0JBQWtCLENBQUNnQixRQUFRLENBQUNGLEtBQUssQ0FBQ0ksUUFBUSxDQUFFLElBQzlESixLQUFLLENBQUNLLFNBQVMsSUFBSW5CLGtCQUFrQixDQUFDZ0IsUUFBUSxDQUFDRixLQUFLLENBQUNLLFNBQVMsQ0FBRTtNQUNsRixJQUFJSixTQUFTLEVBQUU7UUFDYmpCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLDJDQUEyQ2UsS0FBSyxDQUFDRyxFQUFFLEVBQUUsQ0FBQztNQUNwRTtNQUNBLE9BQU8sQ0FBQ0YsU0FBUztJQUNuQixDQUFDLENBQUM7SUFFRixJQUFNSyxvQkFBb0IsR0FBRzNCLFlBQVksQ0FBQ29CLE1BQU0sQ0FBQyxVQUFBQyxLQUFLLEVBQUk7TUFDeEQsSUFBTUMsU0FBUyxHQUFHZixrQkFBa0IsQ0FBQ2dCLFFBQVEsQ0FBQ0YsS0FBSyxDQUFDRyxFQUFFLENBQUMsSUFDckNILEtBQUssQ0FBQ0ksUUFBUSxJQUFJbEIsa0JBQWtCLENBQUNnQixRQUFRLENBQUNGLEtBQUssQ0FBQ0ksUUFBUSxDQUFFLElBQzlESixLQUFLLENBQUNLLFNBQVMsSUFBSW5CLGtCQUFrQixDQUFDZ0IsUUFBUSxDQUFDRixLQUFLLENBQUNLLFNBQVMsQ0FBRTtNQUNsRixJQUFJSixTQUFTLEVBQUU7UUFDYmpCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLDJEQUEyRGUsS0FBSyxDQUFDRyxFQUFFLEVBQUUsRUFBRTtVQUNqRkksU0FBUyxFQUFFckIsa0JBQWtCLENBQUNnQixRQUFRLENBQUNGLEtBQUssQ0FBQ0csRUFBRSxDQUFDLEdBQUcsSUFBSSxHQUM1Q0gsS0FBSyxDQUFDSSxRQUFRLElBQUlsQixrQkFBa0IsQ0FBQ2dCLFFBQVEsQ0FBQ0YsS0FBSyxDQUFDSSxRQUFRLENBQUMsR0FBSSxVQUFVLEdBQzVFLFdBQVc7VUFDckJJLFVBQVUsRUFBRXRCO1FBQ2QsQ0FBQyxDQUFDO01BQ0o7TUFDQSxPQUFPLENBQUNlLFNBQVM7SUFDbkIsQ0FBQyxDQUFDO0lBR0YsSUFBTVEsYUFBYSxPQUFBQyxtQkFBQSxDQUFBaEMsT0FBQSxFQUFPb0IscUJBQXFCLENBQUM7SUFDaEQsSUFBTWEsU0FBUyxHQUFHLElBQUlDLEdBQUcsQ0FBQ2QscUJBQXFCLENBQUNlLEdBQUcsQ0FBQyxVQUFBYixLQUFLO01BQUEsT0FBSUEsS0FBSyxDQUFDRyxFQUFFO0lBQUEsRUFBQyxDQUFDO0lBQ3ZFLElBQU1XLFlBQVksR0FBRyxJQUFJRixHQUFHLENBQUNkLHFCQUFxQixDQUFDZSxHQUFHLENBQUMsVUFBQWIsS0FBSztNQUFBLE9BQUlBLEtBQUssQ0FBQ2UsWUFBWTtJQUFBLEVBQUMsQ0FBQ2hCLE1BQU0sQ0FBQ2lCLE9BQU8sQ0FBQyxDQUFDO0lBR3BHLElBQU1DLG1CQUFtQixHQUFHLElBQUlMLEdBQUcsQ0FBQ2QscUJBQXFCLENBQUNlLEdBQUcsQ0FBQyxVQUFBYixLQUFLO01BQUEsT0FBSUEsS0FBSyxDQUFDZSxZQUFZO0lBQUEsRUFBQyxDQUFDaEIsTUFBTSxDQUFDaUIsT0FBTyxDQUFDLENBQUM7SUFDM0csSUFBTUUsY0FBYyxHQUFHLElBQUlOLEdBQUcsQ0FBQ2QscUJBQXFCLENBQUNlLEdBQUcsQ0FBQyxVQUFBYixLQUFLO01BQUEsT0FBSUEsS0FBSyxDQUFDSSxRQUFRO0lBQUEsRUFBQyxDQUFDTCxNQUFNLENBQUNpQixPQUFPLENBQUMsQ0FBQztJQUNsRyxJQUFNRyxlQUFlLEdBQUcsSUFBSVAsR0FBRyxDQUFDZCxxQkFBcUIsQ0FBQ2UsR0FBRyxDQUFDLFVBQUFiLEtBQUs7TUFBQSxPQUFJQSxLQUFLLENBQUNLLFNBQVMsSUFBSUwsS0FBSyxDQUFDRyxFQUFFO0lBQUEsRUFBQyxDQUFDSixNQUFNLENBQUNpQixPQUFPLENBQUMsQ0FBQztJQUVoSGhDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGlDQUFpQzBCLFNBQVMsQ0FBQ1MsSUFBSSxTQUFTSCxtQkFBbUIsQ0FBQ0csSUFBSSxvQkFBb0JGLGNBQWMsQ0FBQ0UsSUFBSSxZQUFZLENBQUM7SUFHaEosSUFBTUMsYUFBYSxHQUFHLElBQUlDLEdBQUcsQ0FBaUIsQ0FBQztJQUMvQ2hCLG9CQUFvQixDQUFDaUIsT0FBTyxDQUFDLFVBQUF2QixLQUFLLEVBQUk7TUFDcEMsSUFBTXdCLEtBQUssR0FBR0gsYUFBYSxDQUFDSSxHQUFHLENBQUN6QixLQUFLLENBQUNHLEVBQUUsQ0FBQyxJQUFJLENBQUM7TUFDOUNrQixhQUFhLENBQUNLLEdBQUcsQ0FBQzFCLEtBQUssQ0FBQ0csRUFBRSxFQUFFcUIsS0FBSyxHQUFHLENBQUMsQ0FBQztJQUN4QyxDQUFDLENBQUM7SUFFRixJQUFNRyxpQkFBaUIsR0FBR0MsS0FBSyxDQUFDQyxJQUFJLENBQUNSLGFBQWEsQ0FBQ1MsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUMxRC9CLE1BQU0sQ0FBQyxVQUFBZ0MsSUFBQTtNQUFBLElBQUFDLEtBQUEsT0FBQUMsZUFBQSxDQUFBdkQsT0FBQSxFQUFBcUQsSUFBQTtRQUFFNUIsRUFBRSxHQUFBNkIsS0FBQTtRQUFFUixLQUFLLEdBQUFRLEtBQUE7TUFBQSxPQUFNUixLQUFLLEdBQUcsQ0FBQztJQUFBLEVBQUMsQ0FDbENYLEdBQUcsQ0FBQyxVQUFBcUIsS0FBQTtNQUFBLElBQUFDLEtBQUEsT0FBQUYsZUFBQSxDQUFBdkQsT0FBQSxFQUFBd0QsS0FBQTtRQUFFL0IsRUFBRSxHQUFBZ0MsS0FBQTtRQUFFWCxLQUFLLEdBQUFXLEtBQUE7TUFBQSxPQUFPO1FBQUVoQyxFQUFFLEVBQUZBLEVBQUU7UUFBRXFCLEtBQUssRUFBTEE7TUFBTSxDQUFDO0lBQUEsQ0FBQyxDQUFDO0lBRXhDLElBQUlHLGlCQUFpQixDQUFDL0MsTUFBTSxHQUFHLENBQUMsRUFBRTtNQUNoQ0ksT0FBTyxDQUFDTyxJQUFJLENBQUMsc0NBQXNDLEVBQUVvQyxpQkFBaUIsQ0FBQztNQUN2RUEsaUJBQWlCLENBQUNKLE9BQU8sQ0FBQyxVQUFBYSxLQUFBLEVBQW1CO1FBQUEsSUFBaEJqQyxFQUFFLEdBQUFpQyxLQUFBLENBQUZqQyxFQUFFO1VBQUVxQixLQUFLLEdBQUFZLEtBQUEsQ0FBTFosS0FBSztRQUNwQ3hDLE9BQU8sQ0FBQ08sSUFBSSxDQUFDLGFBQWFZLEVBQUUsWUFBWXFCLEtBQUsseUJBQXlCLENBQUM7TUFDekUsQ0FBQyxDQUFDO0lBQ0o7SUFHQSxJQUFNYSxrQkFBa0IsR0FBR1QsS0FBSyxDQUFDQyxJQUFJLENBQ25DLElBQUlQLEdBQUcsQ0FBQ2hCLG9CQUFvQixDQUFDTyxHQUFHLENBQUMsVUFBQWIsS0FBSztNQUFBLE9BQUksQ0FBQ0EsS0FBSyxDQUFDRyxFQUFFLEVBQUVILEtBQUssQ0FBQztJQUFBLEVBQUMsQ0FBQyxDQUFDc0MsTUFBTSxDQUFDLENBQ3ZFLENBQUM7SUFFRCxJQUFJRCxrQkFBa0IsQ0FBQ3pELE1BQU0sS0FBSzBCLG9CQUFvQixDQUFDMUIsTUFBTSxFQUFFO01BQzdELElBQU0yRCxZQUFZLEdBQUdqQyxvQkFBb0IsQ0FBQzFCLE1BQU0sR0FBR3lELGtCQUFrQixDQUFDekQsTUFBTTtNQUM1RUksT0FBTyxDQUFDQyxHQUFHLENBQUMsY0FBY3NELFlBQVksdUNBQXVDLENBQUM7SUFDaEY7SUFHQSxLQUFLLElBQU1DLFVBQVUsSUFBSUgsa0JBQWtCLEVBQUU7TUFDM0MsSUFBSUksVUFBVSxHQUFHLEtBQUs7TUFDdEIsSUFBSUMsVUFBVSxHQUFHLEVBQUU7TUFHbkIsSUFBSS9CLFNBQVMsQ0FBQ2dDLEdBQUcsQ0FBQ0gsVUFBVSxDQUFDckMsRUFBRSxDQUFDLEVBQUU7UUFDaENzQyxVQUFVLEdBQUcsSUFBSTtRQUNqQkMsVUFBVSxHQUFHLGdCQUFnQjtNQUMvQjtNQUdBLElBQUksQ0FBQ0QsVUFBVSxJQUFJRCxVQUFVLENBQUNwQyxRQUFRLElBQUljLGNBQWMsQ0FBQ3lCLEdBQUcsQ0FBQ0gsVUFBVSxDQUFDcEMsUUFBUSxDQUFDLEVBQUU7UUFDakZxQyxVQUFVLEdBQUcsSUFBSTtRQUNqQkMsVUFBVSxHQUFHLGtCQUFrQjtNQUNqQztNQUdBLElBQUksQ0FBQ0QsVUFBVSxJQUFJRCxVQUFVLENBQUNuQyxTQUFTLElBQUlNLFNBQVMsQ0FBQ2dDLEdBQUcsQ0FBQ0gsVUFBVSxDQUFDbkMsU0FBUyxDQUFDLEVBQUU7UUFDOUVvQyxVQUFVLEdBQUcsSUFBSTtRQUNqQkMsVUFBVSxHQUFHLG1CQUFtQjtNQUNsQztNQUdBLElBQUksQ0FBQ0QsVUFBVSxJQUFJRCxVQUFVLENBQUN6QixZQUFZLElBQUlFLG1CQUFtQixDQUFDMEIsR0FBRyxDQUFDSCxVQUFVLENBQUN6QixZQUFZLENBQUMsRUFBRTtRQUM5RjBCLFVBQVUsR0FBRyxJQUFJO1FBQ2pCQyxVQUFVLEdBQUcsd0JBQXdCO1FBQ3JDbEQsS0FBSyxDQUFDSSxpQkFBaUIsRUFBRTtNQUMzQjtNQUdBLElBQUksQ0FBQzZDLFVBQVUsSUFBSSxDQUFDRCxVQUFVLENBQUN6QixZQUFZLEVBQUU7UUFFM0MsSUFBTTZCLFFBQVEsR0FBR0MsdUJBQXVCLENBQUNMLFVBQVUsQ0FBQztRQUNwRCxJQUFJdkIsbUJBQW1CLENBQUMwQixHQUFHLENBQUNDLFFBQVEsQ0FBQyxFQUFFO1VBQ3JDSCxVQUFVLEdBQUcsSUFBSTtVQUNqQkMsVUFBVSxHQUFHLG9CQUFvQjtVQUNqQ2xELEtBQUssQ0FBQ0ksaUJBQWlCLEVBQUU7UUFDM0I7TUFDRjtNQUVBLElBQUk2QyxVQUFVLEVBQUU7UUFDZHpELE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLDJCQUEyQnVELFVBQVUsQ0FBQ3JDLEVBQUUsS0FBS3VDLFVBQVUsRUFBRSxDQUFDO1FBQ3RFO01BQ0Y7TUFHQTFELE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGdDQUFnQ3VELFVBQVUsQ0FBQ3JDLEVBQUUsRUFBRSxDQUFDO01BQzVETSxhQUFhLENBQUNxQyxJQUFJLENBQUNOLFVBQVUsQ0FBQztJQUNoQztJQUdBLFNBQVNLLHVCQUF1QkEsQ0FBQzdDLEtBQWdCLEVBQVU7TUFDekQsSUFBTStDLFdBQVcsR0FBRyxHQUFHL0MsS0FBSyxDQUFDZ0QsT0FBTyxJQUFJaEQsS0FBSyxDQUFDaUQsVUFBVSxJQUFJakQsS0FBSyxDQUFDa0QsWUFBWSxJQUFJbEQsS0FBSyxDQUFDbUQsYUFBYSxJQUFJLENBQUNuRCxLQUFLLENBQUNvRCxLQUFLLElBQUksRUFBRSxFQUFFQyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxXQUFXLENBQUMsQ0FBQyxFQUFFO01BQ25KLElBQUlDLElBQUksR0FBRyxDQUFDO01BQ1osS0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUdULFdBQVcsQ0FBQ25FLE1BQU0sRUFBRTRFLENBQUMsRUFBRSxFQUFFO1FBQzNDLElBQU1DLElBQUksR0FBR1YsV0FBVyxDQUFDVyxVQUFVLENBQUNGLENBQUMsQ0FBQztRQUN0Q0QsSUFBSSxHQUFJLENBQUNBLElBQUksSUFBSSxDQUFDLElBQUlBLElBQUksR0FBSUUsSUFBSTtRQUNsQ0YsSUFBSSxHQUFHQSxJQUFJLEdBQUdBLElBQUk7TUFDcEI7TUFDQSxPQUFPSSxJQUFJLENBQUNDLEdBQUcsQ0FBQ0wsSUFBSSxDQUFDLENBQUNNLFFBQVEsQ0FBQyxFQUFFLENBQUM7SUFDcEM7SUFFQXJFLEtBQUssQ0FBQ0csV0FBVyxHQUFHYyxhQUFhLENBQUM3QixNQUFNO0lBR3hDLElBQU1rRixhQUFhLEdBQUFDLE1BQUEsQ0FBQUMsTUFBQSxLQUNkeEUsS0FBSztNQUNSeUUsV0FBVyxFQUFFO0lBQUksRUFDbEI7SUFHRHhELGFBQWEsQ0FBQ3lELElBQUksQ0FBQyxVQUFDQyxDQUFDLEVBQUVDLENBQUMsRUFBSztNQUMzQixJQUFNQyxLQUFLLEdBQUcsSUFBSUMsSUFBSSxDQUFDSCxDQUFDLENBQUNJLFVBQVUsSUFBSUosQ0FBQyxDQUFDSyxTQUFTLElBQUksQ0FBQyxDQUFDLENBQUNDLE9BQU8sQ0FBQyxDQUFDO01BQ2xFLElBQU1DLEtBQUssR0FBRyxJQUFJSixJQUFJLENBQUNGLENBQUMsQ0FBQ0csVUFBVSxJQUFJSCxDQUFDLENBQUNJLFNBQVMsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsT0FBTyxDQUFDLENBQUM7TUFDbEUsT0FBT0MsS0FBSyxHQUFHTCxLQUFLO0lBQ3RCLENBQUMsQ0FBQztJQUVGckYsT0FBTyxDQUFDQyxHQUFHLENBQUMsMEJBQTBCLEVBQUU2RSxhQUFhLENBQUM7SUFFdEQsT0FBTztNQUNMckQsYUFBYSxFQUFiQSxhQUFhO01BQ2JrRSxTQUFTLEVBQUUsRUFBRTtNQUNibkYsS0FBSyxFQUFFc0U7SUFDVCxDQUFDO0VBQ0gsQ0FBQztFQUFBLE9BQUF4RixxQkFBQSxDQUFBQyxLQUFBLE9BQUFDLFNBQUE7QUFBQTtBQUFBLFNBS2NvRyxXQUFXQSxDQUFBO0VBQUEsT0FBQUMsWUFBQSxDQUFBdEcsS0FBQSxPQUFBQyxTQUFBO0FBQUE7QUFBQSxTQUFBcUcsYUFBQTtFQUFBQSxZQUFBLE9BQUFwRyxrQkFBQSxDQUFBQyxPQUFBLEVBQTFCLGFBQTZEO0lBQzNELE9BQU8sSUFBSTtFQUNiLENBQUM7RUFBQSxPQUFBbUcsWUFBQSxDQUFBdEcsS0FBQSxPQUFBQyxTQUFBO0FBQUE7QUFFTSxJQUFNc0csc0JBQW9DLEdBQUFDLE9BQUEsQ0FBQUQsc0JBQUEsR0FBRztFQUNsRHpHLG9CQUFvQixFQUFwQkEsb0JBQW9CO0VBQ3BCdUcsV0FBVyxFQUFYQTtBQUNGLENBQUM7QUFHTSxJQUFNSSx1QkFBdUIsR0FBQUQsT0FBQSxDQUFBQyx1QkFBQSxHQUFHRixzQkFBc0I7QUFBQyxJQUFBRyxRQUFBLEdBQUFGLE9BQUEsQ0FBQXJHLE9BQUEsR0FFL0NvRyxzQkFBc0IiLCJpZ25vcmVMaXN0IjpbXX0=