7cdbfd45871c94b5f66e2d583ec505f6
_getJestObj().mock("../../lib/supabase", function () {
  return {
    supabase: mockClient
  };
});
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
function _getJestObj() {
  var _require = require("@jest/globals"),
    jest = _require.jest;
  _getJestObj = function _getJestObj() {
    return jest;
  };
  return jest;
}
var callLog = [];
function qb(table) {
  var state = {
    table: table,
    filters: []
  };
  var api = {
    select: jest.fn(function () {
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      callLog.push({
        op: 'select',
        table: table,
        args: args
      });
      return api;
    }),
    upsert: jest.fn(function () {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }
      callLog.push({
        op: 'upsert',
        table: table,
        args: args
      });
      return api;
    }),
    insert: jest.fn(function () {
      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
        args[_key3] = arguments[_key3];
      }
      callLog.push({
        op: 'insert',
        table: table,
        args: args
      });
      return api;
    }),
    update: jest.fn(function () {
      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
        args[_key4] = arguments[_key4];
      }
      callLog.push({
        op: 'update',
        table: table,
        args: args
      });
      return api;
    }),
    delete: jest.fn(function () {
      for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {
        args[_key5] = arguments[_key5];
      }
      callLog.push({
        op: 'delete',
        table: table,
        args: args
      });
      return api;
    }),
    eq: jest.fn(function (field, value) {
      state.filters.push({
        field: field,
        value: value
      });
      return api;
    }),
    maybeSingle: jest.fn((0, _asyncToGenerator2.default)(function* () {
      return {
        data: null,
        error: null
      };
    })),
    single: jest.fn((0, _asyncToGenerator2.default)(function* () {
      return {
        data: {
          ok: true
        },
        error: null
      };
    }))
  };
  return api;
}
var mockAuth = {
  getUser: jest.fn((0, _asyncToGenerator2.default)(function* () {
    return {
      user: {
        id: 'user-1',
        email: 'new@user.test',
        user_metadata: {
          name: 'New User'
        },
        app_metadata: {
          provider: 'email'
        }
      }
    };
  })),
  updateUser: jest.fn((0, _asyncToGenerator2.default)(function* () {
    return {
      data: {},
      error: null
    };
  }))
};
var mockClient = {
  from: jest.fn(function (table) {
    return qb(table);
  }),
  auth: mockAuth
};
var getSvc = function getSvc() {
  var mod = require("../../services/supabase");
  console.log('services/supabase exports:', Object.keys(mod));
  var createSupabaseServiceForTest = mod.createSupabaseServiceForTest;
  return createSupabaseServiceForTest(mockClient);
};
beforeEach(function () {
  callLog.length = 0;
  jest.clearAllMocks();
});
describe('Signup + Onboarding Supabase writes', function () {
  test('createGamificationProfile ensures users row upsert when missing', (0, _asyncToGenerator2.default)(function* () {
    var qbUsers = qb('users');
    mockClient.from.mockImplementation(function (table) {
      if (table === 'users') {
        qbUsers.single.mockResolvedValueOnce({
          data: null,
          error: null
        });
        return qbUsers;
      }
      return qb(table);
    });
    var svc = getSvc();
    var res = yield svc.createGamificationProfile('user-1');
    var usersUpsert = callLog.find(function (l) {
      return l.op === 'upsert' && l.table === 'users';
    });
    expect(usersUpsert).toBeTruthy();
    var upsertBody = usersUpsert.args[0];
    expect(upsertBody).toMatchObject({
      id: 'user-1',
      email: 'new@user.test',
      provider: 'email'
    });
    var gpUpsert = callLog.find(function (l) {
      return l.op === 'upsert' && l.table === 'gamification_profiles';
    });
    expect(gpUpsert).toBeTruthy();
    expect(res === null || typeof res === 'object').toBe(true);
  }));
  test('upsertUserProfile maps onboarding payload correctly into user_profiles', (0, _asyncToGenerator2.default)(function* () {
    var userId = 'user-2';
    var payload = {
      profile: {
        age: 27,
        gender: 'male',
        locale: 'tr-TR',
        timezone: 'Europe/Istanbul'
      },
      motivation: ['stress_reduction', 'mental_clarity'],
      first_mood: {
        score: 6,
        tags: ['work', 'sleep']
      },
      lifestyle: {
        sleep_hours: 5,
        exercise: 'Regular',
        social: 'High'
      },
      reminders: {
        enabled: true,
        time: '21:30',
        days: ['Mon', 'Wed'],
        timezone: 'Europe/Istanbul'
      },
      feature_flags: {
        a: true,
        b: false
      },
      consent: {
        accepted: true
      }
    };
    mockClient.from.mockImplementation(function (table) {
      return qb(table);
    });
    var svc = getSvc();
    yield svc.upsertUserProfile(userId, payload);
    var upsert = callLog.find(function (l) {
      return l.op === 'upsert' && l.table === 'user_profiles';
    });
    expect(upsert).toBeTruthy();
    var body = upsert.args[0];
    expect(body.user_id).toBe(userId);
    expect(body.motivations).toEqual(['stress_reduction', 'mental_clarity']);
    expect(body.first_mood_score).toBe(5);
    expect(body.first_mood_tags).toEqual(['work', 'sleep']);
    expect(body.reminder_enabled).toBe(true);
    expect(body.reminder_time).toBe('21:30');
    expect(body.feature_flags).toEqual({
      a: true,
      b: false
    });
    expect(body.onboarding_version).toBe(2);
    expect(typeof body.onboarding_completed_at).toBe('string');
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJzdXBhYmFzZSIsIm1vY2tDbGllbnQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9hc3luY1RvR2VuZXJhdG9yMiIsIl9yZXF1aXJlIiwiamVzdCIsImNhbGxMb2ciLCJxYiIsInRhYmxlIiwic3RhdGUiLCJmaWx0ZXJzIiwiYXBpIiwic2VsZWN0IiwiZm4iLCJfbGVuIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiYXJncyIsIkFycmF5IiwiX2tleSIsInB1c2giLCJvcCIsInVwc2VydCIsIl9sZW4yIiwiX2tleTIiLCJpbnNlcnQiLCJfbGVuMyIsIl9rZXkzIiwidXBkYXRlIiwiX2xlbjQiLCJfa2V5NCIsImRlbGV0ZSIsIl9sZW41IiwiX2tleTUiLCJlcSIsImZpZWxkIiwidmFsdWUiLCJtYXliZVNpbmdsZSIsImRlZmF1bHQiLCJkYXRhIiwiZXJyb3IiLCJzaW5nbGUiLCJvayIsIm1vY2tBdXRoIiwiZ2V0VXNlciIsInVzZXIiLCJpZCIsImVtYWlsIiwidXNlcl9tZXRhZGF0YSIsIm5hbWUiLCJhcHBfbWV0YWRhdGEiLCJwcm92aWRlciIsInVwZGF0ZVVzZXIiLCJmcm9tIiwiYXV0aCIsImdldFN2YyIsIm1vZCIsImNvbnNvbGUiLCJsb2ciLCJPYmplY3QiLCJrZXlzIiwiY3JlYXRlU3VwYWJhc2VTZXJ2aWNlRm9yVGVzdCIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwiZGVzY3JpYmUiLCJ0ZXN0IiwicWJVc2VycyIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsIm1vY2tSZXNvbHZlZFZhbHVlT25jZSIsInN2YyIsInJlcyIsImNyZWF0ZUdhbWlmaWNhdGlvblByb2ZpbGUiLCJ1c2Vyc1Vwc2VydCIsImZpbmQiLCJsIiwiZXhwZWN0IiwidG9CZVRydXRoeSIsInVwc2VydEJvZHkiLCJ0b01hdGNoT2JqZWN0IiwiZ3BVcHNlcnQiLCJ0b0JlIiwidXNlcklkIiwicGF5bG9hZCIsInByb2ZpbGUiLCJhZ2UiLCJnZW5kZXIiLCJsb2NhbGUiLCJ0aW1lem9uZSIsIm1vdGl2YXRpb24iLCJmaXJzdF9tb29kIiwic2NvcmUiLCJ0YWdzIiwibGlmZXN0eWxlIiwic2xlZXBfaG91cnMiLCJleGVyY2lzZSIsInNvY2lhbCIsInJlbWluZGVycyIsImVuYWJsZWQiLCJ0aW1lIiwiZGF5cyIsImZlYXR1cmVfZmxhZ3MiLCJhIiwiYiIsImNvbnNlbnQiLCJhY2NlcHRlZCIsInVwc2VydFVzZXJQcm9maWxlIiwiYm9keSIsInVzZXJfaWQiLCJtb3RpdmF0aW9ucyIsInRvRXF1YWwiLCJmaXJzdF9tb29kX3Njb3JlIiwiZmlyc3RfbW9vZF90YWdzIiwicmVtaW5kZXJfZW5hYmxlZCIsInJlbWluZGVyX3RpbWUiLCJvbmJvYXJkaW5nX3ZlcnNpb24iLCJvbmJvYXJkaW5nX2NvbXBsZXRlZF9hdCJdLCJzb3VyY2VzIjpbImF1dGhfb25ib2FyZGluZ19zdXBhYmFzZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIExpZ2h0d2VpZ2h0IFN1cGFiYXNlIGNsaWVudCBtb2NrIHdpcmVkIHZpYSBtb2R1bGUgYWxpYXNcbnR5cGUgQW55Rm4gPSAoLi4uYXJnczogYW55W10pID0+IGFueTtcblxuY29uc3QgY2FsbExvZzogYW55W10gPSBbXTtcblxuLy8gQ2hhaW5hYmxlIHF1ZXJ5IGJ1aWxkZXIgbW9ja1xuZnVuY3Rpb24gcWIodGFibGU6IHN0cmluZykge1xuICBjb25zdCBzdGF0ZTogYW55ID0geyB0YWJsZSwgZmlsdGVyczogW10gfTtcbiAgY29uc3QgYXBpOiBhbnkgPSB7XG4gICAgc2VsZWN0OiBqZXN0LmZuKCguLi5hcmdzOiBhbnlbXSkgPT4geyBjYWxsTG9nLnB1c2goeyBvcDogJ3NlbGVjdCcsIHRhYmxlLCBhcmdzIH0pOyByZXR1cm4gYXBpOyB9KSxcbiAgICB1cHNlcnQ6IGplc3QuZm4oKC4uLmFyZ3M6IGFueVtdKSA9PiB7IGNhbGxMb2cucHVzaCh7IG9wOiAndXBzZXJ0JywgdGFibGUsIGFyZ3MgfSk7IHJldHVybiBhcGk7IH0pLFxuICAgIGluc2VydDogamVzdC5mbigoLi4uYXJnczogYW55W10pID0+IHsgY2FsbExvZy5wdXNoKHsgb3A6ICdpbnNlcnQnLCB0YWJsZSwgYXJncyB9KTsgcmV0dXJuIGFwaTsgfSksXG4gICAgdXBkYXRlOiBqZXN0LmZuKCguLi5hcmdzOiBhbnlbXSkgPT4geyBjYWxsTG9nLnB1c2goeyBvcDogJ3VwZGF0ZScsIHRhYmxlLCBhcmdzIH0pOyByZXR1cm4gYXBpOyB9KSxcbiAgICBkZWxldGU6IGplc3QuZm4oKC4uLmFyZ3M6IGFueVtdKSA9PiB7IGNhbGxMb2cucHVzaCh7IG9wOiAnZGVsZXRlJywgdGFibGUsIGFyZ3MgfSk7IHJldHVybiBhcGk7IH0pLFxuICAgIGVxOiBqZXN0LmZuKChmaWVsZDogc3RyaW5nLCB2YWx1ZTogYW55KSA9PiB7IHN0YXRlLmZpbHRlcnMucHVzaCh7IGZpZWxkLCB2YWx1ZSB9KTsgcmV0dXJuIGFwaTsgfSksXG4gICAgbWF5YmVTaW5nbGU6IGplc3QuZm4oYXN5bmMgKCkgPT4gKHsgZGF0YTogbnVsbCwgZXJyb3I6IG51bGwgfSkpLFxuICAgIHNpbmdsZTogamVzdC5mbihhc3luYyAoKSA9PiAoeyBkYXRhOiB7IG9rOiB0cnVlIH0sIGVycm9yOiBudWxsIH0pKSxcbiAgfTtcbiAgcmV0dXJuIGFwaTtcbn1cblxuY29uc3QgbW9ja0F1dGggPSB7XG4gIGdldFVzZXI6IGplc3QuZm4oYXN5bmMgKCkgPT4gKHtcbiAgICB1c2VyOiB7XG4gICAgICBpZDogJ3VzZXItMScsXG4gICAgICBlbWFpbDogJ25ld0B1c2VyLnRlc3QnLFxuICAgICAgdXNlcl9tZXRhZGF0YTogeyBuYW1lOiAnTmV3IFVzZXInIH0sXG4gICAgICBhcHBfbWV0YWRhdGE6IHsgcHJvdmlkZXI6ICdlbWFpbCcgfVxuICAgIH1cbiAgfSkpLFxuICB1cGRhdGVVc2VyOiBqZXN0LmZuKGFzeW5jICgpID0+ICh7IGRhdGE6IHt9LCBlcnJvcjogbnVsbCB9KSksXG59O1xuXG5jb25zdCBtb2NrQ2xpZW50ID0ge1xuICBmcm9tOiBqZXN0LmZuKCh0YWJsZTogc3RyaW5nKSA9PiBxYih0YWJsZSkpLFxuICBhdXRoOiBtb2NrQXV0aCxcbn07XG5cbmplc3QubW9jaygnQC9saWIvc3VwYWJhc2UnLCAoKSA9PiAoe1xuICBzdXBhYmFzZTogbW9ja0NsaWVudCxcbn0pKTtcblxuLy8gRGVmZXIgaW1wb3J0aW5nIHRoZSBzZXJ2aWNlIHVudGlsIGFmdGVyIG1vY2tzIGFyZSBzZXQgdXBcbmNvbnN0IGdldFN2YyA9ICgpID0+IHtcbiAgY29uc3QgbW9kID0gcmVxdWlyZSgnLi4vLi4vc2VydmljZXMvc3VwYWJhc2UnKTtcbiAgLy8gRGVidWcgYXZhaWxhYmxlIGV4cG9ydHMgaWYgbmVlZGVkXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gIGNvbnNvbGUubG9nKCdzZXJ2aWNlcy9zdXBhYmFzZSBleHBvcnRzOicsIE9iamVjdC5rZXlzKG1vZCkpO1xuICBjb25zdCB7IGNyZWF0ZVN1cGFiYXNlU2VydmljZUZvclRlc3QgfSA9IG1vZDtcbiAgLy8gSW5qZWN0IG91ciBtb2NrIFN1cGFiYXNlIGNsaWVudCB0byB0aGUgc2VydmljZVxuICByZXR1cm4gY3JlYXRlU3VwYWJhc2VTZXJ2aWNlRm9yVGVzdChtb2NrQ2xpZW50IGFzIGFueSk7XG59O1xuXG5iZWZvcmVFYWNoKCgpID0+IHtcbiAgY2FsbExvZy5sZW5ndGggPSAwO1xuICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbn0pO1xuXG5kZXNjcmliZSgnU2lnbnVwICsgT25ib2FyZGluZyBTdXBhYmFzZSB3cml0ZXMnLCAoKSA9PiB7XG4gIHRlc3QoJ2NyZWF0ZUdhbWlmaWNhdGlvblByb2ZpbGUgZW5zdXJlcyB1c2VycyByb3cgdXBzZXJ0IHdoZW4gbWlzc2luZycsIGFzeW5jICgpID0+IHtcbiAgICAvLyBBcnJhbmdlOiBtYWtlIHVzZXJzIHNlbGVjdCgpLmVxKCkuc2luZ2xlKCkgcmV0dXJuIG5vIHJvd1xuICAgIGNvbnN0IHFiVXNlcnMgPSBxYigndXNlcnMnKTtcbiAgICAobW9ja0NsaWVudC5mcm9tIGFzIEFueUZuKS5tb2NrSW1wbGVtZW50YXRpb24oKHRhYmxlOiBzdHJpbmcpID0+IHtcbiAgICAgIGlmICh0YWJsZSA9PT0gJ3VzZXJzJykge1xuICAgICAgICAvLyBvdmVycmlkZSBzaW5nbGUoKSBmb3IgZmlyc3Qgc2VsZWN0IHRvIHNpbXVsYXRlIG1pc3NpbmcgdXNlclxuICAgICAgICBxYlVzZXJzLnNpbmdsZS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoeyBkYXRhOiBudWxsLCBlcnJvcjogbnVsbCB9KTtcbiAgICAgICAgLy8gZm9yIHVwc2VydCgpLnNlbGVjdCgpLnNpbmdsZSgpIGFmdGVyIGVuc3VyZVVzZXJQcm9maWxlRXhpc3RzXG4gICAgICAgIHJldHVybiBxYlVzZXJzO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHFiKHRhYmxlKTtcbiAgICB9KTtcblxuICAgIC8vIEFjdFxuICAgIGNvbnN0IHN2YyA9IGdldFN2YygpO1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHN2Yy5jcmVhdGVHYW1pZmljYXRpb25Qcm9maWxlKCd1c2VyLTEnKTtcblxuICAgIC8vIEFzc2VydDogdXNlcnMgdXBzZXJ0IGNhbGxlZCB3aXRoIGlkL2VtYWlsL25hbWUvcHJvdmlkZXJcbiAgICBjb25zdCB1c2Vyc1Vwc2VydCA9IGNhbGxMb2cuZmluZChsID0+IGwub3AgPT09ICd1cHNlcnQnICYmIGwudGFibGUgPT09ICd1c2VycycpO1xuICAgIGV4cGVjdCh1c2Vyc1Vwc2VydCkudG9CZVRydXRoeSgpO1xuICAgIGNvbnN0IHVwc2VydEJvZHkgPSB1c2Vyc1Vwc2VydC5hcmdzWzBdO1xuICAgIGV4cGVjdCh1cHNlcnRCb2R5KS50b01hdGNoT2JqZWN0KHsgaWQ6ICd1c2VyLTEnLCBlbWFpbDogJ25ld0B1c2VyLnRlc3QnLCBwcm92aWRlcjogJ2VtYWlsJyB9KTtcblxuICAgIC8vIEFuZCBnYW1pZmljYXRpb25fcHJvZmlsZXMgdXBzZXJ0IGV4ZWN1dGVkXG4gICAgY29uc3QgZ3BVcHNlcnQgPSBjYWxsTG9nLmZpbmQobCA9PiBsLm9wID09PSAndXBzZXJ0JyAmJiBsLnRhYmxlID09PSAnZ2FtaWZpY2F0aW9uX3Byb2ZpbGVzJyk7XG4gICAgZXhwZWN0KGdwVXBzZXJ0KS50b0JlVHJ1dGh5KCk7XG4gICAgZXhwZWN0KHJlcyA9PT0gbnVsbCB8fCB0eXBlb2YgcmVzID09PSAnb2JqZWN0JykudG9CZSh0cnVlKTtcbiAgfSk7XG5cbiAgdGVzdCgndXBzZXJ0VXNlclByb2ZpbGUgbWFwcyBvbmJvYXJkaW5nIHBheWxvYWQgY29ycmVjdGx5IGludG8gdXNlcl9wcm9maWxlcycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB1c2VySWQgPSAndXNlci0yJztcbiAgICBjb25zdCBwYXlsb2FkID0ge1xuICAgICAgcHJvZmlsZTogeyBhZ2U6IDI3LCBnZW5kZXI6ICdtYWxlJywgbG9jYWxlOiAndHItVFInLCB0aW1lem9uZTogJ0V1cm9wZS9Jc3RhbmJ1bCcgfSxcbiAgICAgIG1vdGl2YXRpb246IFsnc3RyZXNzX3JlZHVjdGlvbicsICdtZW50YWxfY2xhcml0eSddLFxuICAgICAgZmlyc3RfbW9vZDogeyBzY29yZTogNiwgdGFnczogWyd3b3JrJywgJ3NsZWVwJ10gfSwgLy8gc2NvcmUgc2hvdWxkIGNsYW1wIHRvIDVcbiAgICAgIGxpZmVzdHlsZTogeyBzbGVlcF9ob3VyczogNSwgZXhlcmNpc2U6ICdSZWd1bGFyJywgc29jaWFsOiAnSGlnaCcgfSxcbiAgICAgIHJlbWluZGVyczogeyBlbmFibGVkOiB0cnVlLCB0aW1lOiAnMjE6MzAnLCBkYXlzOiBbJ01vbicsJ1dlZCddLCB0aW1lem9uZTogJ0V1cm9wZS9Jc3RhbmJ1bCcgfSxcbiAgICAgIGZlYXR1cmVfZmxhZ3M6IHsgYTogdHJ1ZSwgYjogZmFsc2UgfSxcbiAgICAgIGNvbnNlbnQ6IHsgYWNjZXB0ZWQ6IHRydWUgfSxcbiAgICB9O1xuXG4gICAgLy8gZnJlc2ggbW9jayBwZXIgdGVzdFxuICAgIChtb2NrQ2xpZW50LmZyb20gYXMgQW55Rm4pLm1vY2tJbXBsZW1lbnRhdGlvbigodGFibGU6IHN0cmluZykgPT4gcWIodGFibGUpKTtcblxuICAgIGNvbnN0IHN2YyA9IGdldFN2YygpO1xuICAgIGF3YWl0IHN2Yy51cHNlcnRVc2VyUHJvZmlsZSh1c2VySWQsIHBheWxvYWQpO1xuXG4gICAgY29uc3QgdXBzZXJ0ID0gY2FsbExvZy5maW5kKGwgPT4gbC5vcCA9PT0gJ3Vwc2VydCcgJiYgbC50YWJsZSA9PT0gJ3VzZXJfcHJvZmlsZXMnKTtcbiAgICBleHBlY3QodXBzZXJ0KS50b0JlVHJ1dGh5KCk7XG4gICAgY29uc3QgYm9keSA9IHVwc2VydC5hcmdzWzBdO1xuXG4gICAgLy8gS2V5IGZpZWxkIGV4cGVjdGF0aW9uc1xuICAgIGV4cGVjdChib2R5LnVzZXJfaWQpLnRvQmUodXNlcklkKTtcbiAgICBleHBlY3QoYm9keS5tb3RpdmF0aW9ucykudG9FcXVhbChbJ3N0cmVzc19yZWR1Y3Rpb24nLCAnbWVudGFsX2NsYXJpdHknXSk7XG4gICAgZXhwZWN0KGJvZHkuZmlyc3RfbW9vZF9zY29yZSkudG9CZSg1KTsgLy8gY2xhbXBlZFxuICAgIGV4cGVjdChib2R5LmZpcnN0X21vb2RfdGFncykudG9FcXVhbChbJ3dvcmsnLCdzbGVlcCddKTtcbiAgICBleHBlY3QoYm9keS5yZW1pbmRlcl9lbmFibGVkKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChib2R5LnJlbWluZGVyX3RpbWUpLnRvQmUoJzIxOjMwJyk7XG4gICAgZXhwZWN0KGJvZHkuZmVhdHVyZV9mbGFncykudG9FcXVhbCh7IGE6IHRydWUsIGI6IGZhbHNlIH0pO1xuICAgIGV4cGVjdChib2R5Lm9uYm9hcmRpbmdfdmVyc2lvbikudG9CZSgyKTtcbiAgICBleHBlY3QodHlwZW9mIGJvZHkub25ib2FyZGluZ19jb21wbGV0ZWRfYXQpLnRvQmUoJ3N0cmluZycpO1xuICB9KTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFzQ0FBLFdB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