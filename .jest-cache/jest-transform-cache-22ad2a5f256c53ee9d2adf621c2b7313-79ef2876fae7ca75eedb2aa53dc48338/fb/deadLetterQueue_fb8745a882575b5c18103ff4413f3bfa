2438f5ff32fac04842b6db7fd1686924
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.deadLetterQueue = void 0;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _asyncStorage = _interopRequireDefault(require("@react-native-async-storage/async-storage"));
var DeadLetterQueueService = function () {
  function DeadLetterQueueService() {
    (0, _classCallCheck2.default)(this, DeadLetterQueueService);
    this.STORAGE_KEY = 'dead_letter_queue';
    this.MAX_ARCHIVE_DAYS = 30;
  }
  return (0, _createClass2.default)(DeadLetterQueueService, [{
    key: "addToDeadLetter",
    value: function () {
      var _addToDeadLetter = (0, _asyncToGenerator2.default)(function* (item, error) {
        var _error$code;
        var queue = yield this.getQueue();
        var record = Object.assign({}, item, {
          failedAt: new Date().toISOString(),
          errorMessage: (error == null ? void 0 : error.message) || item.errorMessage || 'Unknown error',
          errorCode: (_error$code = error == null ? void 0 : error.code) != null ? _error$code : error == null ? void 0 : error.status,
          canRetry: this.isRetryable(error),
          archived: false
        });
        queue.push(record);
        yield this.saveQueue(queue);
      });
      function addToDeadLetter(_x, _x2) {
        return _addToDeadLetter.apply(this, arguments);
      }
      return addToDeadLetter;
    }()
  }, {
    key: "retryDeadLetterItem",
    value: function () {
      var _retryDeadLetterItem = (0, _asyncToGenerator2.default)(function* (itemId, requeue) {
        var queue = yield this.getQueue();
        var found = queue.find(function (i) {
          return i.id === itemId;
        });
        if (!found || !found.canRetry || found.archived) return false;
        try {
          yield requeue(found.data);
          yield this.removeFromQueue(itemId);
          return true;
        } catch (_unused) {
          return false;
        }
      });
      function retryDeadLetterItem(_x3, _x4) {
        return _retryDeadLetterItem.apply(this, arguments);
      }
      return retryDeadLetterItem;
    }()
  }, {
    key: "list",
    value: function () {
      var _list = (0, _asyncToGenerator2.default)(function* () {
        var limit = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 50;
        var queue = yield this.getQueue();
        return queue.slice(-limit).reverse();
      });
      function list() {
        return _list.apply(this, arguments);
      }
      return list;
    }()
  }, {
    key: "archiveOldItems",
    value: function () {
      var _archiveOldItems = (0, _asyncToGenerator2.default)(function* () {
        var queue = yield this.getQueue();
        var cutoff = new Date(Date.now() - this.MAX_ARCHIVE_DAYS * 86400000);
        var archived = 0;
        var updated = queue.map(function (item) {
          if (!item.archived && new Date(item.failedAt) < cutoff) {
            archived++;
            return Object.assign({}, item, {
              archived: true
            });
          }
          return item;
        });
        yield this.saveQueue(updated);
        return archived;
      });
      function archiveOldItems() {
        return _archiveOldItems.apply(this, arguments);
      }
      return archiveOldItems;
    }()
  }, {
    key: "processDeadLetterQueue",
    value: function () {
      var _processDeadLetterQueue = (0, _asyncToGenerator2.default)(function* () {
        var _this = this;
        var retried = 0;
        var archived = 0;
        var items = yield this.getQueue();
        var SUPPORTED_ENTITIES = new Set(['compulsion', 'achievement', 'mood_entry', 'ai_profile', 'treatment_plan', 'voice_checkin', 'thought_record']);
        var SUPPORTED_OPERATIONS = new Set(['CREATE', 'UPDATE', 'DELETE']);
        try {
          var NetInfo = require('@react-native-community/netinfo').default;
          var state = yield NetInfo.fetch();
          var offline = !(state.isConnected && state.isInternetReachable !== false);
          if (offline) return {
            retried: 0,
            archived: archived + (yield this.archiveOldItems())
          };
        } catch (_unused2) {}
        var _loop = function* _loop() {
            if (item.archived) return 0;
            if (!SUPPORTED_OPERATIONS.has(item.type) || !SUPPORTED_ENTITIES.has(item.entity)) {
              item.archived = true;
              archived++;
              console.warn('🗄️ Archived unsupported DLQ item:', {
                entity: item.entity,
                type: item.type
              });
              return 0;
            }
            if (item.canRetry && (item.retryCount || 0) < 5) {
              try {
                var attempt = (item.retryCount || 0) + 1;
                var base = 2000;
                var delay = Math.min(base * Math.pow(2, attempt), 60000) + Math.floor(Math.random() * 500);
                yield new Promise(function (res) {
                  return setTimeout(res, delay);
                });
                var _yield$import = yield import("../offlineSync"),
                  offlineSyncService = _yield$import.offlineSyncService;
                yield offlineSyncService.addToSyncQueue({
                  type: item.type,
                  entity: item.entity,
                  data: item.data
                });
                yield _this.removeFromQueue(item.id);
                retried++;
              } catch (_unused3) {}
            }
          },
          _ret;
        for (var item of items) {
          _ret = yield* _loop();
          if (_ret === 0) continue;
        }
        if (archived > 0) {
          yield this.saveQueue(items);
        }
        archived += yield this.archiveOldItems();
        return {
          retried: retried,
          archived: archived
        };
      });
      function processDeadLetterQueue() {
        return _processDeadLetterQueue.apply(this, arguments);
      }
      return processDeadLetterQueue;
    }()
  }, {
    key: "getStatistics",
    value: function () {
      var _getStatistics = (0, _asyncToGenerator2.default)(function* () {
        var queue = yield this.getQueue();
        var stats = {
          total: queue.length,
          retryable: queue.filter(function (i) {
            return i.canRetry && !i.archived;
          }).length,
          archived: queue.filter(function (i) {
            return i.archived;
          }).length,
          byEntity: {},
          byError: {}
        };
        queue.forEach(function (i) {
          var _i$errorCode;
          stats.byEntity[i.entity] = (stats.byEntity[i.entity] || 0) + 1;
          var err = ((_i$errorCode = i.errorCode) != null ? _i$errorCode : 'unknown').toString();
          stats.byError[err] = (stats.byError[err] || 0) + 1;
        });
        return stats;
      });
      function getStatistics() {
        return _getStatistics.apply(this, arguments);
      }
      return getStatistics;
    }()
  }, {
    key: "isRetryable",
    value: function isRetryable(error) {
      if (!error) return false;
      if ((error == null ? void 0 : error.code) === 'NETWORK_ERROR') return true;
      if ((error == null ? void 0 : error.code) === 'TIMEOUT') return true;
      if ((error == null ? void 0 : error.status) === 429) return true;
      if ((error == null ? void 0 : error.status) >= 500 && (error == null ? void 0 : error.status) < 600) return true;
      if ((error == null ? void 0 : error.status) === 401 || (error == null ? void 0 : error.status) === 403) return false;
      if ((error == null ? void 0 : error.status) === 400) return false;
      return false;
    }
  }, {
    key: "getQueue",
    value: function () {
      var _getQueue = (0, _asyncToGenerator2.default)(function* () {
        try {
          var raw = yield _asyncStorage.default.getItem(this.STORAGE_KEY);
          return raw ? JSON.parse(raw) : [];
        } catch (_unused4) {
          return [];
        }
      });
      function getQueue() {
        return _getQueue.apply(this, arguments);
      }
      return getQueue;
    }()
  }, {
    key: "saveQueue",
    value: function () {
      var _saveQueue = (0, _asyncToGenerator2.default)(function* (queue) {
        yield _asyncStorage.default.setItem(this.STORAGE_KEY, JSON.stringify(queue));
      });
      function saveQueue(_x5) {
        return _saveQueue.apply(this, arguments);
      }
      return saveQueue;
    }()
  }, {
    key: "removeFromQueue",
    value: function () {
      var _removeFromQueue = (0, _asyncToGenerator2.default)(function* (itemId) {
        var queue = yield this.getQueue();
        var filtered = queue.filter(function (i) {
          return i.id !== itemId;
        });
        yield this.saveQueue(filtered);
      });
      function removeFromQueue(_x6) {
        return _removeFromQueue.apply(this, arguments);
      }
      return removeFromQueue;
    }()
  }], [{
    key: "getInstance",
    value: function getInstance() {
      if (!DeadLetterQueueService.instance) {
        DeadLetterQueueService.instance = new DeadLetterQueueService();
      }
      return DeadLetterQueueService.instance;
    }
  }]);
}();
var deadLetterQueue = exports.deadLetterQueue = DeadLetterQueueService.getInstance();
var _default = exports.default = deadLetterQueue;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYXN5bmNTdG9yYWdlIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJEZWFkTGV0dGVyUXVldWVTZXJ2aWNlIiwiX2NsYXNzQ2FsbENoZWNrMiIsImRlZmF1bHQiLCJTVE9SQUdFX0tFWSIsIk1BWF9BUkNISVZFX0RBWVMiLCJfY3JlYXRlQ2xhc3MyIiwia2V5IiwidmFsdWUiLCJfYWRkVG9EZWFkTGV0dGVyIiwiX2FzeW5jVG9HZW5lcmF0b3IyIiwiaXRlbSIsImVycm9yIiwiX2Vycm9yJGNvZGUiLCJxdWV1ZSIsImdldFF1ZXVlIiwicmVjb3JkIiwiT2JqZWN0IiwiYXNzaWduIiwiZmFpbGVkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJlcnJvck1lc3NhZ2UiLCJtZXNzYWdlIiwiZXJyb3JDb2RlIiwiY29kZSIsInN0YXR1cyIsImNhblJldHJ5IiwiaXNSZXRyeWFibGUiLCJhcmNoaXZlZCIsInB1c2giLCJzYXZlUXVldWUiLCJhZGRUb0RlYWRMZXR0ZXIiLCJfeCIsIl94MiIsImFwcGx5IiwiYXJndW1lbnRzIiwiX3JldHJ5RGVhZExldHRlckl0ZW0iLCJpdGVtSWQiLCJyZXF1ZXVlIiwiZm91bmQiLCJmaW5kIiwiaSIsImlkIiwiZGF0YSIsInJlbW92ZUZyb21RdWV1ZSIsIl91bnVzZWQiLCJyZXRyeURlYWRMZXR0ZXJJdGVtIiwiX3gzIiwiX3g0IiwiX2xpc3QiLCJsaW1pdCIsImxlbmd0aCIsInVuZGVmaW5lZCIsInNsaWNlIiwicmV2ZXJzZSIsImxpc3QiLCJfYXJjaGl2ZU9sZEl0ZW1zIiwiY3V0b2ZmIiwibm93IiwidXBkYXRlZCIsIm1hcCIsImFyY2hpdmVPbGRJdGVtcyIsIl9wcm9jZXNzRGVhZExldHRlclF1ZXVlIiwiX3RoaXMiLCJyZXRyaWVkIiwiaXRlbXMiLCJTVVBQT1JURURfRU5USVRJRVMiLCJTZXQiLCJTVVBQT1JURURfT1BFUkFUSU9OUyIsIk5ldEluZm8iLCJzdGF0ZSIsImZldGNoIiwib2ZmbGluZSIsImlzQ29ubmVjdGVkIiwiaXNJbnRlcm5ldFJlYWNoYWJsZSIsIl91bnVzZWQyIiwiX2xvb3AiLCJoYXMiLCJ0eXBlIiwiZW50aXR5IiwiY29uc29sZSIsIndhcm4iLCJyZXRyeUNvdW50IiwiYXR0ZW1wdCIsImJhc2UiLCJkZWxheSIsIk1hdGgiLCJtaW4iLCJwb3ciLCJmbG9vciIsInJhbmRvbSIsIlByb21pc2UiLCJyZXMiLCJzZXRUaW1lb3V0IiwiX3lpZWxkJGltcG9ydCIsIm9mZmxpbmVTeW5jU2VydmljZSIsImFkZFRvU3luY1F1ZXVlIiwiX3VudXNlZDMiLCJfcmV0IiwicHJvY2Vzc0RlYWRMZXR0ZXJRdWV1ZSIsIl9nZXRTdGF0aXN0aWNzIiwic3RhdHMiLCJ0b3RhbCIsInJldHJ5YWJsZSIsImZpbHRlciIsImJ5RW50aXR5IiwiYnlFcnJvciIsImZvckVhY2giLCJfaSRlcnJvckNvZGUiLCJlcnIiLCJ0b1N0cmluZyIsImdldFN0YXRpc3RpY3MiLCJfZ2V0UXVldWUiLCJyYXciLCJBc3luY1N0b3JhZ2UiLCJnZXRJdGVtIiwiSlNPTiIsInBhcnNlIiwiX3VudXNlZDQiLCJfc2F2ZVF1ZXVlIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsIl94NSIsIl9yZW1vdmVGcm9tUXVldWUiLCJmaWx0ZXJlZCIsIl94NiIsImdldEluc3RhbmNlIiwiaW5zdGFuY2UiLCJkZWFkTGV0dGVyUXVldWUiLCJleHBvcnRzIiwiX2RlZmF1bHQiXSwic291cmNlcyI6WyJkZWFkTGV0dGVyUXVldWUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFzeW5jU3RvcmFnZSBmcm9tICdAcmVhY3QtbmF0aXZlLWFzeW5jLXN0b3JhZ2UvYXN5bmMtc3RvcmFnZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGVhZExldHRlckl0ZW08VCA9IGFueT4ge1xuICBpZDogc3RyaW5nO1xuICB0eXBlOiBzdHJpbmc7XG4gIGVudGl0eTogc3RyaW5nO1xuICBkYXRhOiBUO1xuICBmYWlsZWRBdDogc3RyaW5nO1xuICBlcnJvck1lc3NhZ2U6IHN0cmluZztcbiAgZXJyb3JDb2RlPzogc3RyaW5nIHwgbnVtYmVyO1xuICBjYW5SZXRyeTogYm9vbGVhbjtcbiAgYXJjaGl2ZWQ6IGJvb2xlYW47XG4gIHJldHJ5Q291bnQ/OiBudW1iZXI7XG59XG5cbmNsYXNzIERlYWRMZXR0ZXJRdWV1ZVNlcnZpY2Uge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogRGVhZExldHRlclF1ZXVlU2VydmljZTtcbiAgcHJpdmF0ZSByZWFkb25seSBTVE9SQUdFX0tFWSA9ICdkZWFkX2xldHRlcl9xdWV1ZSc7XG4gIHByaXZhdGUgcmVhZG9ubHkgTUFYX0FSQ0hJVkVfREFZUyA9IDMwO1xuXG4gIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBEZWFkTGV0dGVyUXVldWVTZXJ2aWNlIHtcbiAgICBpZiAoIURlYWRMZXR0ZXJRdWV1ZVNlcnZpY2UuaW5zdGFuY2UpIHtcbiAgICAgIERlYWRMZXR0ZXJRdWV1ZVNlcnZpY2UuaW5zdGFuY2UgPSBuZXcgRGVhZExldHRlclF1ZXVlU2VydmljZSgpO1xuICAgIH1cbiAgICByZXR1cm4gRGVhZExldHRlclF1ZXVlU2VydmljZS5pbnN0YW5jZTtcbiAgfVxuXG4gIGFzeW5jIGFkZFRvRGVhZExldHRlcihpdGVtOiBPbWl0PERlYWRMZXR0ZXJJdGVtLCAnZmFpbGVkQXQnIHwgJ2FyY2hpdmVkJyB8ICdjYW5SZXRyeSc+LCBlcnJvcj86IGFueSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHF1ZXVlID0gYXdhaXQgdGhpcy5nZXRRdWV1ZSgpO1xuICAgIGNvbnN0IHJlY29yZDogRGVhZExldHRlckl0ZW0gPSB7XG4gICAgICAuLi5pdGVtLFxuICAgICAgZmFpbGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIGVycm9yTWVzc2FnZTogZXJyb3I/Lm1lc3NhZ2UgfHwgaXRlbS5lcnJvck1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InLFxuICAgICAgZXJyb3JDb2RlOiBlcnJvcj8uY29kZSA/PyBlcnJvcj8uc3RhdHVzLFxuICAgICAgY2FuUmV0cnk6IHRoaXMuaXNSZXRyeWFibGUoZXJyb3IpLFxuICAgICAgYXJjaGl2ZWQ6IGZhbHNlLFxuICAgIH0gYXMgRGVhZExldHRlckl0ZW07XG4gICAgcXVldWUucHVzaChyZWNvcmQpO1xuICAgIGF3YWl0IHRoaXMuc2F2ZVF1ZXVlKHF1ZXVlKTtcbiAgfVxuXG4gIGFzeW5jIHJldHJ5RGVhZExldHRlckl0ZW0oaXRlbUlkOiBzdHJpbmcsIHJlcXVldWU6IChkYXRhOiBhbnkpID0+IFByb21pc2U8dm9pZD4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBxdWV1ZSA9IGF3YWl0IHRoaXMuZ2V0UXVldWUoKTtcbiAgICBjb25zdCBmb3VuZCA9IHF1ZXVlLmZpbmQoaSA9PiBpLmlkID09PSBpdGVtSWQpO1xuICAgIGlmICghZm91bmQgfHwgIWZvdW5kLmNhblJldHJ5IHx8IGZvdW5kLmFyY2hpdmVkKSByZXR1cm4gZmFsc2U7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHJlcXVldWUoZm91bmQuZGF0YSk7XG4gICAgICBhd2FpdCB0aGlzLnJlbW92ZUZyb21RdWV1ZShpdGVtSWQpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgbGlzdChsaW1pdDogbnVtYmVyID0gNTApOiBQcm9taXNlPERlYWRMZXR0ZXJJdGVtW10+IHtcbiAgICBjb25zdCBxdWV1ZSA9IGF3YWl0IHRoaXMuZ2V0UXVldWUoKTtcbiAgICByZXR1cm4gcXVldWUuc2xpY2UoLWxpbWl0KS5yZXZlcnNlKCk7XG4gIH1cblxuICBhc3luYyBhcmNoaXZlT2xkSXRlbXMoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBjb25zdCBxdWV1ZSA9IGF3YWl0IHRoaXMuZ2V0UXVldWUoKTtcbiAgICBjb25zdCBjdXRvZmYgPSBuZXcgRGF0ZShEYXRlLm5vdygpIC0gdGhpcy5NQVhfQVJDSElWRV9EQVlTICogODY0MDAwMDApO1xuICAgIGxldCBhcmNoaXZlZCA9IDA7XG4gICAgY29uc3QgdXBkYXRlZCA9IHF1ZXVlLm1hcChpdGVtID0+IHtcbiAgICAgIGlmICghaXRlbS5hcmNoaXZlZCAmJiBuZXcgRGF0ZShpdGVtLmZhaWxlZEF0KSA8IGN1dG9mZikge1xuICAgICAgICBhcmNoaXZlZCsrO1xuICAgICAgICByZXR1cm4geyAuLi5pdGVtLCBhcmNoaXZlZDogdHJ1ZSB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIGl0ZW07XG4gICAgfSk7XG4gICAgYXdhaXQgdGhpcy5zYXZlUXVldWUodXBkYXRlZCk7XG4gICAgcmV0dXJuIGFyY2hpdmVkO1xuICB9XG5cbiAgYXN5bmMgcHJvY2Vzc0RlYWRMZXR0ZXJRdWV1ZSgpOiBQcm9taXNlPHsgcmV0cmllZDogbnVtYmVyOyBhcmNoaXZlZDogbnVtYmVyIH0+IHtcbiAgICBsZXQgcmV0cmllZCA9IDA7XG4gICAgbGV0IGFyY2hpdmVkID0gMDtcbiAgICBjb25zdCBpdGVtcyA9IGF3YWl0IHRoaXMuZ2V0UXVldWUoKTtcbiAgICBcbiAgICAvLyDinIUgRi0wMSBGSVg6IERlZmluZSBzdXBwb3J0ZWQgZW50aXRpZXMgdG8gbWF0Y2ggb2ZmbGluZVN5bmNcbiAgICBjb25zdCBTVVBQT1JURURfRU5USVRJRVMgPSBuZXcgU2V0KFtcbiAgICAgICdjb21wdWxzaW9uJywgJ2FjaGlldmVtZW50JywgJ21vb2RfZW50cnknLCAnYWlfcHJvZmlsZScsICd0cmVhdG1lbnRfcGxhbicsICd2b2ljZV9jaGVja2luJywgJ3Rob3VnaHRfcmVjb3JkJ1xuICAgIF0pO1xuICAgIGNvbnN0IFNVUFBPUlRFRF9PUEVSQVRJT05TID0gbmV3IFNldChbJ0NSRUFURScsICdVUERBVEUnLCAnREVMRVRFJ10pO1xuICAgIFxuICAgIC8vIE5ldHdvcmstYXdhcmU6IHNraXAgaWYgb2ZmbGluZVxuICAgIHRyeSB7XG4gICAgICBjb25zdCBOZXRJbmZvID0gcmVxdWlyZSgnQHJlYWN0LW5hdGl2ZS1jb21tdW5pdHkvbmV0aW5mbycpLmRlZmF1bHQ7XG4gICAgICBjb25zdCBzdGF0ZSA9IGF3YWl0IE5ldEluZm8uZmV0Y2goKTtcbiAgICAgIGNvbnN0IG9mZmxpbmUgPSAhKHN0YXRlLmlzQ29ubmVjdGVkICYmIHN0YXRlLmlzSW50ZXJuZXRSZWFjaGFibGUgIT09IGZhbHNlKTtcbiAgICAgIGlmIChvZmZsaW5lKSByZXR1cm4geyByZXRyaWVkOiAwLCBhcmNoaXZlZDogYXJjaGl2ZWQgKyAoYXdhaXQgdGhpcy5hcmNoaXZlT2xkSXRlbXMoKSkgfTtcbiAgICB9IGNhdGNoIHt9XG4gICAgXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XG4gICAgICBpZiAoaXRlbS5hcmNoaXZlZCkgY29udGludWU7XG4gICAgICBcbiAgICAgIC8vIOKchSBGLTAxIEZJWDogQXJjaGl2ZSB1bnN1cHBvcnRlZCBlbnRpdGllcyBpbW1lZGlhdGVseVxuICAgICAgaWYgKCFTVVBQT1JURURfT1BFUkFUSU9OUy5oYXMoaXRlbS50eXBlIGFzIGFueSkgfHwgIVNVUFBPUlRFRF9FTlRJVElFUy5oYXMoaXRlbS5lbnRpdHkgYXMgYW55KSkge1xuICAgICAgICAvLyBNYXJrIGFzIGFyY2hpdmVkIGluc3RlYWQgb2YgcmV0cnlpbmdcbiAgICAgICAgaXRlbS5hcmNoaXZlZCA9IHRydWU7XG4gICAgICAgIGFyY2hpdmVkKys7XG4gICAgICAgIGNvbnNvbGUud2Fybign8J+XhO+4jyBBcmNoaXZlZCB1bnN1cHBvcnRlZCBETFEgaXRlbTonLCB7IGVudGl0eTogaXRlbS5lbnRpdHksIHR5cGU6IGl0ZW0udHlwZSB9KTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChpdGVtLmNhblJldHJ5ICYmIChpdGVtLnJldHJ5Q291bnQgfHwgMCkgPCA1KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gRXhwb25lbnRpYWwgYmFja29mZiB3aXRoIGppdHRlciBieSByZXRyeUNvdW50XG4gICAgICAgICAgY29uc3QgYXR0ZW1wdCA9IChpdGVtLnJldHJ5Q291bnQgfHwgMCkgKyAxO1xuICAgICAgICAgIGNvbnN0IGJhc2UgPSAyMDAwOyAvLyAyIHNlY29uZHNcbiAgICAgICAgICBjb25zdCBkZWxheSA9IE1hdGgubWluKGJhc2UgKiBNYXRoLnBvdygyLCBhdHRlbXB0KSwgNjAwMDApICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNTAwKTtcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXMgPT4gc2V0VGltZW91dChyZXMsIGRlbGF5KSk7XG5cbiAgICAgICAgICBjb25zdCB7IG9mZmxpbmVTeW5jU2VydmljZSB9ID0gYXdhaXQgaW1wb3J0KCdAL3NlcnZpY2VzL29mZmxpbmVTeW5jJyk7XG4gICAgICAgICAgYXdhaXQgb2ZmbGluZVN5bmNTZXJ2aWNlLmFkZFRvU3luY1F1ZXVlKHsgdHlwZTogaXRlbS50eXBlIGFzIGFueSwgZW50aXR5OiBpdGVtLmVudGl0eSBhcyBhbnksIGRhdGE6IGl0ZW0uZGF0YSB9KTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlbW92ZUZyb21RdWV1ZShpdGVtLmlkKTtcbiAgICAgICAgICByZXRyaWVkKys7XG4gICAgICAgIH0gY2F0Y2gge31cbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gU2F2ZSB1cGRhdGVkIHF1ZXVlIHdpdGggYXJjaGl2ZWQgaXRlbXNcbiAgICBpZiAoYXJjaGl2ZWQgPiAwKSB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVRdWV1ZShpdGVtcyk7XG4gICAgfVxuICAgIFxuICAgIGFyY2hpdmVkICs9IGF3YWl0IHRoaXMuYXJjaGl2ZU9sZEl0ZW1zKCk7XG4gICAgcmV0dXJuIHsgcmV0cmllZCwgYXJjaGl2ZWQgfTtcbiAgfVxuXG4gIGFzeW5jIGdldFN0YXRpc3RpY3MoKTogUHJvbWlzZTx7XG4gICAgdG90YWw6IG51bWJlcjtcbiAgICByZXRyeWFibGU6IG51bWJlcjtcbiAgICBhcmNoaXZlZDogbnVtYmVyO1xuICAgIGJ5RW50aXR5OiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICAgIGJ5RXJyb3I6IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG4gIH0+IHtcbiAgICBjb25zdCBxdWV1ZSA9IGF3YWl0IHRoaXMuZ2V0UXVldWUoKTtcbiAgICBjb25zdCBzdGF0cyA9IHtcbiAgICAgIHRvdGFsOiBxdWV1ZS5sZW5ndGgsXG4gICAgICByZXRyeWFibGU6IHF1ZXVlLmZpbHRlcihpID0+IGkuY2FuUmV0cnkgJiYgIWkuYXJjaGl2ZWQpLmxlbmd0aCxcbiAgICAgIGFyY2hpdmVkOiBxdWV1ZS5maWx0ZXIoaSA9PiBpLmFyY2hpdmVkKS5sZW5ndGgsXG4gICAgICBieUVudGl0eToge30gYXMgUmVjb3JkPHN0cmluZywgbnVtYmVyPixcbiAgICAgIGJ5RXJyb3I6IHt9IGFzIFJlY29yZDxzdHJpbmcsIG51bWJlcj4sXG4gICAgfTtcbiAgICBxdWV1ZS5mb3JFYWNoKGkgPT4ge1xuICAgICAgc3RhdHMuYnlFbnRpdHlbaS5lbnRpdHldID0gKHN0YXRzLmJ5RW50aXR5W2kuZW50aXR5XSB8fCAwKSArIDE7XG4gICAgICBjb25zdCBlcnIgPSAoaS5lcnJvckNvZGUgPz8gJ3Vua25vd24nKS50b1N0cmluZygpO1xuICAgICAgc3RhdHMuYnlFcnJvcltlcnJdID0gKHN0YXRzLmJ5RXJyb3JbZXJyXSB8fCAwKSArIDE7XG4gICAgfSk7XG4gICAgcmV0dXJuIHN0YXRzO1xuICB9XG5cbiAgcHJpdmF0ZSBpc1JldHJ5YWJsZShlcnJvcjogYW55KTogYm9vbGVhbiB7XG4gICAgaWYgKCFlcnJvcikgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChlcnJvcj8uY29kZSA9PT0gJ05FVFdPUktfRVJST1InKSByZXR1cm4gdHJ1ZTtcbiAgICBpZiAoZXJyb3I/LmNvZGUgPT09ICdUSU1FT1VUJykgcmV0dXJuIHRydWU7XG4gICAgaWYgKGVycm9yPy5zdGF0dXMgPT09IDQyOSkgcmV0dXJuIHRydWU7XG4gICAgaWYgKGVycm9yPy5zdGF0dXMgPj0gNTAwICYmIGVycm9yPy5zdGF0dXMgPCA2MDApIHJldHVybiB0cnVlO1xuICAgIGlmIChlcnJvcj8uc3RhdHVzID09PSA0MDEgfHwgZXJyb3I/LnN0YXR1cyA9PT0gNDAzKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKGVycm9yPy5zdGF0dXMgPT09IDQwMCkgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0UXVldWUoKTogUHJvbWlzZTxEZWFkTGV0dGVySXRlbVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJhdyA9IGF3YWl0IEFzeW5jU3RvcmFnZS5nZXRJdGVtKHRoaXMuU1RPUkFHRV9LRVkpO1xuICAgICAgcmV0dXJuIHJhdyA/IEpTT04ucGFyc2UocmF3KSA6IFtdO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgc2F2ZVF1ZXVlKHF1ZXVlOiBEZWFkTGV0dGVySXRlbVtdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgQXN5bmNTdG9yYWdlLnNldEl0ZW0odGhpcy5TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkocXVldWUpKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmVtb3ZlRnJvbVF1ZXVlKGl0ZW1JZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcXVldWUgPSBhd2FpdCB0aGlzLmdldFF1ZXVlKCk7XG4gICAgY29uc3QgZmlsdGVyZWQgPSBxdWV1ZS5maWx0ZXIoaSA9PiBpLmlkICE9PSBpdGVtSWQpO1xuICAgIGF3YWl0IHRoaXMuc2F2ZVF1ZXVlKGZpbHRlcmVkKTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgZGVhZExldHRlclF1ZXVlID0gRGVhZExldHRlclF1ZXVlU2VydmljZS5nZXRJbnN0YW5jZSgpO1xuZXhwb3J0IGRlZmF1bHQgZGVhZExldHRlclF1ZXVlO1xuXG5cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7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