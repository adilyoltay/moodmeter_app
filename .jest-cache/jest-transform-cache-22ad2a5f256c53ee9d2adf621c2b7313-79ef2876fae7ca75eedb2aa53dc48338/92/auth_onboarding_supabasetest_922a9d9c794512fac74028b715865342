912de833d10807d57ce5f2f4d820d018
_getJestObj().mock("../../lib/supabase", function () {
  return {
    supabase: mockClient
  };
});
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _supabase = _interopRequireWildcard(require("../../services/supabase"));
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function _interopRequireWildcard(e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (var _t in e) "default" !== _t && {}.hasOwnProperty.call(e, _t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, _t)) && (i.get || i.set) ? o(f, _t, i) : f[_t] = e[_t]); return f; })(e, t); }
function _getJestObj() {
  var _require = require("@jest/globals"),
    jest = _require.jest;
  _getJestObj = function _getJestObj() {
    return jest;
  };
  return jest;
}
var callLog = [];
function qb(table) {
  var state = {
    table: table,
    filters: []
  };
  var api = {
    select: jest.fn(function () {
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      callLog.push({
        op: 'select',
        table: table,
        args: args
      });
      return api;
    }),
    upsert: jest.fn(function () {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }
      callLog.push({
        op: 'upsert',
        table: table,
        args: args
      });
      return api;
    }),
    insert: jest.fn(function () {
      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
        args[_key3] = arguments[_key3];
      }
      callLog.push({
        op: 'insert',
        table: table,
        args: args
      });
      return api;
    }),
    update: jest.fn(function () {
      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
        args[_key4] = arguments[_key4];
      }
      callLog.push({
        op: 'update',
        table: table,
        args: args
      });
      return api;
    }),
    delete: jest.fn(function () {
      for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {
        args[_key5] = arguments[_key5];
      }
      callLog.push({
        op: 'delete',
        table: table,
        args: args
      });
      return api;
    }),
    eq: jest.fn(function (field, value) {
      state.filters.push({
        field: field,
        value: value
      });
      return api;
    }),
    maybeSingle: jest.fn((0, _asyncToGenerator2.default)(function* () {
      return {
        data: null,
        error: null
      };
    })),
    single: jest.fn((0, _asyncToGenerator2.default)(function* () {
      return {
        data: {
          ok: true
        },
        error: null
      };
    }))
  };
  return api;
}
var mockAuth = {
  getUser: jest.fn((0, _asyncToGenerator2.default)(function* () {
    return {
      user: {
        id: 'user-1',
        email: 'new@user.test',
        user_metadata: {
          name: 'New User'
        },
        app_metadata: {
          provider: 'email'
        }
      }
    };
  })),
  updateUser: jest.fn((0, _asyncToGenerator2.default)(function* () {
    return {
      data: {},
      error: null
    };
  }))
};
var mockClient = {
  from: jest.fn(function (table) {
    return qb(table);
  }),
  auth: mockAuth
};
beforeEach(function () {
  callLog.length = 0;
  jest.clearAllMocks();
});
describe('Signup + Onboarding Supabase writes', function () {
  test('createGamificationProfile ensures users row upsert when missing', (0, _asyncToGenerator2.default)(function* () {
    var qbUsers = qb('users');
    mockClient.from.mockImplementation(function (table) {
      if (table === 'users') {
        qbUsers.single.mockResolvedValueOnce({
          data: null,
          error: null
        });
        return qbUsers;
      }
      return qb(table);
    });
    var svc = _supabase.supabaseService || _supabase.default;
    var res = yield svc.createGamificationProfile('user-1');
    var usersUpsert = callLog.find(function (l) {
      return l.op === 'upsert' && l.table === 'users';
    });
    expect(usersUpsert).toBeTruthy();
    var upsertBody = usersUpsert.args[0];
    expect(upsertBody).toMatchObject({
      id: 'user-1',
      email: 'new@user.test',
      provider: 'email'
    });
    var gpUpsert = callLog.find(function (l) {
      return l.op === 'upsert' && l.table === 'gamification_profiles';
    });
    expect(gpUpsert).toBeTruthy();
    expect(res === null || typeof res === 'object').toBe(true);
  }));
  test('upsertUserProfile maps onboarding payload correctly into user_profiles', (0, _asyncToGenerator2.default)(function* () {
    var userId = 'user-2';
    var payload = {
      profile: {
        age: 27,
        gender: 'male',
        locale: 'tr-TR',
        timezone: 'Europe/Istanbul'
      },
      motivation: ['stress_reduction', 'mental_clarity'],
      first_mood: {
        score: 6,
        tags: ['work', 'sleep']
      },
      lifestyle: {
        sleep_hours: 5,
        exercise: 'Regular',
        social: 'High'
      },
      reminders: {
        enabled: true,
        time: '21:30',
        days: ['Mon', 'Wed'],
        timezone: 'Europe/Istanbul'
      },
      feature_flags: {
        a: true,
        b: false
      },
      consent: {
        accepted: true
      }
    };
    mockClient.from.mockImplementation(function (table) {
      return qb(table);
    });
    var svc = _supabase.supabaseService || _supabase.default;
    yield svc.upsertUserProfile(userId, payload);
    var upsert = callLog.find(function (l) {
      return l.op === 'upsert' && l.table === 'user_profiles';
    });
    expect(upsert).toBeTruthy();
    var body = upsert.args[0];
    expect(body.user_id).toBe(userId);
    expect(body.motivations).toEqual(['stress_reduction', 'mental_clarity']);
    expect(body.first_mood_score).toBe(5);
    expect(body.first_mood_tags).toEqual(['work', 'sleep']);
    expect(body.reminder_enabled).toBe(true);
    expect(body.reminder_time).toBe('21:30');
    expect(body.feature_flags).toEqual({
      a: true,
      b: false
    });
    expect(body.onboarding_version).toBe(2);
    expect(typeof body.onboarding_completed_at).toBe('string');
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJzdXBhYmFzZSIsIm1vY2tDbGllbnQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9hc3luY1RvR2VuZXJhdG9yMiIsIl9zdXBhYmFzZSIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwiZSIsInQiLCJXZWFrTWFwIiwiciIsIm4iLCJfX2VzTW9kdWxlIiwibyIsImkiLCJmIiwiX19wcm90b19fIiwiZGVmYXVsdCIsImhhcyIsImdldCIsInNldCIsIl90IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJfcmVxdWlyZSIsImplc3QiLCJjYWxsTG9nIiwicWIiLCJ0YWJsZSIsInN0YXRlIiwiZmlsdGVycyIsImFwaSIsInNlbGVjdCIsImZuIiwiX2xlbiIsImFyZ3VtZW50cyIsImxlbmd0aCIsImFyZ3MiLCJBcnJheSIsIl9rZXkiLCJwdXNoIiwib3AiLCJ1cHNlcnQiLCJfbGVuMiIsIl9rZXkyIiwiaW5zZXJ0IiwiX2xlbjMiLCJfa2V5MyIsInVwZGF0ZSIsIl9sZW40IiwiX2tleTQiLCJkZWxldGUiLCJfbGVuNSIsIl9rZXk1IiwiZXEiLCJmaWVsZCIsInZhbHVlIiwibWF5YmVTaW5nbGUiLCJkYXRhIiwiZXJyb3IiLCJzaW5nbGUiLCJvayIsIm1vY2tBdXRoIiwiZ2V0VXNlciIsInVzZXIiLCJpZCIsImVtYWlsIiwidXNlcl9tZXRhZGF0YSIsIm5hbWUiLCJhcHBfbWV0YWRhdGEiLCJwcm92aWRlciIsInVwZGF0ZVVzZXIiLCJmcm9tIiwiYXV0aCIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwiZGVzY3JpYmUiLCJ0ZXN0IiwicWJVc2VycyIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsIm1vY2tSZXNvbHZlZFZhbHVlT25jZSIsInN2YyIsInN1cGFiYXNlTmFtZWQiLCJzdXBhYmFzZURlZmF1bHQiLCJyZXMiLCJjcmVhdGVHYW1pZmljYXRpb25Qcm9maWxlIiwidXNlcnNVcHNlcnQiLCJmaW5kIiwibCIsImV4cGVjdCIsInRvQmVUcnV0aHkiLCJ1cHNlcnRCb2R5IiwidG9NYXRjaE9iamVjdCIsImdwVXBzZXJ0IiwidG9CZSIsInVzZXJJZCIsInBheWxvYWQiLCJwcm9maWxlIiwiYWdlIiwiZ2VuZGVyIiwibG9jYWxlIiwidGltZXpvbmUiLCJtb3RpdmF0aW9uIiwiZmlyc3RfbW9vZCIsInNjb3JlIiwidGFncyIsImxpZmVzdHlsZSIsInNsZWVwX2hvdXJzIiwiZXhlcmNpc2UiLCJzb2NpYWwiLCJyZW1pbmRlcnMiLCJlbmFibGVkIiwidGltZSIsImRheXMiLCJmZWF0dXJlX2ZsYWdzIiwiYSIsImIiLCJjb25zZW50IiwiYWNjZXB0ZWQiLCJ1cHNlcnRVc2VyUHJvZmlsZSIsImJvZHkiLCJ1c2VyX2lkIiwibW90aXZhdGlvbnMiLCJ0b0VxdWFsIiwiZmlyc3RfbW9vZF9zY29yZSIsImZpcnN0X21vb2RfdGFncyIsInJlbWluZGVyX2VuYWJsZWQiLCJyZW1pbmRlcl90aW1lIiwib25ib2FyZGluZ192ZXJzaW9uIiwib25ib2FyZGluZ19jb21wbGV0ZWRfYXQiXSwic291cmNlcyI6WyJhdXRoX29uYm9hcmRpbmdfc3VwYWJhc2UudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgc3VwYWJhc2VEZWZhdWx0LCB7IHN1cGFiYXNlU2VydmljZSBhcyBzdXBhYmFzZU5hbWVkIH0gZnJvbSAnQC9zZXJ2aWNlcy9zdXBhYmFzZSc7XG5cbi8vIExpZ2h0d2VpZ2h0IFN1cGFiYXNlIGNsaWVudCBtb2NrIHdpcmVkIHZpYSBtb2R1bGUgYWxpYXNcbnR5cGUgQW55Rm4gPSAoLi4uYXJnczogYW55W10pID0+IGFueTtcblxuY29uc3QgY2FsbExvZzogYW55W10gPSBbXTtcblxuLy8gQ2hhaW5hYmxlIHF1ZXJ5IGJ1aWxkZXIgbW9ja1xuZnVuY3Rpb24gcWIodGFibGU6IHN0cmluZykge1xuICBjb25zdCBzdGF0ZTogYW55ID0geyB0YWJsZSwgZmlsdGVyczogW10gfTtcbiAgY29uc3QgYXBpOiBhbnkgPSB7XG4gICAgc2VsZWN0OiBqZXN0LmZuKCguLi5hcmdzOiBhbnlbXSkgPT4geyBjYWxsTG9nLnB1c2goeyBvcDogJ3NlbGVjdCcsIHRhYmxlLCBhcmdzIH0pOyByZXR1cm4gYXBpOyB9KSxcbiAgICB1cHNlcnQ6IGplc3QuZm4oKC4uLmFyZ3M6IGFueVtdKSA9PiB7IGNhbGxMb2cucHVzaCh7IG9wOiAndXBzZXJ0JywgdGFibGUsIGFyZ3MgfSk7IHJldHVybiBhcGk7IH0pLFxuICAgIGluc2VydDogamVzdC5mbigoLi4uYXJnczogYW55W10pID0+IHsgY2FsbExvZy5wdXNoKHsgb3A6ICdpbnNlcnQnLCB0YWJsZSwgYXJncyB9KTsgcmV0dXJuIGFwaTsgfSksXG4gICAgdXBkYXRlOiBqZXN0LmZuKCguLi5hcmdzOiBhbnlbXSkgPT4geyBjYWxsTG9nLnB1c2goeyBvcDogJ3VwZGF0ZScsIHRhYmxlLCBhcmdzIH0pOyByZXR1cm4gYXBpOyB9KSxcbiAgICBkZWxldGU6IGplc3QuZm4oKC4uLmFyZ3M6IGFueVtdKSA9PiB7IGNhbGxMb2cucHVzaCh7IG9wOiAnZGVsZXRlJywgdGFibGUsIGFyZ3MgfSk7IHJldHVybiBhcGk7IH0pLFxuICAgIGVxOiBqZXN0LmZuKChmaWVsZDogc3RyaW5nLCB2YWx1ZTogYW55KSA9PiB7IHN0YXRlLmZpbHRlcnMucHVzaCh7IGZpZWxkLCB2YWx1ZSB9KTsgcmV0dXJuIGFwaTsgfSksXG4gICAgbWF5YmVTaW5nbGU6IGplc3QuZm4oYXN5bmMgKCkgPT4gKHsgZGF0YTogbnVsbCwgZXJyb3I6IG51bGwgfSkpLFxuICAgIHNpbmdsZTogamVzdC5mbihhc3luYyAoKSA9PiAoeyBkYXRhOiB7IG9rOiB0cnVlIH0sIGVycm9yOiBudWxsIH0pKSxcbiAgfTtcbiAgcmV0dXJuIGFwaTtcbn1cblxuY29uc3QgbW9ja0F1dGggPSB7XG4gIGdldFVzZXI6IGplc3QuZm4oYXN5bmMgKCkgPT4gKHtcbiAgICB1c2VyOiB7XG4gICAgICBpZDogJ3VzZXItMScsXG4gICAgICBlbWFpbDogJ25ld0B1c2VyLnRlc3QnLFxuICAgICAgdXNlcl9tZXRhZGF0YTogeyBuYW1lOiAnTmV3IFVzZXInIH0sXG4gICAgICBhcHBfbWV0YWRhdGE6IHsgcHJvdmlkZXI6ICdlbWFpbCcgfVxuICAgIH1cbiAgfSkpLFxuICB1cGRhdGVVc2VyOiBqZXN0LmZuKGFzeW5jICgpID0+ICh7IGRhdGE6IHt9LCBlcnJvcjogbnVsbCB9KSksXG59O1xuXG5jb25zdCBtb2NrQ2xpZW50ID0ge1xuICBmcm9tOiBqZXN0LmZuKCh0YWJsZTogc3RyaW5nKSA9PiBxYih0YWJsZSkpLFxuICBhdXRoOiBtb2NrQXV0aCxcbn07XG5cbmplc3QubW9jaygnQC9saWIvc3VwYWJhc2UnLCAoKSA9PiAoe1xuICBzdXBhYmFzZTogbW9ja0NsaWVudCxcbn0pKTtcblxuYmVmb3JlRWFjaCgoKSA9PiB7XG4gIGNhbGxMb2cubGVuZ3RoID0gMDtcbiAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG59KTtcblxuZGVzY3JpYmUoJ1NpZ251cCArIE9uYm9hcmRpbmcgU3VwYWJhc2Ugd3JpdGVzJywgKCkgPT4ge1xuICB0ZXN0KCdjcmVhdGVHYW1pZmljYXRpb25Qcm9maWxlIGVuc3VyZXMgdXNlcnMgcm93IHVwc2VydCB3aGVuIG1pc3NpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gQXJyYW5nZTogbWFrZSB1c2VycyBzZWxlY3QoKS5lcSgpLnNpbmdsZSgpIHJldHVybiBubyByb3dcbiAgICBjb25zdCBxYlVzZXJzID0gcWIoJ3VzZXJzJyk7XG4gICAgKG1vY2tDbGllbnQuZnJvbSBhcyBBbnlGbikubW9ja0ltcGxlbWVudGF0aW9uKCh0YWJsZTogc3RyaW5nKSA9PiB7XG4gICAgICBpZiAodGFibGUgPT09ICd1c2VycycpIHtcbiAgICAgICAgLy8gb3ZlcnJpZGUgc2luZ2xlKCkgZm9yIGZpcnN0IHNlbGVjdCB0byBzaW11bGF0ZSBtaXNzaW5nIHVzZXJcbiAgICAgICAgcWJVc2Vycy5zaW5nbGUubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHsgZGF0YTogbnVsbCwgZXJyb3I6IG51bGwgfSk7XG4gICAgICAgIC8vIGZvciB1cHNlcnQoKS5zZWxlY3QoKS5zaW5nbGUoKSBhZnRlciBlbnN1cmVVc2VyUHJvZmlsZUV4aXN0c1xuICAgICAgICByZXR1cm4gcWJVc2VycztcbiAgICAgIH1cbiAgICAgIHJldHVybiBxYih0YWJsZSk7XG4gICAgfSk7XG5cbiAgICAvLyBBY3RcbiAgICBjb25zdCBzdmMgPSAoc3VwYWJhc2VOYW1lZCB8fCBzdXBhYmFzZURlZmF1bHQpIGFzIGFueTtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBzdmMuY3JlYXRlR2FtaWZpY2F0aW9uUHJvZmlsZSgndXNlci0xJyk7XG5cbiAgICAvLyBBc3NlcnQ6IHVzZXJzIHVwc2VydCBjYWxsZWQgd2l0aCBpZC9lbWFpbC9uYW1lL3Byb3ZpZGVyXG4gICAgY29uc3QgdXNlcnNVcHNlcnQgPSBjYWxsTG9nLmZpbmQobCA9PiBsLm9wID09PSAndXBzZXJ0JyAmJiBsLnRhYmxlID09PSAndXNlcnMnKTtcbiAgICBleHBlY3QodXNlcnNVcHNlcnQpLnRvQmVUcnV0aHkoKTtcbiAgICBjb25zdCB1cHNlcnRCb2R5ID0gdXNlcnNVcHNlcnQuYXJnc1swXTtcbiAgICBleHBlY3QodXBzZXJ0Qm9keSkudG9NYXRjaE9iamVjdCh7IGlkOiAndXNlci0xJywgZW1haWw6ICduZXdAdXNlci50ZXN0JywgcHJvdmlkZXI6ICdlbWFpbCcgfSk7XG5cbiAgICAvLyBBbmQgZ2FtaWZpY2F0aW9uX3Byb2ZpbGVzIHVwc2VydCBleGVjdXRlZFxuICAgIGNvbnN0IGdwVXBzZXJ0ID0gY2FsbExvZy5maW5kKGwgPT4gbC5vcCA9PT0gJ3Vwc2VydCcgJiYgbC50YWJsZSA9PT0gJ2dhbWlmaWNhdGlvbl9wcm9maWxlcycpO1xuICAgIGV4cGVjdChncFVwc2VydCkudG9CZVRydXRoeSgpO1xuICAgIGV4cGVjdChyZXMgPT09IG51bGwgfHwgdHlwZW9mIHJlcyA9PT0gJ29iamVjdCcpLnRvQmUodHJ1ZSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Vwc2VydFVzZXJQcm9maWxlIG1hcHMgb25ib2FyZGluZyBwYXlsb2FkIGNvcnJlY3RseSBpbnRvIHVzZXJfcHJvZmlsZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgdXNlcklkID0gJ3VzZXItMic7XG4gICAgY29uc3QgcGF5bG9hZCA9IHtcbiAgICAgIHByb2ZpbGU6IHsgYWdlOiAyNywgZ2VuZGVyOiAnbWFsZScsIGxvY2FsZTogJ3RyLVRSJywgdGltZXpvbmU6ICdFdXJvcGUvSXN0YW5idWwnIH0sXG4gICAgICBtb3RpdmF0aW9uOiBbJ3N0cmVzc19yZWR1Y3Rpb24nLCAnbWVudGFsX2NsYXJpdHknXSxcbiAgICAgIGZpcnN0X21vb2Q6IHsgc2NvcmU6IDYsIHRhZ3M6IFsnd29yaycsICdzbGVlcCddIH0sIC8vIHNjb3JlIHNob3VsZCBjbGFtcCB0byA1XG4gICAgICBsaWZlc3R5bGU6IHsgc2xlZXBfaG91cnM6IDUsIGV4ZXJjaXNlOiAnUmVndWxhcicsIHNvY2lhbDogJ0hpZ2gnIH0sXG4gICAgICByZW1pbmRlcnM6IHsgZW5hYmxlZDogdHJ1ZSwgdGltZTogJzIxOjMwJywgZGF5czogWydNb24nLCdXZWQnXSwgdGltZXpvbmU6ICdFdXJvcGUvSXN0YW5idWwnIH0sXG4gICAgICBmZWF0dXJlX2ZsYWdzOiB7IGE6IHRydWUsIGI6IGZhbHNlIH0sXG4gICAgICBjb25zZW50OiB7IGFjY2VwdGVkOiB0cnVlIH0sXG4gICAgfTtcblxuICAgIC8vIGZyZXNoIG1vY2sgcGVyIHRlc3RcbiAgICAobW9ja0NsaWVudC5mcm9tIGFzIEFueUZuKS5tb2NrSW1wbGVtZW50YXRpb24oKHRhYmxlOiBzdHJpbmcpID0+IHFiKHRhYmxlKSk7XG5cbiAgICBjb25zdCBzdmMgPSAoc3VwYWJhc2VOYW1lZCB8fCBzdXBhYmFzZURlZmF1bHQpIGFzIGFueTtcbiAgICBhd2FpdCBzdmMudXBzZXJ0VXNlclByb2ZpbGUodXNlcklkLCBwYXlsb2FkKTtcblxuICAgIGNvbnN0IHVwc2VydCA9IGNhbGxMb2cuZmluZChsID0+IGwub3AgPT09ICd1cHNlcnQnICYmIGwudGFibGUgPT09ICd1c2VyX3Byb2ZpbGVzJyk7XG4gICAgZXhwZWN0KHVwc2VydCkudG9CZVRydXRoeSgpO1xuICAgIGNvbnN0IGJvZHkgPSB1cHNlcnQuYXJnc1swXTtcblxuICAgIC8vIEtleSBmaWVsZCBleHBlY3RhdGlvbnNcbiAgICBleHBlY3QoYm9keS51c2VyX2lkKS50b0JlKHVzZXJJZCk7XG4gICAgZXhwZWN0KGJvZHkubW90aXZhdGlvbnMpLnRvRXF1YWwoWydzdHJlc3NfcmVkdWN0aW9uJywgJ21lbnRhbF9jbGFyaXR5J10pO1xuICAgIGV4cGVjdChib2R5LmZpcnN0X21vb2Rfc2NvcmUpLnRvQmUoNSk7IC8vIGNsYW1wZWRcbiAgICBleHBlY3QoYm9keS5maXJzdF9tb29kX3RhZ3MpLnRvRXF1YWwoWyd3b3JrJywnc2xlZXAnXSk7XG4gICAgZXhwZWN0KGJvZHkucmVtaW5kZXJfZW5hYmxlZCkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoYm9keS5yZW1pbmRlcl90aW1lKS50b0JlKCcyMTozMCcpO1xuICAgIGV4cGVjdChib2R5LmZlYXR1cmVfZmxhZ3MpLnRvRXF1YWwoeyBhOiB0cnVlLCBiOiBmYWxzZSB9KTtcbiAgICBleHBlY3QoYm9keS5vbmJvYXJkaW5nX3ZlcnNpb24pLnRvQmUoMik7XG4gICAgZXhwZWN0KHR5cGVvZiBib2R5Lm9uYm9hcmRpbmdfY29tcGxldGVkX2F0KS50b0JlKCdzdHJpbmcnKTtcbiAgfSk7XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBd0NBQSxXQUFBLEdBQUtDLElBQUksdUJBQW1CO0VBQUEsT0FBTztJQUNqQ0MsUUFBUSxFQUFFQztFQUNaLENBQUM7QUFBQSxDQUFDLENBQUM7QUFBQyxJQUFBQyxzQkFBQSxHQUFBQyxPQUFBO0FBQUEsSUFBQUMsa0JBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQTFDSixJQUFBRSxTQUFBLEdBQUFDLHVCQUFBLENBQUFILE9BQUE7QUFBd0YsU0FBQUcsd0JBQUFDLENBQUEsRUFBQUMsQ0FBQSw2QkFBQUMsT0FBQSxNQUFBQyxDQUFBLE9BQUFELE9BQUEsSUFBQUUsQ0FBQSxPQUFBRixPQUFBLFlBQUFILHVCQUFBLFlBQUFBLHdCQUFBQyxDQUFBLEVBQUFDLENBQUEsU0FBQUEsQ0FBQSxJQUFBRCxDQUFBLElBQUFBLENBQUEsQ0FBQUssVUFBQSxTQUFBTCxDQUFBLE1BQUFNLENBQUEsRUFBQUMsQ0FBQSxFQUFBQyxDQUFBLEtBQUFDLFNBQUEsUUFBQUMsT0FBQSxFQUFBVixDQUFBLGlCQUFBQSxDQUFBLHVCQUFBQSxDQUFBLHlCQUFBQSxDQUFBLFNBQUFRLENBQUEsTUFBQUYsQ0FBQSxHQUFBTCxDQUFBLEdBQUFHLENBQUEsR0FBQUQsQ0FBQSxRQUFBRyxDQUFBLENBQUFLLEdBQUEsQ0FBQVgsQ0FBQSxVQUFBTSxDQUFBLENBQUFNLEdBQUEsQ0FBQVosQ0FBQSxHQUFBTSxDQUFBLENBQUFPLEdBQUEsQ0FBQWIsQ0FBQSxFQUFBUSxDQUFBLGNBQUFNLEVBQUEsSUFBQWQsQ0FBQSxnQkFBQWMsRUFBQSxPQUFBQyxjQUFBLENBQUFDLElBQUEsQ0FBQWhCLENBQUEsRUFBQWMsRUFBQSxPQUFBUCxDQUFBLElBQUFELENBQUEsR0FBQVcsTUFBQSxDQUFBQyxjQUFBLEtBQUFELE1BQUEsQ0FBQUUsd0JBQUEsQ0FBQW5CLENBQUEsRUFBQWMsRUFBQSxPQUFBUCxDQUFBLENBQUFLLEdBQUEsSUFBQUwsQ0FBQSxDQUFBTSxHQUFBLElBQUFQLENBQUEsQ0FBQUUsQ0FBQSxFQUFBTSxFQUFBLEVBQUFQLENBQUEsSUFBQUMsQ0FBQSxDQUFBTSxFQUFBLElBQUFkLENBQUEsQ0FBQWMsRUFBQSxXQUFBTixDQUFBLEtBQUFSLENBQUEsRUFBQUMsQ0FBQTtBQUFBLFNBQUFWLFlBQUE7RUFBQSxJQUFBNkIsUUFBQSxHQUFBeEIsT0FBQTtJQUFBeUIsSUFBQSxHQUFBRCxRQUFBLENBQUFDLElBQUE7RUFBQTlCLFdBQUEsWUFBQUEsWUFBQTtJQUFBLE9BQUE4QixJQUFBO0VBQUE7RUFBQSxPQUFBQSxJQUFBO0FBQUE7QUFLeEYsSUFBTUMsT0FBYyxHQUFHLEVBQUU7QUFHekIsU0FBU0MsRUFBRUEsQ0FBQ0MsS0FBYSxFQUFFO0VBQ3pCLElBQU1DLEtBQVUsR0FBRztJQUFFRCxLQUFLLEVBQUxBLEtBQUs7SUFBRUUsT0FBTyxFQUFFO0VBQUcsQ0FBQztFQUN6QyxJQUFNQyxHQUFRLEdBQUc7SUFDZkMsTUFBTSxFQUFFUCxJQUFJLENBQUNRLEVBQUUsQ0FBQyxZQUFvQjtNQUFBLFNBQUFDLElBQUEsR0FBQUMsU0FBQSxDQUFBQyxNQUFBLEVBQWhCQyxJQUFJLE9BQUFDLEtBQUEsQ0FBQUosSUFBQSxHQUFBSyxJQUFBLE1BQUFBLElBQUEsR0FBQUwsSUFBQSxFQUFBSyxJQUFBO1FBQUpGLElBQUksQ0FBQUUsSUFBQSxJQUFBSixTQUFBLENBQUFJLElBQUE7TUFBQTtNQUFjYixPQUFPLENBQUNjLElBQUksQ0FBQztRQUFFQyxFQUFFLEVBQUUsUUFBUTtRQUFFYixLQUFLLEVBQUxBLEtBQUs7UUFBRVMsSUFBSSxFQUFKQTtNQUFLLENBQUMsQ0FBQztNQUFFLE9BQU9OLEdBQUc7SUFBRSxDQUFDLENBQUM7SUFDakdXLE1BQU0sRUFBRWpCLElBQUksQ0FBQ1EsRUFBRSxDQUFDLFlBQW9CO01BQUEsU0FBQVUsS0FBQSxHQUFBUixTQUFBLENBQUFDLE1BQUEsRUFBaEJDLElBQUksT0FBQUMsS0FBQSxDQUFBSyxLQUFBLEdBQUFDLEtBQUEsTUFBQUEsS0FBQSxHQUFBRCxLQUFBLEVBQUFDLEtBQUE7UUFBSlAsSUFBSSxDQUFBTyxLQUFBLElBQUFULFNBQUEsQ0FBQVMsS0FBQTtNQUFBO01BQWNsQixPQUFPLENBQUNjLElBQUksQ0FBQztRQUFFQyxFQUFFLEVBQUUsUUFBUTtRQUFFYixLQUFLLEVBQUxBLEtBQUs7UUFBRVMsSUFBSSxFQUFKQTtNQUFLLENBQUMsQ0FBQztNQUFFLE9BQU9OLEdBQUc7SUFBRSxDQUFDLENBQUM7SUFDakdjLE1BQU0sRUFBRXBCLElBQUksQ0FBQ1EsRUFBRSxDQUFDLFlBQW9CO01BQUEsU0FBQWEsS0FBQSxHQUFBWCxTQUFBLENBQUFDLE1BQUEsRUFBaEJDLElBQUksT0FBQUMsS0FBQSxDQUFBUSxLQUFBLEdBQUFDLEtBQUEsTUFBQUEsS0FBQSxHQUFBRCxLQUFBLEVBQUFDLEtBQUE7UUFBSlYsSUFBSSxDQUFBVSxLQUFBLElBQUFaLFNBQUEsQ0FBQVksS0FBQTtNQUFBO01BQWNyQixPQUFPLENBQUNjLElBQUksQ0FBQztRQUFFQyxFQUFFLEVBQUUsUUFBUTtRQUFFYixLQUFLLEVBQUxBLEtBQUs7UUFBRVMsSUFBSSxFQUFKQTtNQUFLLENBQUMsQ0FBQztNQUFFLE9BQU9OLEdBQUc7SUFBRSxDQUFDLENBQUM7SUFDakdpQixNQUFNLEVBQUV2QixJQUFJLENBQUNRLEVBQUUsQ0FBQyxZQUFvQjtNQUFBLFNBQUFnQixLQUFBLEdBQUFkLFNBQUEsQ0FBQUMsTUFBQSxFQUFoQkMsSUFBSSxPQUFBQyxLQUFBLENBQUFXLEtBQUEsR0FBQUMsS0FBQSxNQUFBQSxLQUFBLEdBQUFELEtBQUEsRUFBQUMsS0FBQTtRQUFKYixJQUFJLENBQUFhLEtBQUEsSUFBQWYsU0FBQSxDQUFBZSxLQUFBO01BQUE7TUFBY3hCLE9BQU8sQ0FBQ2MsSUFBSSxDQUFDO1FBQUVDLEVBQUUsRUFBRSxRQUFRO1FBQUViLEtBQUssRUFBTEEsS0FBSztRQUFFUyxJQUFJLEVBQUpBO01BQUssQ0FBQyxDQUFDO01BQUUsT0FBT04sR0FBRztJQUFFLENBQUMsQ0FBQztJQUNqR29CLE1BQU0sRUFBRTFCLElBQUksQ0FBQ1EsRUFBRSxDQUFDLFlBQW9CO01BQUEsU0FBQW1CLEtBQUEsR0FBQWpCLFNBQUEsQ0FBQUMsTUFBQSxFQUFoQkMsSUFBSSxPQUFBQyxLQUFBLENBQUFjLEtBQUEsR0FBQUMsS0FBQSxNQUFBQSxLQUFBLEdBQUFELEtBQUEsRUFBQUMsS0FBQTtRQUFKaEIsSUFBSSxDQUFBZ0IsS0FBQSxJQUFBbEIsU0FBQSxDQUFBa0IsS0FBQTtNQUFBO01BQWMzQixPQUFPLENBQUNjLElBQUksQ0FBQztRQUFFQyxFQUFFLEVBQUUsUUFBUTtRQUFFYixLQUFLLEVBQUxBLEtBQUs7UUFBRVMsSUFBSSxFQUFKQTtNQUFLLENBQUMsQ0FBQztNQUFFLE9BQU9OLEdBQUc7SUFBRSxDQUFDLENBQUM7SUFDakd1QixFQUFFLEVBQUU3QixJQUFJLENBQUNRLEVBQUUsQ0FBQyxVQUFDc0IsS0FBYSxFQUFFQyxLQUFVLEVBQUs7TUFBRTNCLEtBQUssQ0FBQ0MsT0FBTyxDQUFDVSxJQUFJLENBQUM7UUFBRWUsS0FBSyxFQUFMQSxLQUFLO1FBQUVDLEtBQUssRUFBTEE7TUFBTSxDQUFDLENBQUM7TUFBRSxPQUFPekIsR0FBRztJQUFFLENBQUMsQ0FBQztJQUNqRzBCLFdBQVcsRUFBRWhDLElBQUksQ0FBQ1EsRUFBRSxLQUFBaEMsa0JBQUEsQ0FBQWEsT0FBQSxFQUFDO01BQUEsT0FBYTtRQUFFNEMsSUFBSSxFQUFFLElBQUk7UUFBRUMsS0FBSyxFQUFFO01BQUssQ0FBQztJQUFBLENBQUMsRUFBQztJQUMvREMsTUFBTSxFQUFFbkMsSUFBSSxDQUFDUSxFQUFFLEtBQUFoQyxrQkFBQSxDQUFBYSxPQUFBLEVBQUM7TUFBQSxPQUFhO1FBQUU0QyxJQUFJLEVBQUU7VUFBRUcsRUFBRSxFQUFFO1FBQUssQ0FBQztRQUFFRixLQUFLLEVBQUU7TUFBSyxDQUFDO0lBQUEsQ0FBQztFQUNuRSxDQUFDO0VBQ0QsT0FBTzVCLEdBQUc7QUFDWjtBQUVBLElBQU0rQixRQUFRLEdBQUc7RUFDZkMsT0FBTyxFQUFFdEMsSUFBSSxDQUFDUSxFQUFFLEtBQUFoQyxrQkFBQSxDQUFBYSxPQUFBLEVBQUM7SUFBQSxPQUFhO01BQzVCa0QsSUFBSSxFQUFFO1FBQ0pDLEVBQUUsRUFBRSxRQUFRO1FBQ1pDLEtBQUssRUFBRSxlQUFlO1FBQ3RCQyxhQUFhLEVBQUU7VUFBRUMsSUFBSSxFQUFFO1FBQVcsQ0FBQztRQUNuQ0MsWUFBWSxFQUFFO1VBQUVDLFFBQVEsRUFBRTtRQUFRO01BQ3BDO0lBQ0YsQ0FBQztFQUFBLENBQUMsRUFBQztFQUNIQyxVQUFVLEVBQUU5QyxJQUFJLENBQUNRLEVBQUUsS0FBQWhDLGtCQUFBLENBQUFhLE9BQUEsRUFBQztJQUFBLE9BQWE7TUFBRTRDLElBQUksRUFBRSxDQUFDLENBQUM7TUFBRUMsS0FBSyxFQUFFO0lBQUssQ0FBQztFQUFBLENBQUM7QUFDN0QsQ0FBQztBQUVELElBQU03RCxVQUFVLEdBQUc7RUFDakIwRSxJQUFJLEVBQUUvQyxJQUFJLENBQUNRLEVBQUUsQ0FBQyxVQUFDTCxLQUFhO0lBQUEsT0FBS0QsRUFBRSxDQUFDQyxLQUFLLENBQUM7RUFBQSxFQUFDO0VBQzNDNkMsSUFBSSxFQUFFWDtBQUNSLENBQUM7QUFNRFksVUFBVSxDQUFDLFlBQU07RUFDZmhELE9BQU8sQ0FBQ1UsTUFBTSxHQUFHLENBQUM7RUFDbEJYLElBQUksQ0FBQ2tELGFBQWEsQ0FBQyxDQUFDO0FBQ3RCLENBQUMsQ0FBQztBQUVGQyxRQUFRLENBQUMscUNBQXFDLEVBQUUsWUFBTTtFQUNwREMsSUFBSSxDQUFDLGlFQUFpRSxNQUFBNUUsa0JBQUEsQ0FBQWEsT0FBQSxFQUFFLGFBQVk7SUFFbEYsSUFBTWdFLE9BQU8sR0FBR25ELEVBQUUsQ0FBQyxPQUFPLENBQUM7SUFDMUI3QixVQUFVLENBQUMwRSxJQUFJLENBQVdPLGtCQUFrQixDQUFDLFVBQUNuRCxLQUFhLEVBQUs7TUFDL0QsSUFBSUEsS0FBSyxLQUFLLE9BQU8sRUFBRTtRQUVyQmtELE9BQU8sQ0FBQ2xCLE1BQU0sQ0FBQ29CLHFCQUFxQixDQUFDO1VBQUV0QixJQUFJLEVBQUUsSUFBSTtVQUFFQyxLQUFLLEVBQUU7UUFBSyxDQUFDLENBQUM7UUFFakUsT0FBT21CLE9BQU87TUFDaEI7TUFDQSxPQUFPbkQsRUFBRSxDQUFDQyxLQUFLLENBQUM7SUFDbEIsQ0FBQyxDQUFDO0lBR0YsSUFBTXFELEdBQUcsR0FBSUMseUJBQWEsSUFBSUMsaUJBQXVCO0lBQ3JELElBQU1DLEdBQUcsU0FBU0gsR0FBRyxDQUFDSSx5QkFBeUIsQ0FBQyxRQUFRLENBQUM7SUFHekQsSUFBTUMsV0FBVyxHQUFHNUQsT0FBTyxDQUFDNkQsSUFBSSxDQUFDLFVBQUFDLENBQUM7TUFBQSxPQUFJQSxDQUFDLENBQUMvQyxFQUFFLEtBQUssUUFBUSxJQUFJK0MsQ0FBQyxDQUFDNUQsS0FBSyxLQUFLLE9BQU87SUFBQSxFQUFDO0lBQy9FNkQsTUFBTSxDQUFDSCxXQUFXLENBQUMsQ0FBQ0ksVUFBVSxDQUFDLENBQUM7SUFDaEMsSUFBTUMsVUFBVSxHQUFHTCxXQUFXLENBQUNqRCxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ3RDb0QsTUFBTSxDQUFDRSxVQUFVLENBQUMsQ0FBQ0MsYUFBYSxDQUFDO01BQUUzQixFQUFFLEVBQUUsUUFBUTtNQUFFQyxLQUFLLEVBQUUsZUFBZTtNQUFFSSxRQUFRLEVBQUU7SUFBUSxDQUFDLENBQUM7SUFHN0YsSUFBTXVCLFFBQVEsR0FBR25FLE9BQU8sQ0FBQzZELElBQUksQ0FBQyxVQUFBQyxDQUFDO01BQUEsT0FBSUEsQ0FBQyxDQUFDL0MsRUFBRSxLQUFLLFFBQVEsSUFBSStDLENBQUMsQ0FBQzVELEtBQUssS0FBSyx1QkFBdUI7SUFBQSxFQUFDO0lBQzVGNkQsTUFBTSxDQUFDSSxRQUFRLENBQUMsQ0FBQ0gsVUFBVSxDQUFDLENBQUM7SUFDN0JELE1BQU0sQ0FBQ0wsR0FBRyxLQUFLLElBQUksSUFBSSxPQUFPQSxHQUFHLEtBQUssUUFBUSxDQUFDLENBQUNVLElBQUksQ0FBQyxJQUFJLENBQUM7RUFDNUQsQ0FBQyxFQUFDO0VBRUZqQixJQUFJLENBQUMsd0VBQXdFLE1BQUE1RSxrQkFBQSxDQUFBYSxPQUFBLEVBQUUsYUFBWTtJQUN6RixJQUFNaUYsTUFBTSxHQUFHLFFBQVE7SUFDdkIsSUFBTUMsT0FBTyxHQUFHO01BQ2RDLE9BQU8sRUFBRTtRQUFFQyxHQUFHLEVBQUUsRUFBRTtRQUFFQyxNQUFNLEVBQUUsTUFBTTtRQUFFQyxNQUFNLEVBQUUsT0FBTztRQUFFQyxRQUFRLEVBQUU7TUFBa0IsQ0FBQztNQUNsRkMsVUFBVSxFQUFFLENBQUMsa0JBQWtCLEVBQUUsZ0JBQWdCLENBQUM7TUFDbERDLFVBQVUsRUFBRTtRQUFFQyxLQUFLLEVBQUUsQ0FBQztRQUFFQyxJQUFJLEVBQUUsQ0FBQyxNQUFNLEVBQUUsT0FBTztNQUFFLENBQUM7TUFDakRDLFNBQVMsRUFBRTtRQUFFQyxXQUFXLEVBQUUsQ0FBQztRQUFFQyxRQUFRLEVBQUUsU0FBUztRQUFFQyxNQUFNLEVBQUU7TUFBTyxDQUFDO01BQ2xFQyxTQUFTLEVBQUU7UUFBRUMsT0FBTyxFQUFFLElBQUk7UUFBRUMsSUFBSSxFQUFFLE9BQU87UUFBRUMsSUFBSSxFQUFFLENBQUMsS0FBSyxFQUFDLEtBQUssQ0FBQztRQUFFWixRQUFRLEVBQUU7TUFBa0IsQ0FBQztNQUM3RmEsYUFBYSxFQUFFO1FBQUVDLENBQUMsRUFBRSxJQUFJO1FBQUVDLENBQUMsRUFBRTtNQUFNLENBQUM7TUFDcENDLE9BQU8sRUFBRTtRQUFFQyxRQUFRLEVBQUU7TUFBSztJQUM1QixDQUFDO0lBR0F4SCxVQUFVLENBQUMwRSxJQUFJLENBQVdPLGtCQUFrQixDQUFDLFVBQUNuRCxLQUFhO01BQUEsT0FBS0QsRUFBRSxDQUFDQyxLQUFLLENBQUM7SUFBQSxFQUFDO0lBRTNFLElBQU1xRCxHQUFHLEdBQUlDLHlCQUFhLElBQUlDLGlCQUF1QjtJQUNyRCxNQUFNRixHQUFHLENBQUNzQyxpQkFBaUIsQ0FBQ3hCLE1BQU0sRUFBRUMsT0FBTyxDQUFDO0lBRTVDLElBQU10RCxNQUFNLEdBQUdoQixPQUFPLENBQUM2RCxJQUFJLENBQUMsVUFBQUMsQ0FBQztNQUFBLE9BQUlBLENBQUMsQ0FBQy9DLEVBQUUsS0FBSyxRQUFRLElBQUkrQyxDQUFDLENBQUM1RCxLQUFLLEtBQUssZUFBZTtJQUFBLEVBQUM7SUFDbEY2RCxNQUFNLENBQUMvQyxNQUFNLENBQUMsQ0FBQ2dELFVBQVUsQ0FBQyxDQUFDO0lBQzNCLElBQU04QixJQUFJLEdBQUc5RSxNQUFNLENBQUNMLElBQUksQ0FBQyxDQUFDLENBQUM7SUFHM0JvRCxNQUFNLENBQUMrQixJQUFJLENBQUNDLE9BQU8sQ0FBQyxDQUFDM0IsSUFBSSxDQUFDQyxNQUFNLENBQUM7SUFDakNOLE1BQU0sQ0FBQytCLElBQUksQ0FBQ0UsV0FBVyxDQUFDLENBQUNDLE9BQU8sQ0FBQyxDQUFDLGtCQUFrQixFQUFFLGdCQUFnQixDQUFDLENBQUM7SUFDeEVsQyxNQUFNLENBQUMrQixJQUFJLENBQUNJLGdCQUFnQixDQUFDLENBQUM5QixJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ3JDTCxNQUFNLENBQUMrQixJQUFJLENBQUNLLGVBQWUsQ0FBQyxDQUFDRixPQUFPLENBQUMsQ0FBQyxNQUFNLEVBQUMsT0FBTyxDQUFDLENBQUM7SUFDdERsQyxNQUFNLENBQUMrQixJQUFJLENBQUNNLGdCQUFnQixDQUFDLENBQUNoQyxJQUFJLENBQUMsSUFBSSxDQUFDO0lBQ3hDTCxNQUFNLENBQUMrQixJQUFJLENBQUNPLGFBQWEsQ0FBQyxDQUFDakMsSUFBSSxDQUFDLE9BQU8sQ0FBQztJQUN4Q0wsTUFBTSxDQUFDK0IsSUFBSSxDQUFDTixhQUFhLENBQUMsQ0FBQ1MsT0FBTyxDQUFDO01BQUVSLENBQUMsRUFBRSxJQUFJO01BQUVDLENBQUMsRUFBRTtJQUFNLENBQUMsQ0FBQztJQUN6RDNCLE1BQU0sQ0FBQytCLElBQUksQ0FBQ1Esa0JBQWtCLENBQUMsQ0FBQ2xDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDdkNMLE1BQU0sQ0FBQyxPQUFPK0IsSUFBSSxDQUFDUyx1QkFBdUIsQ0FBQyxDQUFDbkMsSUFBSSxDQUFDLFFBQVEsQ0FBQztFQUM1RCxDQUFDLEVBQUM7QUFDSixDQUFDLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=