64ba8eab1cadbe03d4ab5bad9ce5eb8d
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _VirtualizeUtils = require("./VirtualizeUtils");
var _invariant = _interopRequireDefault(require("invariant"));
var ListMetricsAggregator = exports.default = function () {
  function ListMetricsAggregator() {
    (0, _classCallCheck2.default)(this, ListMetricsAggregator);
    this._averageCellLength = 0;
    this._cellMetrics = new Map();
    this._highestMeasuredCellIndex = 0;
    this._measuredCellsLength = 0;
    this._measuredCellsCount = 0;
    this._orientation = {
      horizontal: false,
      rtl: false
    };
  }
  return (0, _createClass2.default)(ListMetricsAggregator, [{
    key: "notifyCellLayout",
    value: function notifyCellLayout(_ref) {
      var cellIndex = _ref.cellIndex,
        cellKey = _ref.cellKey,
        orientation = _ref.orientation,
        layout = _ref.layout;
      this._invalidateIfOrientationChanged(orientation);
      var next = {
        index: cellIndex,
        length: this._selectLength(layout),
        isMounted: true,
        offset: this.flowRelativeOffset(layout)
      };
      var curr = this._cellMetrics.get(cellKey);
      if (!curr || next.offset !== curr.offset || next.length !== curr.length) {
        if (curr) {
          var dLength = next.length - curr.length;
          this._measuredCellsLength += dLength;
        } else {
          this._measuredCellsLength += next.length;
          this._measuredCellsCount += 1;
        }
        this._averageCellLength = this._measuredCellsLength / this._measuredCellsCount;
        this._cellMetrics.set(cellKey, next);
        this._highestMeasuredCellIndex = Math.max(this._highestMeasuredCellIndex, cellIndex);
        return true;
      } else {
        curr.isMounted = true;
        return false;
      }
    }
  }, {
    key: "notifyCellUnmounted",
    value: function notifyCellUnmounted(cellKey) {
      var curr = this._cellMetrics.get(cellKey);
      if (curr) {
        curr.isMounted = false;
      }
    }
  }, {
    key: "notifyListContentLayout",
    value: function notifyListContentLayout(_ref2) {
      var orientation = _ref2.orientation,
        layout = _ref2.layout;
      this._invalidateIfOrientationChanged(orientation);
      this._contentLength = this._selectLength(layout);
    }
  }, {
    key: "getAverageCellLength",
    value: function getAverageCellLength() {
      return this._averageCellLength;
    }
  }, {
    key: "getHighestMeasuredCellIndex",
    value: function getHighestMeasuredCellIndex() {
      return this._highestMeasuredCellIndex;
    }
  }, {
    key: "getCellMetricsApprox",
    value: function getCellMetricsApprox(index, props) {
      var frame = this.getCellMetrics(index, props);
      if (frame && frame.index === index) {
        return frame;
      } else {
        var offset;
        var highestMeasuredCellIndex = this.getHighestMeasuredCellIndex();
        if (highestMeasuredCellIndex < index) {
          var highestMeasuredCellFrame = this.getCellMetrics(highestMeasuredCellIndex, props);
          if (highestMeasuredCellFrame) {
            offset = highestMeasuredCellFrame.offset + highestMeasuredCellFrame.length + this._averageCellLength * (index - highestMeasuredCellIndex - 1);
          }
        }
        if (offset == null) {
          offset = this._averageCellLength * index;
        }
        var data = props.data,
          getItemCount = props.getItemCount;
        (0, _invariant.default)(index >= 0 && index < getItemCount(data), 'Tried to get frame for out of range index ' + index);
        return {
          length: this._averageCellLength,
          offset: offset,
          index: index,
          isMounted: false
        };
      }
    }
  }, {
    key: "getCellMetrics",
    value: function getCellMetrics(index, props) {
      var _props$keyExtractor;
      var data = props.data,
        getItem = props.getItem,
        getItemCount = props.getItemCount,
        getItemLayout = props.getItemLayout;
      (0, _invariant.default)(index >= 0 && index < getItemCount(data), 'Tried to get metrics for out of range cell index ' + index);
      var keyExtractor = (_props$keyExtractor = props.keyExtractor) != null ? _props$keyExtractor : _VirtualizeUtils.keyExtractor;
      var frame = this._cellMetrics.get(keyExtractor(getItem(data, index), index));
      if (frame && frame.index === index) {
        return frame;
      }
      if (getItemLayout) {
        var _getItemLayout = getItemLayout(data, index),
          length = _getItemLayout.length,
          offset = _getItemLayout.offset;
        return {
          index: index,
          length: length,
          offset: offset,
          isMounted: true
        };
      }
      return null;
    }
  }, {
    key: "getCellOffsetApprox",
    value: function getCellOffsetApprox(index, props) {
      if (Number.isInteger(index)) {
        return this.getCellMetricsApprox(index, props).offset;
      } else {
        var frameMetrics = this.getCellMetricsApprox(Math.floor(index), props);
        var remainder = index - Math.floor(index);
        return frameMetrics.offset + remainder * frameMetrics.length;
      }
    }
  }, {
    key: "getContentLength",
    value: function getContentLength() {
      var _this$_contentLength;
      return (_this$_contentLength = this._contentLength) != null ? _this$_contentLength : 0;
    }
  }, {
    key: "hasContentLength",
    value: function hasContentLength() {
      return this._contentLength != null;
    }
  }, {
    key: "flowRelativeOffset",
    value: function flowRelativeOffset(layout, referenceContentLength) {
      var _this$_orientation = this._orientation,
        horizontal = _this$_orientation.horizontal,
        rtl = _this$_orientation.rtl;
      if (horizontal && rtl) {
        var contentLength = referenceContentLength != null ? referenceContentLength : this._contentLength;
        (0, _invariant.default)(contentLength != null, 'ListMetricsAggregator must be notified of list content layout before resolving offsets');
        return contentLength - (this._selectOffset(layout) + this._selectLength(layout));
      } else {
        return this._selectOffset(layout);
      }
    }
  }, {
    key: "cartesianOffset",
    value: function cartesianOffset(flowRelativeOffset) {
      var _this$_orientation2 = this._orientation,
        horizontal = _this$_orientation2.horizontal,
        rtl = _this$_orientation2.rtl;
      if (horizontal && rtl) {
        (0, _invariant.default)(this._contentLength != null, 'ListMetricsAggregator must be notified of list content layout before resolving offsets');
        return this._contentLength - flowRelativeOffset;
      } else {
        return flowRelativeOffset;
      }
    }
  }, {
    key: "_invalidateIfOrientationChanged",
    value: function _invalidateIfOrientationChanged(orientation) {
      if (orientation.rtl !== this._orientation.rtl) {
        this._cellMetrics.clear();
      }
      if (orientation.horizontal !== this._orientation.horizontal) {
        this._averageCellLength = 0;
        this._highestMeasuredCellIndex = 0;
        this._measuredCellsLength = 0;
        this._measuredCellsCount = 0;
      }
      this._orientation = orientation;
    }
  }, {
    key: "_selectLength",
    value: function _selectLength(_ref3) {
      var width = _ref3.width,
        height = _ref3.height;
      return this._orientation.horizontal ? width : height;
    }
  }, {
    key: "_selectOffset",
    value: function _selectOffset(_ref4) {
      var x = _ref4.x,
        y = _ref4.y;
      return this._orientation.horizontal ? x : y;
    }
  }]);
}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfVmlydHVhbGl6ZVV0aWxzIiwicmVxdWlyZSIsIl9pbnZhcmlhbnQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiTGlzdE1ldHJpY3NBZ2dyZWdhdG9yIiwiZXhwb3J0cyIsImRlZmF1bHQiLCJfY2xhc3NDYWxsQ2hlY2syIiwiX2F2ZXJhZ2VDZWxsTGVuZ3RoIiwiX2NlbGxNZXRyaWNzIiwiTWFwIiwiX2hpZ2hlc3RNZWFzdXJlZENlbGxJbmRleCIsIl9tZWFzdXJlZENlbGxzTGVuZ3RoIiwiX21lYXN1cmVkQ2VsbHNDb3VudCIsIl9vcmllbnRhdGlvbiIsImhvcml6b250YWwiLCJydGwiLCJfY3JlYXRlQ2xhc3MyIiwia2V5IiwidmFsdWUiLCJub3RpZnlDZWxsTGF5b3V0IiwiX3JlZiIsImNlbGxJbmRleCIsImNlbGxLZXkiLCJvcmllbnRhdGlvbiIsImxheW91dCIsIl9pbnZhbGlkYXRlSWZPcmllbnRhdGlvbkNoYW5nZWQiLCJuZXh0IiwiaW5kZXgiLCJsZW5ndGgiLCJfc2VsZWN0TGVuZ3RoIiwiaXNNb3VudGVkIiwib2Zmc2V0IiwiZmxvd1JlbGF0aXZlT2Zmc2V0IiwiY3VyciIsImdldCIsImRMZW5ndGgiLCJzZXQiLCJNYXRoIiwibWF4Iiwibm90aWZ5Q2VsbFVubW91bnRlZCIsIm5vdGlmeUxpc3RDb250ZW50TGF5b3V0IiwiX3JlZjIiLCJfY29udGVudExlbmd0aCIsImdldEF2ZXJhZ2VDZWxsTGVuZ3RoIiwiZ2V0SGlnaGVzdE1lYXN1cmVkQ2VsbEluZGV4IiwiZ2V0Q2VsbE1ldHJpY3NBcHByb3giLCJwcm9wcyIsImZyYW1lIiwiZ2V0Q2VsbE1ldHJpY3MiLCJoaWdoZXN0TWVhc3VyZWRDZWxsSW5kZXgiLCJoaWdoZXN0TWVhc3VyZWRDZWxsRnJhbWUiLCJkYXRhIiwiZ2V0SXRlbUNvdW50IiwiaW52YXJpYW50IiwiX3Byb3BzJGtleUV4dHJhY3RvciIsImdldEl0ZW0iLCJnZXRJdGVtTGF5b3V0Iiwia2V5RXh0cmFjdG9yIiwiZGVmYXVsdEtleUV4dHJhY3RvciIsIl9nZXRJdGVtTGF5b3V0IiwiZ2V0Q2VsbE9mZnNldEFwcHJveCIsIk51bWJlciIsImlzSW50ZWdlciIsImZyYW1lTWV0cmljcyIsImZsb29yIiwicmVtYWluZGVyIiwiZ2V0Q29udGVudExlbmd0aCIsIl90aGlzJF9jb250ZW50TGVuZ3RoIiwiaGFzQ29udGVudExlbmd0aCIsInJlZmVyZW5jZUNvbnRlbnRMZW5ndGgiLCJfdGhpcyRfb3JpZW50YXRpb24iLCJjb250ZW50TGVuZ3RoIiwiX3NlbGVjdE9mZnNldCIsImNhcnRlc2lhbk9mZnNldCIsIl90aGlzJF9vcmllbnRhdGlvbjIiLCJjbGVhciIsIl9yZWYzIiwid2lkdGgiLCJoZWlnaHQiLCJfcmVmNCIsIngiLCJ5Il0sInNvdXJjZXMiOlsiTGlzdE1ldHJpY3NBZ2dyZWdhdG9yLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSBNZXRhIFBsYXRmb3JtcywgSW5jLiBhbmQgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvdyBzdHJpY3QtbG9jYWxcbiAqIEBmb3JtYXRcbiAqL1xuXG5pbXBvcnQgdHlwZSB7VmlydHVhbGl6ZWRMaXN0UHJvcHN9IGZyb20gJy4vVmlydHVhbGl6ZWRMaXN0UHJvcHMnO1xuaW1wb3J0IHR5cGUge0xheW91dFJlY3RhbmdsZX0gZnJvbSAncmVhY3QtbmF0aXZlL0xpYnJhcmllcy9UeXBlcy9Db3JlRXZlbnRUeXBlcyc7XG5cbmltcG9ydCB7a2V5RXh0cmFjdG9yIGFzIGRlZmF1bHRLZXlFeHRyYWN0b3J9IGZyb20gJy4vVmlydHVhbGl6ZVV0aWxzJztcbmltcG9ydCBpbnZhcmlhbnQgZnJvbSAnaW52YXJpYW50JztcblxuZXhwb3J0IHR5cGUgQ2VsbE1ldHJpY3MgPSB7XG4gIC8qKlxuICAgKiBJbmRleCBvZiB0aGUgaXRlbSBpbiB0aGUgbGlzdFxuICAgKi9cbiAgaW5kZXg6IG51bWJlcixcbiAgLyoqXG4gICAqIExlbmd0aCBvZiB0aGUgY2VsbCBhbG9uZyB0aGUgc2Nyb2xsaW5nIGF4aXNcbiAgICovXG4gIGxlbmd0aDogbnVtYmVyLFxuICAvKipcbiAgICogRGlzdGFuY2UgYmV0d2VlbiB0aGlzIGNlbGwgYW5kIHRoZSBzdGFydCBvZiB0aGUgbGlzdCBhbG9uZyB0aGUgc2Nyb2xsaW5nXG4gICAqIGF4aXNcbiAgICovXG4gIG9mZnNldDogbnVtYmVyLFxuICAvKipcbiAgICogV2hldGhlciB0aGUgY2VsbCBpcyBsYXN0IGtub3duIHRvIGJlIG1vdW50ZWRcbiAgICovXG4gIGlzTW91bnRlZDogYm9vbGVhbixcbn07XG5cbi8vIFRPRE86IGBpbnZlcnRlZGAgY2FuIGJlIGluY29ycG9yYXRlZCBoZXJlIGlmIGl0IGlzIG1vdmVkIHRvIGFuIG9yZGVyXG4vLyBiYXNlZCBpbXBsZW1lbnRhdGlvbiBpbnN0ZWFkIG9mIHRyYW5zZm9ybS5cbmV4cG9ydCB0eXBlIExpc3RPcmllbnRhdGlvbiA9IHtcbiAgaG9yaXpvbnRhbDogYm9vbGVhbixcbiAgcnRsOiBib29sZWFuLFxufTtcblxuLyoqXG4gKiBTdWJzZXQgb2YgVmlydHVhbGl6ZWRMaXN0IHByb3BzIG5lZWRlZCB0byBjYWxjdWxhdGUgY2VsbCBtZXRyaWNzXG4gKi9cbmV4cG9ydCB0eXBlIENlbGxNZXRyaWNQcm9wcyA9IHtcbiAgZGF0YTogVmlydHVhbGl6ZWRMaXN0UHJvcHNbJ2RhdGEnXSxcbiAgZ2V0SXRlbUNvdW50OiBWaXJ0dWFsaXplZExpc3RQcm9wc1snZ2V0SXRlbUNvdW50J10sXG4gIGdldEl0ZW06IFZpcnR1YWxpemVkTGlzdFByb3BzWydnZXRJdGVtJ10sXG4gIGdldEl0ZW1MYXlvdXQ/OiBWaXJ0dWFsaXplZExpc3RQcm9wc1snZ2V0SXRlbUxheW91dCddLFxuICBrZXlFeHRyYWN0b3I/OiBWaXJ0dWFsaXplZExpc3RQcm9wc1sna2V5RXh0cmFjdG9yJ10sXG4gIC4uLlxufTtcblxuLyoqXG4gKiBQcm92aWRlcyBhbiBpbnRlcmZhY2UgdG8gcXVlcnkgaW5mb3JtYXRpb24gYWJvdXQgdGhlIG1ldHJpY3Mgb2YgYSBsaXN0IGFuZCBpdHMgY2VsbHMuXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIExpc3RNZXRyaWNzQWdncmVnYXRvciB7XG4gIF9hdmVyYWdlQ2VsbExlbmd0aCA9IDA7XG4gIF9jZWxsTWV0cmljczogTWFwPHN0cmluZywgQ2VsbE1ldHJpY3M+ID0gbmV3IE1hcCgpO1xuICBfY29udGVudExlbmd0aDogP251bWJlcjtcbiAgX2hpZ2hlc3RNZWFzdXJlZENlbGxJbmRleCA9IDA7XG4gIF9tZWFzdXJlZENlbGxzTGVuZ3RoID0gMDtcbiAgX21lYXN1cmVkQ2VsbHNDb3VudCA9IDA7XG4gIF9vcmllbnRhdGlvbjogTGlzdE9yaWVudGF0aW9uID0ge1xuICAgIGhvcml6b250YWw6IGZhbHNlLFxuICAgIHJ0bDogZmFsc2UsXG4gIH07XG5cbiAgLyoqXG4gICAqIE5vdGlmeSB0aGUgTGlzdE1ldHJpY3NBZ2dyZWdhdG9yIHRoYXQgYSBjZWxsIGhhcyBiZWVuIGxhaWQgb3V0LlxuICAgKlxuICAgKiBAcmV0dXJucyB3aGV0aGVyIHRoZSBjZWxsIGxheW91dCBoYXMgY2hhbmdlZCBzaW5jZSBsYXN0IG5vdGlmaWNhdGlvblxuICAgKi9cbiAgbm90aWZ5Q2VsbExheW91dCh7XG4gICAgY2VsbEluZGV4LFxuICAgIGNlbGxLZXksXG4gICAgb3JpZW50YXRpb24sXG4gICAgbGF5b3V0LFxuICB9OiB7XG4gICAgY2VsbEluZGV4OiBudW1iZXIsXG4gICAgY2VsbEtleTogc3RyaW5nLFxuICAgIG9yaWVudGF0aW9uOiBMaXN0T3JpZW50YXRpb24sXG4gICAgbGF5b3V0OiBMYXlvdXRSZWN0YW5nbGUsXG4gIH0pOiBib29sZWFuIHtcbiAgICB0aGlzLl9pbnZhbGlkYXRlSWZPcmllbnRhdGlvbkNoYW5nZWQob3JpZW50YXRpb24pO1xuXG4gICAgY29uc3QgbmV4dDogQ2VsbE1ldHJpY3MgPSB7XG4gICAgICBpbmRleDogY2VsbEluZGV4LFxuICAgICAgbGVuZ3RoOiB0aGlzLl9zZWxlY3RMZW5ndGgobGF5b3V0KSxcbiAgICAgIGlzTW91bnRlZDogdHJ1ZSxcbiAgICAgIG9mZnNldDogdGhpcy5mbG93UmVsYXRpdmVPZmZzZXQobGF5b3V0KSxcbiAgICB9O1xuICAgIGNvbnN0IGN1cnIgPSB0aGlzLl9jZWxsTWV0cmljcy5nZXQoY2VsbEtleSk7XG5cbiAgICBpZiAoIWN1cnIgfHwgbmV4dC5vZmZzZXQgIT09IGN1cnIub2Zmc2V0IHx8IG5leHQubGVuZ3RoICE9PSBjdXJyLmxlbmd0aCkge1xuICAgICAgaWYgKGN1cnIpIHtcbiAgICAgICAgY29uc3QgZExlbmd0aCA9IG5leHQubGVuZ3RoIC0gY3Vyci5sZW5ndGg7XG4gICAgICAgIHRoaXMuX21lYXN1cmVkQ2VsbHNMZW5ndGggKz0gZExlbmd0aDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX21lYXN1cmVkQ2VsbHNMZW5ndGggKz0gbmV4dC5sZW5ndGg7XG4gICAgICAgIHRoaXMuX21lYXN1cmVkQ2VsbHNDb3VudCArPSAxO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9hdmVyYWdlQ2VsbExlbmd0aCA9XG4gICAgICAgIHRoaXMuX21lYXN1cmVkQ2VsbHNMZW5ndGggLyB0aGlzLl9tZWFzdXJlZENlbGxzQ291bnQ7XG4gICAgICB0aGlzLl9jZWxsTWV0cmljcy5zZXQoY2VsbEtleSwgbmV4dCk7XG4gICAgICB0aGlzLl9oaWdoZXN0TWVhc3VyZWRDZWxsSW5kZXggPSBNYXRoLm1heChcbiAgICAgICAgdGhpcy5faGlnaGVzdE1lYXN1cmVkQ2VsbEluZGV4LFxuICAgICAgICBjZWxsSW5kZXgsXG4gICAgICApO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGN1cnIuaXNNb3VudGVkID0gdHJ1ZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTm90aWZ5IExpc3RNZXRyaWNzQWdncmVnYXRvciB0aGF0IGEgY2VsbCBoYXMgYmVlbiB1bm1vdW50ZWQuXG4gICAqL1xuICBub3RpZnlDZWxsVW5tb3VudGVkKGNlbGxLZXk6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IGN1cnIgPSB0aGlzLl9jZWxsTWV0cmljcy5nZXQoY2VsbEtleSk7XG4gICAgaWYgKGN1cnIpIHtcbiAgICAgIGN1cnIuaXNNb3VudGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE5vdGlmeSBMaXN0TWV0cmljc0FnZ3JlZ2F0b3IgdGhhdCB0aGUgbGlzdHMgY29udGVudCBjb250YWluZXIgaGFzIGJlZW4gbGFpZCBvdXQuXG4gICAqL1xuICBub3RpZnlMaXN0Q29udGVudExheW91dCh7XG4gICAgb3JpZW50YXRpb24sXG4gICAgbGF5b3V0LFxuICB9OiB7XG4gICAgb3JpZW50YXRpb246IExpc3RPcmllbnRhdGlvbixcbiAgICBsYXlvdXQ6ICRSZWFkT25seTx7d2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXJ9PixcbiAgfSk6IHZvaWQge1xuICAgIHRoaXMuX2ludmFsaWRhdGVJZk9yaWVudGF0aW9uQ2hhbmdlZChvcmllbnRhdGlvbik7XG4gICAgdGhpcy5fY29udGVudExlbmd0aCA9IHRoaXMuX3NlbGVjdExlbmd0aChsYXlvdXQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgYXZlcmFnZSBsZW5ndGggb2YgdGhlIGNlbGxzIHdoaWNoIGhhdmUgYmVlbiBtZWFzdXJlZFxuICAgKi9cbiAgZ2V0QXZlcmFnZUNlbGxMZW5ndGgoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fYXZlcmFnZUNlbGxMZW5ndGg7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBoaWdoZXN0IG1lYXN1cmVkIGNlbGwgaW5kZXggKG9yIDAgaWYgbm90aGluZyBoYXMgYmVlbiBtZWFzdXJlZFxuICAgKiB5ZXQpXG4gICAqL1xuICBnZXRIaWdoZXN0TWVhc3VyZWRDZWxsSW5kZXgoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5faGlnaGVzdE1lYXN1cmVkQ2VsbEluZGV4O1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGV4YWN0IG1ldHJpY3Mgb2YgYSBjZWxsIGlmIGl0IGhhcyBhbHJlYWR5IGJlZW4gbGFpZCBvdXQsXG4gICAqIG90aGVyd2lzZSBhbiBlc3RpbWF0ZSBiYXNlZCBvbiB0aGUgYXZlcmFnZSBsZW5ndGggb2YgcHJldmlvdXNseSBtZWFzdXJlZFxuICAgKiBjZWxsc1xuICAgKi9cbiAgZ2V0Q2VsbE1ldHJpY3NBcHByb3goaW5kZXg6IG51bWJlciwgcHJvcHM6IENlbGxNZXRyaWNQcm9wcyk6IENlbGxNZXRyaWNzIHtcbiAgICBjb25zdCBmcmFtZSA9IHRoaXMuZ2V0Q2VsbE1ldHJpY3MoaW5kZXgsIHByb3BzKTtcbiAgICBpZiAoZnJhbWUgJiYgZnJhbWUuaW5kZXggPT09IGluZGV4KSB7XG4gICAgICAvLyBjaGVjayBmb3IgaW52YWxpZCBmcmFtZXMgZHVlIHRvIHJvdyByZS1vcmRlcmluZ1xuICAgICAgcmV0dXJuIGZyYW1lO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgb2Zmc2V0O1xuXG4gICAgICBjb25zdCBoaWdoZXN0TWVhc3VyZWRDZWxsSW5kZXggPSB0aGlzLmdldEhpZ2hlc3RNZWFzdXJlZENlbGxJbmRleCgpO1xuICAgICAgaWYgKGhpZ2hlc3RNZWFzdXJlZENlbGxJbmRleCA8IGluZGV4KSB7XG4gICAgICAgIC8vIElmIGFueSBvZiB0aGUgY2VsbHMgYmVmb3JlIHRoaXMgb25lIGhhdmUgYmVlbiBsYWlkIG91dCBhbHJlYWR5LCB3ZVxuICAgICAgICAvLyBzaG91bGQgdXNlIHRoYXQgaW5mb3JtYXRpb24gaW4gdGhlIGVzdGltYXRpb25zLlxuICAgICAgICAvLyBUaGlzIGlzIGltcG9ydGFudCBiZWNhdXNlIGlmIHRoZSBsaXN0IGhhcyBhIGhlYWRlciwgdGhlIGluaXRpYWwgY2VsbFxuICAgICAgICAvLyB3aWxsIGhhdmUgYSBsYXJnZXIgb2Zmc2V0IHRoYXQgd2Ugc2hvdWxkIHRha2UgaW50byBhY2NvdW50IGhlcmUuXG4gICAgICAgIGNvbnN0IGhpZ2hlc3RNZWFzdXJlZENlbGxGcmFtZSA9IHRoaXMuZ2V0Q2VsbE1ldHJpY3MoXG4gICAgICAgICAgaGlnaGVzdE1lYXN1cmVkQ2VsbEluZGV4LFxuICAgICAgICAgIHByb3BzLFxuICAgICAgICApO1xuICAgICAgICBpZiAoaGlnaGVzdE1lYXN1cmVkQ2VsbEZyYW1lKSB7XG4gICAgICAgICAgb2Zmc2V0ID1cbiAgICAgICAgICAgIGhpZ2hlc3RNZWFzdXJlZENlbGxGcmFtZS5vZmZzZXQgK1xuICAgICAgICAgICAgaGlnaGVzdE1lYXN1cmVkQ2VsbEZyYW1lLmxlbmd0aCArXG4gICAgICAgICAgICB0aGlzLl9hdmVyYWdlQ2VsbExlbmd0aCAqIChpbmRleCAtIGhpZ2hlc3RNZWFzdXJlZENlbGxJbmRleCAtIDEpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChvZmZzZXQgPT0gbnVsbCkge1xuICAgICAgICBvZmZzZXQgPSB0aGlzLl9hdmVyYWdlQ2VsbExlbmd0aCAqIGluZGV4O1xuICAgICAgfVxuXG4gICAgICBjb25zdCB7ZGF0YSwgZ2V0SXRlbUNvdW50fSA9IHByb3BzO1xuICAgICAgaW52YXJpYW50KFxuICAgICAgICBpbmRleCA+PSAwICYmIGluZGV4IDwgZ2V0SXRlbUNvdW50KGRhdGEpLFxuICAgICAgICAnVHJpZWQgdG8gZ2V0IGZyYW1lIGZvciBvdXQgb2YgcmFuZ2UgaW5kZXggJyArIGluZGV4LFxuICAgICAgKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGxlbmd0aDogdGhpcy5fYXZlcmFnZUNlbGxMZW5ndGgsXG4gICAgICAgIG9mZnNldCxcbiAgICAgICAgaW5kZXgsXG4gICAgICAgIGlzTW91bnRlZDogZmFsc2UsXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBleGFjdCBtZXRyaWNzIG9mIGEgY2VsbCBpZiBpdCBoYXMgYWxyZWFkeSBiZWVuIGxhaWQgb3V0XG4gICAqL1xuICBnZXRDZWxsTWV0cmljcyhpbmRleDogbnVtYmVyLCBwcm9wczogQ2VsbE1ldHJpY1Byb3BzKTogP0NlbGxNZXRyaWNzIHtcbiAgICBjb25zdCB7ZGF0YSwgZ2V0SXRlbSwgZ2V0SXRlbUNvdW50LCBnZXRJdGVtTGF5b3V0fSA9IHByb3BzO1xuICAgIGludmFyaWFudChcbiAgICAgIGluZGV4ID49IDAgJiYgaW5kZXggPCBnZXRJdGVtQ291bnQoZGF0YSksXG4gICAgICAnVHJpZWQgdG8gZ2V0IG1ldHJpY3MgZm9yIG91dCBvZiByYW5nZSBjZWxsIGluZGV4ICcgKyBpbmRleCxcbiAgICApO1xuICAgIGNvbnN0IGtleUV4dHJhY3RvciA9IHByb3BzLmtleUV4dHJhY3RvciA/PyBkZWZhdWx0S2V5RXh0cmFjdG9yO1xuICAgIGNvbnN0IGZyYW1lID0gdGhpcy5fY2VsbE1ldHJpY3MuZ2V0KFxuICAgICAga2V5RXh0cmFjdG9yKGdldEl0ZW0oZGF0YSwgaW5kZXgpLCBpbmRleCksXG4gICAgKTtcbiAgICBpZiAoZnJhbWUgJiYgZnJhbWUuaW5kZXggPT09IGluZGV4KSB7XG4gICAgICByZXR1cm4gZnJhbWU7XG4gICAgfVxuXG4gICAgaWYgKGdldEl0ZW1MYXlvdXQpIHtcbiAgICAgIGNvbnN0IHtsZW5ndGgsIG9mZnNldH0gPSBnZXRJdGVtTGF5b3V0KGRhdGEsIGluZGV4KTtcbiAgICAgIC8vIFRPRE86IGBpc01vdW50ZWRgIGlzIHVzZWQgZm9yIGJvdGggXCJpcyBleGFjdCBsYXlvdXRcIiBhbmQgXCJoYXMgYmVlblxuICAgICAgLy8gdW5tb3VudGVkXCIuIFNob3VsZCBiZSByZWZhY3RvcmVkLlxuICAgICAgcmV0dXJuIHtpbmRleCwgbGVuZ3RoLCBvZmZzZXQsIGlzTW91bnRlZDogdHJ1ZX07XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyBhbiBhcHByb3hpbWF0ZSBvZmZzZXQgdG8gYW4gaXRlbSBhdCBhIGdpdmVuIGluZGV4LiBTdXBwb3J0c1xuICAgKiBmcmFjdGlvbmFsIGluZGljZXMuXG4gICAqL1xuICBnZXRDZWxsT2Zmc2V0QXBwcm94KGluZGV4OiBudW1iZXIsIHByb3BzOiBDZWxsTWV0cmljUHJvcHMpOiBudW1iZXIge1xuICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKGluZGV4KSkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0Q2VsbE1ldHJpY3NBcHByb3goaW5kZXgsIHByb3BzKS5vZmZzZXQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGZyYW1lTWV0cmljcyA9IHRoaXMuZ2V0Q2VsbE1ldHJpY3NBcHByb3goTWF0aC5mbG9vcihpbmRleCksIHByb3BzKTtcbiAgICAgIGNvbnN0IHJlbWFpbmRlciA9IGluZGV4IC0gTWF0aC5mbG9vcihpbmRleCk7XG4gICAgICByZXR1cm4gZnJhbWVNZXRyaWNzLm9mZnNldCArIHJlbWFpbmRlciAqIGZyYW1lTWV0cmljcy5sZW5ndGg7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGxlbmd0aCBvZiBhbGwgU2Nyb2xsVmlldyBjb250ZW50IGFsb25nIHRoZSBzY3JvbGxpbmcgYXhpcy5cbiAgICovXG4gIGdldENvbnRlbnRMZW5ndGgoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fY29udGVudExlbmd0aCA/PyAwO1xuICB9XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgYSBjb250ZW50IGxlbmd0aCBoYXMgYmVlbiBvYnNlcnZlZFxuICAgKi9cbiAgaGFzQ29udGVudExlbmd0aCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fY29udGVudExlbmd0aCAhPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEZpbmRzIHRoZSBmbG93LXJlbGF0aXZlIG9mZnNldCAoZS5nLiBzdGFydGluZyBmcm9tIHRoZSBsZWZ0IGluIExUUiwgYnV0XG4gICAqIHJpZ2h0IGluIFJUTCkgZnJvbSBhIGxheW91dCBib3guXG4gICAqL1xuICBmbG93UmVsYXRpdmVPZmZzZXQoXG4gICAgbGF5b3V0OiBMYXlvdXRSZWN0YW5nbGUsXG4gICAgcmVmZXJlbmNlQ29udGVudExlbmd0aD86ID9udW1iZXIsXG4gICk6IG51bWJlciB7XG4gICAgY29uc3Qge2hvcml6b250YWwsIHJ0bH0gPSB0aGlzLl9vcmllbnRhdGlvbjtcblxuICAgIGlmIChob3Jpem9udGFsICYmIHJ0bCkge1xuICAgICAgY29uc3QgY29udGVudExlbmd0aCA9IHJlZmVyZW5jZUNvbnRlbnRMZW5ndGggPz8gdGhpcy5fY29udGVudExlbmd0aDtcbiAgICAgIGludmFyaWFudChcbiAgICAgICAgY29udGVudExlbmd0aCAhPSBudWxsLFxuICAgICAgICAnTGlzdE1ldHJpY3NBZ2dyZWdhdG9yIG11c3QgYmUgbm90aWZpZWQgb2YgbGlzdCBjb250ZW50IGxheW91dCBiZWZvcmUgcmVzb2x2aW5nIG9mZnNldHMnLFxuICAgICAgKTtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIGNvbnRlbnRMZW5ndGggLVxuICAgICAgICAodGhpcy5fc2VsZWN0T2Zmc2V0KGxheW91dCkgKyB0aGlzLl9zZWxlY3RMZW5ndGgobGF5b3V0KSlcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLl9zZWxlY3RPZmZzZXQobGF5b3V0KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydHMgYSBmbG93LXJlbGF0aXZlIG9mZnNldCB0byBhIGNhcnRlc2lhbiBvZmZzZXRcbiAgICovXG4gIGNhcnRlc2lhbk9mZnNldChmbG93UmVsYXRpdmVPZmZzZXQ6IG51bWJlcik6IG51bWJlciB7XG4gICAgY29uc3Qge2hvcml6b250YWwsIHJ0bH0gPSB0aGlzLl9vcmllbnRhdGlvbjtcblxuICAgIGlmIChob3Jpem9udGFsICYmIHJ0bCkge1xuICAgICAgaW52YXJpYW50KFxuICAgICAgICB0aGlzLl9jb250ZW50TGVuZ3RoICE9IG51bGwsXG4gICAgICAgICdMaXN0TWV0cmljc0FnZ3JlZ2F0b3IgbXVzdCBiZSBub3RpZmllZCBvZiBsaXN0IGNvbnRlbnQgbGF5b3V0IGJlZm9yZSByZXNvbHZpbmcgb2Zmc2V0cycsXG4gICAgICApO1xuICAgICAgcmV0dXJuIHRoaXMuX2NvbnRlbnRMZW5ndGggLSBmbG93UmVsYXRpdmVPZmZzZXQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmbG93UmVsYXRpdmVPZmZzZXQ7XG4gICAgfVxuICB9XG5cbiAgX2ludmFsaWRhdGVJZk9yaWVudGF0aW9uQ2hhbmdlZChvcmllbnRhdGlvbjogTGlzdE9yaWVudGF0aW9uKTogdm9pZCB7XG4gICAgaWYgKG9yaWVudGF0aW9uLnJ0bCAhPT0gdGhpcy5fb3JpZW50YXRpb24ucnRsKSB7XG4gICAgICB0aGlzLl9jZWxsTWV0cmljcy5jbGVhcigpO1xuICAgIH1cblxuICAgIGlmIChvcmllbnRhdGlvbi5ob3Jpem9udGFsICE9PSB0aGlzLl9vcmllbnRhdGlvbi5ob3Jpem9udGFsKSB7XG4gICAgICB0aGlzLl9hdmVyYWdlQ2VsbExlbmd0aCA9IDA7XG4gICAgICB0aGlzLl9oaWdoZXN0TWVhc3VyZWRDZWxsSW5kZXggPSAwO1xuICAgICAgdGhpcy5fbWVhc3VyZWRDZWxsc0xlbmd0aCA9IDA7XG4gICAgICB0aGlzLl9tZWFzdXJlZENlbGxzQ291bnQgPSAwO1xuICAgIH1cblxuICAgIHRoaXMuX29yaWVudGF0aW9uID0gb3JpZW50YXRpb247XG4gIH1cblxuICBfc2VsZWN0TGVuZ3RoKHtcbiAgICB3aWR0aCxcbiAgICBoZWlnaHQsXG4gIH06ICRSZWFkT25seTx7d2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIsIC4uLn0+KTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fb3JpZW50YXRpb24uaG9yaXpvbnRhbCA/IHdpZHRoIDogaGVpZ2h0O1xuICB9XG5cbiAgX3NlbGVjdE9mZnNldCh7eCwgeX06ICRSZWFkT25seTx7eDogbnVtYmVyLCB5OiBudW1iZXIsIC4uLn0+KTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fb3JpZW50YXRpb24uaG9yaXpvbnRhbCA/IHggOiB5O1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFhQSxJQUFBQSxnQkFBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsVUFBQSxHQUFBQyxzQkFBQSxDQUFBRixPQUFBO0FBQWtDLElBNENiRyxxQkFBcUIsR0FBQUMsT0FBQSxDQUFBQyxPQUFBO0VBQUEsU0FBQUYsc0JBQUE7SUFBQSxJQUFBRyxnQkFBQSxDQUFBRCxPQUFBLFFBQUFGLHFCQUFBO0lBQUEsS0FDeENJLGtCQUFrQixHQUFHLENBQUM7SUFBQSxLQUN0QkMsWUFBWSxHQUE2QixJQUFJQyxHQUFHLENBQUMsQ0FBQztJQUFBLEtBRWxEQyx5QkFBeUIsR0FBRyxDQUFDO0lBQUEsS0FDN0JDLG9CQUFvQixHQUFHLENBQUM7SUFBQSxLQUN4QkMsbUJBQW1CLEdBQUcsQ0FBQztJQUFBLEtBQ3ZCQyxZQUFZLEdBQW9CO01BQzlCQyxVQUFVLEVBQUUsS0FBSztNQUNqQkMsR0FBRyxFQUFFO0lBQ1AsQ0FBQztFQUFBO0VBQUEsV0FBQUMsYUFBQSxDQUFBWCxPQUFBLEVBQUFGLHFCQUFBO0lBQUFjLEdBQUE7SUFBQUMsS0FBQSxFQU9ELFNBQUFDLGdCQUFnQkEsQ0FBQUMsSUFBQSxFQVVKO01BQUEsSUFUVkMsU0FBUyxHQUFBRCxJQUFBLENBQVRDLFNBQVM7UUFDVEMsT0FBTyxHQUFBRixJQUFBLENBQVBFLE9BQU87UUFDUEMsV0FBVyxHQUFBSCxJQUFBLENBQVhHLFdBQVc7UUFDWEMsTUFBTSxHQUFBSixJQUFBLENBQU5JLE1BQU07TUFPTixJQUFJLENBQUNDLCtCQUErQixDQUFDRixXQUFXLENBQUM7TUFFakQsSUFBTUcsSUFBaUIsR0FBRztRQUN4QkMs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