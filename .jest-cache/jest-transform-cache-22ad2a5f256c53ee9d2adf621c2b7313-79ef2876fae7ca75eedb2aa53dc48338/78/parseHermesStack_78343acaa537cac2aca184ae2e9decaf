c7c4fcecc9bfc3150404fc3b17b08eb6
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = parseHermesStack;
var RE_FRAME = /^ {4}at (.+?)(?: \((native)\)?| \((address at )?(.*?):(\d+):(\d+)\))$/;
var RE_SKIPPED = /^ {4}... skipping (\d+) frames$/;
var RE_COMPONENT_NO_STACK = /^ {4}at .*$/;
function isInternalBytecodeSourceUrl(sourceUrl) {
  return sourceUrl === 'InternalBytecode.js';
}
function parseLine(line) {
  var asFrame = line.match(RE_FRAME);
  if (asFrame) {
    return {
      type: 'FRAME',
      functionName: asFrame[1],
      location: asFrame[2] === 'native' ? {
        type: 'NATIVE'
      } : asFrame[3] === 'address at ' ? isInternalBytecodeSourceUrl(asFrame[4]) ? {
        type: 'INTERNAL_BYTECODE',
        sourceUrl: asFrame[4],
        line1Based: Number.parseInt(asFrame[5], 10),
        virtualOffset0Based: Number.parseInt(asFrame[6], 10)
      } : {
        type: 'BYTECODE',
        sourceUrl: asFrame[4],
        line1Based: Number.parseInt(asFrame[5], 10),
        virtualOffset0Based: Number.parseInt(asFrame[6], 10)
      } : {
        type: 'SOURCE',
        sourceUrl: asFrame[4],
        line1Based: Number.parseInt(asFrame[5], 10),
        column1Based: Number.parseInt(asFrame[6], 10)
      }
    };
  }
  var asSkipped = line.match(RE_SKIPPED);
  if (asSkipped) {
    return {
      type: 'SKIPPED',
      count: Number.parseInt(asSkipped[1], 10)
    };
  }
}
function parseHermesStack(stack) {
  var lines = stack.split(/\n/);
  var entries = [];
  var lastMessageLine = -1;
  for (var i = 0; i < lines.length; ++i) {
    var line = lines[i];
    if (!line) {
      continue;
    }
    var entry = parseLine(line);
    if (entry) {
      entries.push(entry);
      continue;
    }
    if (RE_COMPONENT_NO_STACK.test(line)) {
      continue;
    }
    lastMessageLine = i;
    entries = [];
  }
  var message = lines.slice(0, lastMessageLine + 1).join('\n');
  return {
    message: message,
    entries: entries
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsImRlZmF1bHQiLCJwYXJzZUhlcm1lc1N0YWNrIiwiUkVfRlJBTUUiLCJSRV9TS0lQUEVEIiwiUkVfQ09NUE9ORU5UX05PX1NUQUNLIiwiaXNJbnRlcm5hbEJ5dGVjb2RlU291cmNlVXJsIiwic291cmNlVXJsIiwicGFyc2VMaW5lIiwibGluZSIsImFzRnJhbWUiLCJtYXRjaCIsInR5cGUiLCJmdW5jdGlvbk5hbWUiLCJsb2NhdGlvbiIsImxpbmUxQmFzZWQiLCJOdW1iZXIiLCJwYXJzZUludCIsInZpcnR1YWxPZmZzZXQwQmFzZWQiLCJjb2x1bW4xQmFzZWQiLCJhc1NraXBwZWQiLCJjb3VudCIsInN0YWNrIiwibGluZXMiLCJzcGxpdCIsImVudHJpZXMiLCJsYXN0TWVzc2FnZUxpbmUiLCJpIiwibGVuZ3RoIiwiZW50cnkiLCJwdXNoIiwidGVzdCIsIm1lc3NhZ2UiLCJzbGljZSIsImpvaW4iXSwic291cmNlcyI6WyJwYXJzZUhlcm1lc1N0YWNrLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSBNZXRhIFBsYXRmb3JtcywgSW5jLiBhbmQgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZm9ybWF0XG4gKiBAZmxvdyBzdHJpY3RcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbnR5cGUgSGVybWVzU3RhY2tMb2NhdGlvbk5hdGl2ZSA9ICRSZWFkT25seTx7XG4gIHR5cGU6ICdOQVRJVkUnLFxufT47XG5cbnR5cGUgSGVybWVzU3RhY2tMb2NhdGlvblNvdXJjZSA9ICRSZWFkT25seTx7XG4gIHR5cGU6ICdTT1VSQ0UnLFxuICBzb3VyY2VVcmw6IHN0cmluZyxcbiAgbGluZTFCYXNlZDogbnVtYmVyLFxuICBjb2x1bW4xQmFzZWQ6IG51bWJlcixcbn0+O1xuXG50eXBlIEhlcm1lc1N0YWNrTG9jYXRpb25JbnRlcm5hbEJ5dGVjb2RlID0gJFJlYWRPbmx5PHtcbiAgdHlwZTogJ0lOVEVSTkFMX0JZVEVDT0RFJyxcbiAgc291cmNlVXJsOiBzdHJpbmcsXG4gIGxpbmUxQmFzZWQ6IG51bWJlcixcbiAgdmlydHVhbE9mZnNldDBCYXNlZDogbnVtYmVyLFxufT47XG5cbnR5cGUgSGVybWVzU3RhY2tMb2NhdGlvbkJ5dGVjb2RlID0gJFJlYWRPbmx5PHtcbiAgdHlwZTogJ0JZVEVDT0RFJyxcbiAgc291cmNlVXJsOiBzdHJpbmcsXG4gIGxpbmUxQmFzZWQ6IG51bWJlcixcbiAgdmlydHVhbE9mZnNldDBCYXNlZDogbnVtYmVyLFxufT47XG5cbnR5cGUgSGVybWVzU3RhY2tMb2NhdGlvbiA9XG4gIHwgSGVybWVzU3RhY2tMb2NhdGlvbk5hdGl2ZVxuICB8IEhlcm1lc1N0YWNrTG9jYXRpb25Tb3VyY2VcbiAgfCBIZXJtZXNTdGFja0xvY2F0aW9uSW50ZXJuYWxCeXRlY29kZVxuICB8IEhlcm1lc1N0YWNrTG9jYXRpb25CeXRlY29kZTtcblxudHlwZSBIZXJtZXNTdGFja0VudHJ5RnJhbWUgPSAkUmVhZE9ubHk8e1xuICB0eXBlOiAnRlJBTUUnLFxuICBsb2NhdGlvbjogSGVybWVzU3RhY2tMb2NhdGlvbixcbiAgZnVuY3Rpb25OYW1lOiBzdHJpbmcsXG59PjtcblxudHlwZSBIZXJtZXNTdGFja0VudHJ5U2tpcHBlZCA9ICRSZWFkT25seTx7XG4gIHR5cGU6ICdTS0lQUEVEJyxcbiAgY291bnQ6IG51bWJlcixcbn0+O1xuXG50eXBlIEhlcm1lc1N0YWNrRW50cnkgPSBIZXJtZXNTdGFja0VudHJ5RnJhbWUgfCBIZXJtZXNTdGFja0VudHJ5U2tpcHBlZDtcblxuZXhwb3J0IHR5cGUgSGVybWVzUGFyc2VkU3RhY2sgPSAkUmVhZE9ubHk8e1xuICBtZXNzYWdlOiBzdHJpbmcsXG4gIGVudHJpZXM6ICRSZWFkT25seUFycmF5PEhlcm1lc1N0YWNrRW50cnk+LFxufT47XG5cbi8vIENhcHR1cmluZyBncm91cHM6XG4vLyAxLiBmdW5jdGlvbiBuYW1lXG4vLyAyLiBpcyB0aGlzIGEgbmF0aXZlIHN0YWNrIGZyYW1lP1xuLy8gMy4gaXMgdGhpcyBhIGJ5dGVjb2RlIGFkZHJlc3Mgb3IgYSBzb3VyY2UgbG9jYXRpb24/XG4vLyA0LiBzb3VyY2UgVVJMIChmaWxlbmFtZSlcbi8vIDUuIGxpbmUgbnVtYmVyICgxIGJhc2VkKVxuLy8gNi4gY29sdW1uIG51bWJlciAoMSBiYXNlZCkgb3IgdmlydHVhbCBvZmZzZXQgKDAgYmFzZWQpXG5jb25zdCBSRV9GUkFNRSA9XG4gIC9eIHs0fWF0ICguKz8pKD86IFxcKChuYXRpdmUpXFwpP3wgXFwoKGFkZHJlc3MgYXQgKT8oLio/KTooXFxkKyk6KFxcZCspXFwpKSQvO1xuXG4vLyBDYXB0dXJpbmcgZ3JvdXBzOlxuLy8gMS4gY291bnQgb2Ygc2tpcHBlZCBmcmFtZXNcbmNvbnN0IFJFX1NLSVBQRUQgPSAvXiB7NH0uLi4gc2tpcHBpbmcgKFxcZCspIGZyYW1lcyQvO1xuY29uc3QgUkVfQ09NUE9ORU5UX05PX1NUQUNLID0gL14gezR9YXQgLiokLztcblxuZnVuY3Rpb24gaXNJbnRlcm5hbEJ5dGVjb2RlU291cmNlVXJsKHNvdXJjZVVybDogc3RyaW5nKTogYm9vbGVhbiB7XG4gIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svaGVybWVzL2Jsb2IvMzMzMmZhMDIwY2FlMGJhYjc1MWY2NDhkYjdjOTRlMWQ2ODdlZWVjNy9saWIvVk0vUnVudGltZS5jcHAjTDExMDBcbiAgcmV0dXJuIHNvdXJjZVVybCA9PT0gJ0ludGVybmFsQnl0ZWNvZGUuanMnO1xufVxuXG5mdW5jdGlvbiBwYXJzZUxpbmUobGluZTogc3RyaW5nKTogP0hlcm1lc1N0YWNrRW50cnkge1xuICBjb25zdCBhc0ZyYW1lID0gbGluZS5tYXRjaChSRV9GUkFNRSk7XG4gIGlmIChhc0ZyYW1lKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdGUkFNRScsXG4gICAgICBmdW5jdGlvbk5hbWU6IGFzRnJhbWVbMV0sXG4gICAgICBsb2NhdGlvbjpcbiAgICAgICAgYXNGcmFtZVsyXSA9PT0gJ25hdGl2ZSdcbiAgICAgICAgICA/IHt0eXBlOiAnTkFUSVZFJ31cbiAgICAgICAgICA6IGFzRnJhbWVbM10gPT09ICdhZGRyZXNzIGF0ICdcbiAgICAgICAgICAgID8gaXNJbnRlcm5hbEJ5dGVjb2RlU291cmNlVXJsKGFzRnJhbWVbNF0pXG4gICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgdHlwZTogJ0lOVEVSTkFMX0JZVEVDT0RFJyxcbiAgICAgICAgICAgICAgICAgIHNvdXJjZVVybDogYXNGcmFtZVs0XSxcbiAgICAgICAgICAgICAgICAgIGxpbmUxQmFzZWQ6IE51bWJlci5wYXJzZUludChhc0ZyYW1lWzVdLCAxMCksXG4gICAgICAgICAgICAgICAgICB2aXJ0dWFsT2Zmc2V0MEJhc2VkOiBOdW1iZXIucGFyc2VJbnQoYXNGcmFtZVs2XSwgMTApLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiAnQllURUNPREUnLFxuICAgICAgICAgICAgICAgICAgc291cmNlVXJsOiBhc0ZyYW1lWzRdLFxuICAgICAgICAgICAgICAgICAgbGluZTFCYXNlZDogTnVtYmVyLnBhcnNlSW50KGFzRnJhbWVbNV0sIDEwKSxcbiAgICAgICAgICAgICAgICAgIHZpcnR1YWxPZmZzZXQwQmFzZWQ6IE51bWJlci5wYXJzZUludChhc0ZyYW1lWzZdLCAxMCksXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1NPVVJDRScsXG4gICAgICAgICAgICAgICAgc291cmNlVXJsOiBhc0ZyYW1lWzRdLFxuICAgICAgICAgICAgICAgIGxpbmUxQmFzZWQ6IE51bWJlci5wYXJzZUludChhc0ZyYW1lWzVdLCAxMCksXG4gICAgICAgICAgICAgICAgY29sdW1uMUJhc2VkOiBOdW1iZXIucGFyc2VJbnQoYXNGcmFtZVs2XSwgMTApLFxuICAgICAgICAgICAgICB9LFxuICAgIH07XG4gIH1cbiAgY29uc3QgYXNTa2lwcGVkID0gbGluZS5tYXRjaChSRV9TS0lQUEVEKTtcbiAgaWYgKGFzU2tpcHBlZCkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnU0tJUFBFRCcsXG4gICAgICBjb3VudDogTnVtYmVyLnBhcnNlSW50KGFzU2tpcHBlZFsxXSwgMTApLFxuICAgIH07XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcGFyc2VIZXJtZXNTdGFjayhzdGFjazogc3RyaW5nKTogSGVybWVzUGFyc2VkU3RhY2sge1xuICBjb25zdCBsaW5lcyA9IHN0YWNrLnNwbGl0KC9cXG4vKTtcbiAgbGV0IGVudHJpZXM6IEFycmF5PEhlcm1lc1N0YWNrRW50cnlGcmFtZSB8IEhlcm1lc1N0YWNrRW50cnlTa2lwcGVkPiA9IFtdO1xuICBsZXQgbGFzdE1lc3NhZ2VMaW5lID0gLTE7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyArK2kpIHtcbiAgICBjb25zdCBsaW5lID0gbGluZXNbaV07XG4gICAgaWYgKCFsaW5lKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY29uc3QgZW50cnkgPSBwYXJzZUxpbmUobGluZSk7XG4gICAgaWYgKGVudHJ5KSB7XG4gICAgICBlbnRyaWVzLnB1c2goZW50cnkpO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChSRV9DT01QT05FTlRfTk9fU1RBQ0sudGVzdChsaW5lKSkge1xuICAgICAgLy8gU2tpcCBjb21wb25lbnQgc3RhY2tzIHdpdGhvdXQgc291cmNlIGxvY2F0aW9uLlxuICAgICAgLy8gVE9ETzogVGhpcyB3aWxsIG5vdCBiZSBkaXNwbGF5ZWQsIG5vdCBzdXJlIGhvdyB0byBoYW5kbGUgaXQuXG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgLy8gTm8gbWF0Y2ggLSB3ZSdyZSBzdGlsbCBpbiB0aGUgbWVzc2FnZVxuICAgIGxhc3RNZXNzYWdlTGluZSA9IGk7XG4gICAgZW50cmllcyA9IFtdO1xuICB9XG4gIGNvbnN0IG1lc3NhZ2UgPSBsaW5lcy5zbGljZSgwLCBsYXN0TWVzc2FnZUxpbmUgKyAxKS5qb2luKCdcXG4nKTtcbiAgcmV0dXJuIHttZXNzYWdlLCBlbnRyaWVzfTtcbn1cbiJdLCJtYXBwaW5ncyI6IkFBVUEsWUFBWTs7QUFBQ0EsTUFBQSxDQUFBQyxjQUFBLENBQUFDLE9BQUE7RUFBQUMsS0FBQTtBQUFBO0FBQUFELE9BQUEsQ0FBQUUsT0FBQSxHQUFBQyxnQkFBQTtBQTBEYixJQUFNQyxRQUFRLEdBQ1osdUVBQXVFO0FBSXpFLElBQU1DLFVBQVUsR0FBRyxpQ0FBaUM7QUFDcEQsSUFBTUMscUJBQXFCLEdBQUcsYUFBYTtBQUUzQyxTQUFTQywyQkFBMkJBLENBQUNDLFNBQWlCLEVBQVc7RUFFL0QsT0FBT0EsU0FBUyxLQUFLLHFCQUFxQjtBQUM1QztBQUVBLFNBQVNDLFNBQVNBLENBQUNDLElBQVksRUFBcUI7RUFDbEQsSUFBTUMsT0FBTyxHQUFHRCxJQUFJLENBQUNFLEtBQUssQ0FBQ1IsUUFBUSxDQUFDO0VBQ3BDLElBQUlPLE9BQU8sRUFBRTtJQUNYLE9BQU87TUFDTEUsSUFBSSxFQUFFLE9BQU87TUFDYkMsWUFBWSxFQUFFSCxPQUFPLENBQUMsQ0FBQyxDQUFDO01BQ3hCSSxRQUFRLEVBQ05KLE9BQU8sQ0FBQyxDQUFDLENBQUMsS0FBSyxRQUFRLEdBQ25CO1FBQUNFLElBQUksRUFBRTtNQUFRLENBQUMsR0FDaEJGLE9BQU8sQ0FBQyxDQUFDLENBQUMsS0FBSyxhQUFhLEdBQzFCSiwyQkFBMkIsQ0FBQ0ksT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQ3JDO1FBQ0VFLElBQUksRUFBRSxtQkFBbUI7UUFDekJMLFNBQVMs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