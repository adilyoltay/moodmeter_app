5acd6162c07187899f67bbd54f503789
var _syncHeuristics = require("../../utils/syncHeuristics");
describe('sync heuristics - determineConcurrency', function () {
  test('defaults to 2', function () {
    expect((0, _syncHeuristics.determineConcurrency)(80, 800, 5)).toBe(2);
  });
  test('upscales to 3 on good metrics and some queue', function () {
    expect((0, _syncHeuristics.determineConcurrency)(92, 350, 20)).toBe(3);
  });
  test('upscales to 4 on excellent metrics and large queue', function () {
    expect((0, _syncHeuristics.determineConcurrency)(97, 250, 150)).toBe(4);
  });
  test('downscales to 1 on poor metrics', function () {
    expect((0, _syncHeuristics.determineConcurrency)(55, 1300, 50)).toBe(1);
  });
  test('caps within 1..4', function () {
    expect((0, _syncHeuristics.determineConcurrency)(999, -10, 10000)).toBe(4);
    expect((0, _syncHeuristics.determineConcurrency)(-10, 99999, 0)).toBe(1);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfc3luY0hldXJpc3RpY3MiLCJyZXF1aXJlIiwiZGVzY3JpYmUiLCJ0ZXN0IiwiZXhwZWN0IiwiZGV0ZXJtaW5lQ29uY3VycmVuY3kiLCJ0b0JlIl0sInNvdXJjZXMiOlsic3luY19oZXVyaXN0aWNzLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGV0ZXJtaW5lQ29uY3VycmVuY3kgfSBmcm9tICdAL3V0aWxzL3N5bmNIZXVyaXN0aWNzJztcblxuZGVzY3JpYmUoJ3N5bmMgaGV1cmlzdGljcyAtIGRldGVybWluZUNvbmN1cnJlbmN5JywgKCkgPT4ge1xuICB0ZXN0KCdkZWZhdWx0cyB0byAyJywgKCkgPT4ge1xuICAgIGV4cGVjdChkZXRlcm1pbmVDb25jdXJyZW5jeSg4MCwgODAwLCA1KSkudG9CZSgyKTtcbiAgfSk7XG4gIHRlc3QoJ3Vwc2NhbGVzIHRvIDMgb24gZ29vZCBtZXRyaWNzIGFuZCBzb21lIHF1ZXVlJywgKCkgPT4ge1xuICAgIGV4cGVjdChkZXRlcm1pbmVDb25jdXJyZW5jeSg5MiwgMzUwLCAyMCkpLnRvQmUoMyk7XG4gIH0pO1xuICB0ZXN0KCd1cHNjYWxlcyB0byA0IG9uIGV4Y2VsbGVudCBtZXRyaWNzIGFuZCBsYXJnZSBxdWV1ZScsICgpID0+IHtcbiAgICBleHBlY3QoZGV0ZXJtaW5lQ29uY3VycmVuY3koOTcsIDI1MCwgMTUwKSkudG9CZSg0KTtcbiAgfSk7XG4gIHRlc3QoJ2Rvd25zY2FsZXMgdG8gMSBvbiBwb29yIG1ldHJpY3MnLCAoKSA9PiB7XG4gICAgZXhwZWN0KGRldGVybWluZUNvbmN1cnJlbmN5KDU1LCAxMzAwLCA1MCkpLnRvQmUoMSk7XG4gIH0pO1xuICB0ZXN0KCdjYXBzIHdpdGhpbiAxLi40JywgKCkgPT4ge1xuICAgIGV4cGVjdChkZXRlcm1pbmVDb25jdXJyZW5jeSg5OTksIC0xMCwgMTAwMDApKS50b0JlKDQpO1xuICAgIGV4cGVjdChkZXRlcm1pbmVDb25jdXJyZW5jeSgtMTAsIDk5OTk5LCAwKSkudG9CZSgxKTtcbiAgfSk7XG59KTtcblxuIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFBQSxlQUFBLEdBQUFDLE9BQUE7QUFFQUMsUUFBUSxDQUFDLHdDQUF3QyxFQUFFLFlBQU07RUFDdkRDLElBQUksQ0FBQyxlQUFlLEVBQUUsWUFBTTtJQUMxQkMsTUFBTSxDQUFDLElBQUFDLG9DQUFvQixFQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQztFQUNsRCxDQUFDLENBQUM7RUFDRkgsSUFBSSxDQUFDLDhDQUE4QyxFQUFFLFlBQU07SUFDekRDLE1BQU0sQ0FBQyxJQUFBQyxvQ0FBb0IsRUFBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUNDLElBQUksQ0FBQyxDQUFDLENBQUM7RUFDbkQsQ0FBQyxDQUFDO0VBQ0ZILElBQUksQ0FBQyxvREFBb0QsRUFBRSxZQUFNO0lBQy9EQyxNQUFNLENBQUMsSUFBQUMsb0NBQW9CLEVBQUMsRUFBRSxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0VBQ3BELENBQUMsQ0FBQztFQUNGSCxJQUFJLENBQUMsaUNBQWlDLEVBQUUsWUFBTTtJQUM1Q0MsTUFBTSxDQUFDLElBQUFDLG9DQUFvQixFQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQztFQUNwRCxDQUFDLENBQUM7RUFDRkgsSUFBSSxDQUFDLGtCQUFrQixFQUFFLFlBQU07SUFDN0JDLE1BQU0sQ0FBQyxJQUFBQyxvQ0FBb0IsRUFBQyxHQUFHLEVBQUUsQ0FBQyxFQUFFLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUNyREYsTUFBTSxDQUFDLElBQUFDLG9DQUFvQixFQUFDLENBQUMsRUFBRSxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0VBQ3JELENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==