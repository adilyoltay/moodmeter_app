83226d0ec0d616de8d03b5a651368e08
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.scrollTo = scrollTo;
var _jestMatcherUtils = require("jest-matcher-utils");
var _errors = require("../../helpers/errors");
var _hostComponentNames = require("../../helpers/host-component-names");
var _object = require("../../helpers/object");
var _nativeState = require("../../native-state");
var _eventBuilder = require("../event-builder");
var _utils = require("../utils");
var _utils2 = require("./utils");
function scrollTo(_x, _x2) {
  return _scrollTo.apply(this, arguments);
}
function _scrollTo() {
  _scrollTo = (0, _asyncToGenerator2.default)(function* (element, options) {
    var _options$contentSize$, _options$contentSize, _options$contentSize$2, _options$contentSize2, _nativeState$nativeSt, _dragSteps$at, _ref, _momentumSteps$at;
    if (!(0, _hostComponentNames.isHostScrollView)(element)) {
      throw new _errors.ErrorWithStack(`scrollTo() works only with host "ScrollView" elements. Passed element has type "${element.type}".`, scrollTo);
    }
    ensureScrollViewDirection(element, options);
    yield (0, _utils.dispatchEvent)(element, 'contentSizeChange', (_options$contentSize$ = (_options$contentSize = options.contentSize) == null ? void 0 : _options$contentSize.width) != null ? _options$contentSize$ : 0, (_options$contentSize$2 = (_options$contentSize2 = options.contentSize) == null ? void 0 : _options$contentSize2.height) != null ? _options$contentSize$2 : 0);
    var initialOffset = (_nativeState$nativeSt = _nativeState.nativeState.contentOffsetForElement.get(element)) != null ? _nativeState$nativeSt : {
      x: 0,
      y: 0
    };
    var dragSteps = (0, _utils2.createScrollSteps)({
      y: options.y,
      x: options.x
    }, initialOffset, _utils2.linearInterpolator);
    yield emitDragScrollEvents(this.config, element, dragSteps, options);
    var momentumStart = (_dragSteps$at = dragSteps.at(-1)) != null ? _dragSteps$at : initialOffset;
    var momentumSteps = (0, _utils2.createScrollSteps)({
      y: options.momentumY,
      x: options.momentumX
    }, momentumStart, _utils2.inertialInterpolator);
    yield emitMomentumScrollEvents(this.config, element, momentumSteps, options);
    var finalOffset = (_ref = (_momentumSteps$at = momentumSteps.at(-1)) != null ? _momentumSteps$at : dragSteps.at(-1)) != null ? _ref : initialOffset;
    _nativeState.nativeState.contentOffsetForElement.set(element, finalOffset);
  });
  return _scrollTo.apply(this, arguments);
}
function emitDragScrollEvents(_x3, _x4, _x5, _x6) {
  return _emitDragScrollEvents.apply(this, arguments);
}
function _emitDragScrollEvents() {
  _emitDragScrollEvents = (0, _asyncToGenerator2.default)(function* (config, element, scrollSteps, scrollOptions) {
    if (scrollSteps.length === 0) {
      return;
    }
    yield (0, _utils.wait)(config);
    yield (0, _utils.dispatchEvent)(element, 'scrollBeginDrag', _eventBuilder.EventBuilder.ScrollView.scroll(scrollSteps[0], scrollOptions));
    for (var i = 1; i < scrollSteps.length - 1; i += 1) {
      yield (0, _utils.wait)(config);
      yield (0, _utils.dispatchEvent)(element, 'scroll', _eventBuilder.EventBuilder.ScrollView.scroll(scrollSteps[i], scrollOptions));
    }
    yield (0, _utils.wait)(config);
    var lastStep = scrollSteps.at(-1);
    yield (0, _utils.dispatchEvent)(element, 'scrollEndDrag', _eventBuilder.EventBuilder.ScrollView.scroll(lastStep, scrollOptions));
  });
  return _emitDragScrollEvents.apply(this, arguments);
}
function emitMomentumScrollEvents(_x7, _x8, _x9, _x0) {
  return _emitMomentumScrollEvents.apply(this, arguments);
}
function _emitMomentumScrollEvents() {
  _emitMomentumScrollEvents = (0, _asyncToGenerator2.default)(function* (config, element, scrollSteps, scrollOptions) {
    if (scrollSteps.length === 0) {
      return;
    }
    yield (0, _utils.wait)(config);
    yield (0, _utils.dispatchEvent)(element, 'momentumScrollBegin', _eventBuilder.EventBuilder.ScrollView.scroll(scrollSteps[0], scrollOptions));
    for (var i = 1; i < scrollSteps.length; i += 1) {
      yield (0, _utils.wait)(config);
      yield (0, _utils.dispatchEvent)(element, 'scroll', _eventBuilder.EventBuilder.ScrollView.scroll(scrollSteps[i], scrollOptions));
    }
    yield (0, _utils.wait)(config);
    var lastStep = scrollSteps.at(-1);
    yield (0, _utils.dispatchEvent)(element, 'momentumScrollEnd', _eventBuilder.EventBuilder.ScrollView.scroll(lastStep, scrollOptions));
  });
  return _emitMomentumScrollEvents.apply(this, arguments);
}
function ensureScrollViewDirection(element, options) {
  var isVerticalScrollView = element.props.horizontal !== true;
  var hasHorizontalScrollOptions = options.x !== undefined || options.momentumX !== undefined;
  if (isVerticalScrollView && hasHorizontalScrollOptions) {
    throw new _errors.ErrorWithStack(`scrollTo() expected only vertical scroll options: "y" and "momentumY" for vertical "ScrollView" element but received ${(0, _jestMatcherUtils.stringify)((0, _object.pick)(options, ['x', 'momentumX']))}`, scrollTo);
  }
  var hasVerticalScrollOptions = options.y !== undefined || options.momentumY !== undefined;
  if (!isVerticalScrollView && hasVerticalScrollOptions) {
    throw new _errors.ErrorWithStack(`scrollTo() expected only horizontal scroll options: "x" and "momentumX" for horizontal "ScrollView" element but received ${(0, _jestMatcherUtils.stringify)((0, _object.pick)(options, ['y', 'momentumY']))}`, scrollTo);
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfamVzdE1hdGNoZXJVdGlscyIsInJlcXVpcmUiLCJfZXJyb3JzIiwiX2hvc3RDb21wb25lbnROYW1lcyIsIl9vYmplY3QiLCJfbmF0aXZlU3RhdGUiLCJfZXZlbnRCdWlsZGVyIiwiX3V0aWxzIiwiX3V0aWxzMiIsInNjcm9sbFRvIiwiX3giLCJfeDIiLCJfc2Nyb2xsVG8iLCJhcHBseSIsImFyZ3VtZW50cyIsIl9hc3luY1RvR2VuZXJhdG9yMiIsImRlZmF1bHQiLCJlbGVtZW50Iiwib3B0aW9ucyIsIl9vcHRpb25zJGNvbnRlbnRTaXplJCIsIl9vcHRpb25zJGNvbnRlbnRTaXplIiwiX29wdGlvbnMkY29udGVudFNpemUkMiIsIl9vcHRpb25zJGNvbnRlbnRTaXplMiIsIl9uYXRpdmVTdGF0ZSRuYXRpdmVTdCIsIl9kcmFnU3RlcHMkYXQiLCJfcmVmIiwiX21vbWVudHVtU3RlcHMkYXQiLCJpc0hvc3RTY3JvbGxWaWV3IiwiRXJyb3JXaXRoU3RhY2siLCJ0eXBlIiwiZW5zdXJlU2Nyb2xsVmlld0RpcmVjdGlvbiIsImRpc3BhdGNoRXZlbnQiLCJjb250ZW50U2l6ZSIsIndpZHRoIiwiaGVpZ2h0IiwiaW5pdGlhbE9mZnNldCIsIm5hdGl2ZVN0YXRlIiwiY29udGVudE9mZnNldEZvckVsZW1lbnQiLCJnZXQiLCJ4IiwieSIsImRyYWdTdGVwcyIsImNyZWF0ZVNjcm9sbFN0ZXBzIiwibGluZWFySW50ZXJwb2xhdG9yIiwiZW1pdERyYWdTY3JvbGxFdmVudHMiLCJjb25maWciLCJtb21lbnR1bVN0YXJ0IiwiYXQiLCJtb21lbnR1bVN0ZXBzIiwibW9tZW50dW1ZIiwibW9tZW50dW1YIiwiaW5lcnRpYWxJbnRlcnBvbGF0b3IiLCJlbWl0TW9tZW50dW1TY3JvbGxFdmVudHMiLCJmaW5hbE9mZnNldCIsInNldCIsIl94MyIsIl94NCIsIl94NSIsIl94NiIsIl9lbWl0RHJhZ1Njcm9sbEV2ZW50cyIsInNjcm9sbFN0ZXBzIiwic2Nyb2xsT3B0aW9ucyIsImxlbmd0aCIsIndhaXQiLCJFdmVudEJ1aWxkZXIiLCJTY3JvbGxWaWV3Iiwic2Nyb2xsIiwiaSIsImxhc3RTdGVwIiwiX3g3IiwiX3g4IiwiX3g5IiwiX3gwIiwiX2VtaXRNb21lbnR1bVNjcm9sbEV2ZW50cyIsImlzVmVydGljYWxTY3JvbGxWaWV3IiwicHJvcHMiLCJob3Jpem9udGFsIiwiaGFzSG9yaXpvbnRhbFNjcm9sbE9wdGlvbnMiLCJ1bmRlZmluZWQiLCJzdHJpbmdpZnkiLCJwaWNrIiwiaGFzVmVydGljYWxTY3JvbGxPcHRpb25zIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3VzZXItZXZlbnQvc2Nyb2xsL3Njcm9sbC10by50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IFJlYWN0VGVzdEluc3RhbmNlIH0gZnJvbSAncmVhY3QtdGVzdC1yZW5kZXJlcic7XG5pbXBvcnQgeyBzdHJpbmdpZnkgfSBmcm9tICdqZXN0LW1hdGNoZXItdXRpbHMnO1xuXG5pbXBvcnQgeyBFcnJvcldpdGhTdGFjayB9IGZyb20gJy4uLy4uL2hlbHBlcnMvZXJyb3JzJztcbmltcG9ydCB7IGlzSG9zdFNjcm9sbFZpZXcgfSBmcm9tICcuLi8uLi9oZWxwZXJzL2hvc3QtY29tcG9uZW50LW5hbWVzJztcbmltcG9ydCB7IHBpY2sgfSBmcm9tICcuLi8uLi9oZWxwZXJzL29iamVjdCc7XG5pbXBvcnQgeyBuYXRpdmVTdGF0ZSB9IGZyb20gJy4uLy4uL25hdGl2ZS1zdGF0ZSc7XG5pbXBvcnQgdHlwZSB7IFBvaW50LCBTaXplIH0gZnJvbSAnLi4vLi4vdHlwZXMnO1xuaW1wb3J0IHsgRXZlbnRCdWlsZGVyIH0gZnJvbSAnLi4vZXZlbnQtYnVpbGRlcic7XG5pbXBvcnQgdHlwZSB7IFVzZXJFdmVudENvbmZpZywgVXNlckV2ZW50SW5zdGFuY2UgfSBmcm9tICcuLi9zZXR1cCc7XG5pbXBvcnQgeyBkaXNwYXRjaEV2ZW50LCB3YWl0IH0gZnJvbSAnLi4vdXRpbHMnO1xuaW1wb3J0IHsgY3JlYXRlU2Nyb2xsU3RlcHMsIGluZXJ0aWFsSW50ZXJwb2xhdG9yLCBsaW5lYXJJbnRlcnBvbGF0b3IgfSBmcm9tICcuL3V0aWxzJztcblxuaW50ZXJmYWNlIENvbW1vblNjcm9sbFRvT3B0aW9ucyB7XG4gIGNvbnRlbnRTaXplPzogU2l6ZTtcbiAgbGF5b3V0TWVhc3VyZW1lbnQ/OiBTaXplO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZlcnRpY2FsU2Nyb2xsVG9PcHRpb25zIGV4dGVuZHMgQ29tbW9uU2Nyb2xsVG9PcHRpb25zIHtcbiAgeTogbnVtYmVyO1xuICBtb21lbnR1bVk/OiBudW1iZXI7XG5cbiAgLy8gVmVydGljYWwgc2Nyb2xsIHNob3VsZCBub3QgY29udGFpbiBob3Jpem9udGFsIHNjcm9sbCBwYXJ0LlxuICB4PzogbmV2ZXI7XG4gIG1vbWVudHVtWD86IG5ldmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEhvcml6b250YWxTY3JvbGxUb09wdGlvbnMgZXh0ZW5kcyBDb21tb25TY3JvbGxUb09wdGlvbnMge1xuICB4OiBudW1iZXI7XG4gIG1vbWVudHVtWD86IG51bWJlcjtcblxuICAvLyBIb3Jpem9udGFsIHNjcm9sbCBzaG91bGQgbm90IGNvbnRhaW4gdmVydGljYWwgc2Nyb2xsIHBhcnQuXG4gIHk/OiBuZXZlcjtcbiAgbW9tZW50dW1ZPzogbmV2ZXI7XG59XG5cbmV4cG9ydCB0eXBlIFNjcm9sbFRvT3B0aW9ucyA9IFZlcnRpY2FsU2Nyb2xsVG9PcHRpb25zIHwgSG9yaXpvbnRhbFNjcm9sbFRvT3B0aW9ucztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNjcm9sbFRvKFxuICB0aGlzOiBVc2VyRXZlbnRJbnN0YW5jZSxcbiAgZWxlbWVudDogUmVhY3RUZXN0SW5zdGFuY2UsXG4gIG9wdGlvbnM6IFNjcm9sbFRvT3B0aW9ucyxcbik6IFByb21pc2U8dm9pZD4ge1xuICBpZiAoIWlzSG9zdFNjcm9sbFZpZXcoZWxlbWVudCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3JXaXRoU3RhY2soXG4gICAgICBgc2Nyb2xsVG8oKSB3b3JrcyBvbmx5IHdpdGggaG9zdCBcIlNjcm9sbFZpZXdcIiBlbGVtZW50cy4gUGFzc2VkIGVsZW1lbnQgaGFzIHR5cGUgXCIke2VsZW1lbnQudHlwZX1cIi5gLFxuICAgICAgc2Nyb2xsVG8sXG4gICAgKTtcbiAgfVxuXG4gIGVuc3VyZVNjcm9sbFZpZXdEaXJlY3Rpb24oZWxlbWVudCwgb3B0aW9ucyk7XG5cbiAgYXdhaXQgZGlzcGF0Y2hFdmVudChcbiAgICBlbGVtZW50LFxuICAgICdjb250ZW50U2l6ZUNoYW5nZScsXG4gICAgb3B0aW9ucy5jb250ZW50U2l6ZT8ud2lkdGggPz8gMCxcbiAgICBvcHRpb25zLmNvbnRlbnRTaXplPy5oZWlnaHQgPz8gMCxcbiAgKTtcblxuICBjb25zdCBpbml0aWFsT2Zmc2V0ID0gbmF0aXZlU3RhdGUuY29udGVudE9mZnNldEZvckVsZW1lbnQuZ2V0KGVsZW1lbnQpID8/IHsgeDogMCwgeTogMCB9O1xuICBjb25zdCBkcmFnU3RlcHMgPSBjcmVhdGVTY3JvbGxTdGVwcyhcbiAgICB7IHk6IG9wdGlvbnMueSwgeDogb3B0aW9ucy54IH0sXG4gICAgaW5pdGlhbE9mZnNldCxcbiAgICBsaW5lYXJJbnRlcnBvbGF0b3IsXG4gICk7XG4gIGF3YWl0IGVtaXREcmFnU2Nyb2xsRXZlbnRzKHRoaXMuY29uZmlnLCBlbGVtZW50LCBkcmFnU3RlcHMsIG9wdGlvbnMpO1xuXG4gIGNvbnN0IG1vbWVudHVtU3RhcnQgPSBkcmFnU3RlcHMuYXQoLTEpID8/IGluaXRpYWxPZmZzZXQ7XG4gIGNvbnN0IG1vbWVudHVtU3RlcHMgPSBjcmVhdGVTY3JvbGxTdGVwcyhcbiAgICB7IHk6IG9wdGlvbnMubW9tZW50dW1ZLCB4OiBvcHRpb25zLm1vbWVudHVtWCB9LFxuICAgIG1vbWVudHVtU3RhcnQsXG4gICAgaW5lcnRpYWxJbnRlcnBvbGF0b3IsXG4gICk7XG4gIGF3YWl0IGVtaXRNb21lbnR1bVNjcm9sbEV2ZW50cyh0aGlzLmNvbmZpZywgZWxlbWVudCwgbW9tZW50dW1TdGVwcywgb3B0aW9ucyk7XG5cbiAgY29uc3QgZmluYWxPZmZzZXQgPSBtb21lbnR1bVN0ZXBzLmF0KC0xKSA/PyBkcmFnU3RlcHMuYXQoLTEpID8/IGluaXRpYWxPZmZzZXQ7XG4gIG5hdGl2ZVN0YXRlLmNvbnRlbnRPZmZzZXRGb3JFbGVtZW50LnNldChlbGVtZW50LCBmaW5hbE9mZnNldCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGVtaXREcmFnU2Nyb2xsRXZlbnRzKFxuICBjb25maWc6IFVzZXJFdmVudENvbmZpZyxcbiAgZWxlbWVudDogUmVhY3RUZXN0SW5zdGFuY2UsXG4gIHNjcm9sbFN0ZXBzOiBQb2ludFtdLFxuICBzY3JvbGxPcHRpb25zOiBTY3JvbGxUb09wdGlvbnMsXG4pIHtcbiAgaWYgKHNjcm9sbFN0ZXBzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGF3YWl0IHdhaXQoY29uZmlnKTtcbiAgYXdhaXQgZGlzcGF0Y2hFdmVudChcbiAgICBlbGVtZW50LFxuICAgICdzY3JvbGxCZWdpbkRyYWcnLFxuICAgIEV2ZW50QnVpbGRlci5TY3JvbGxWaWV3LnNjcm9sbChzY3JvbGxTdGVwc1swXSwgc2Nyb2xsT3B0aW9ucyksXG4gICk7XG5cbiAgLy8gTm90ZTogZXhwZXJpbWVudGFsbHksIGluIGNhc2Ugb2YgZHJhZyBzY3JvbGwgdGhlIGxhc3Qgc2Nyb2xsIHN0ZXBcbiAgLy8gd2lsbCBub3QgdHJpZ2dlciBgc2Nyb2xsYCBldmVudC5cbiAgLy8gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vY2FsbHN0YWNrL3JlYWN0LW5hdGl2ZS10ZXN0aW5nLWxpYnJhcnkvd2lraS9TY3JvbGxWaWV3LUV2ZW50c1xuICBmb3IgKGxldCBpID0gMTsgaSA8IHNjcm9sbFN0ZXBzLmxlbmd0aCAtIDE7IGkgKz0gMSkge1xuICAgIGF3YWl0IHdhaXQoY29uZmlnKTtcbiAgICBhd2FpdCBkaXNwYXRjaEV2ZW50KFxuICAgICAgZWxlbWVudCxcbiAgICAgICdzY3JvbGwnLFxuICAgICAgRXZlbnRCdWlsZGVyLlNjcm9sbFZpZXcuc2Nyb2xsKHNjcm9sbFN0ZXBzW2ldLCBzY3JvbGxPcHRpb25zKSxcbiAgICApO1xuICB9XG5cbiAgYXdhaXQgd2FpdChjb25maWcpO1xuICBjb25zdCBsYXN0U3RlcCA9IHNjcm9sbFN0ZXBzLmF0KC0xKTtcbiAgYXdhaXQgZGlzcGF0Y2hFdmVudChcbiAgICBlbGVtZW50LFxuICAgICdzY3JvbGxFbmREcmFnJyxcbiAgICBFdmVudEJ1aWxkZXIuU2Nyb2xsVmlldy5zY3JvbGwobGFzdFN0ZXAsIHNjcm9sbE9wdGlvbnMpLFxuICApO1xufVxuXG5hc3luYyBmdW5jdGlvbiBlbWl0TW9tZW50dW1TY3JvbGxFdmVudHMoXG4gIGNvbmZpZzogVXNlckV2ZW50Q29uZmlnLFxuICBlbGVtZW50OiBSZWFjdFRlc3RJbnN0YW5jZSxcbiAgc2Nyb2xsU3RlcHM6IFBvaW50W10sXG4gIHNjcm9sbE9wdGlvbnM6IFNjcm9sbFRvT3B0aW9ucyxcbikge1xuICBpZiAoc2Nyb2xsU3RlcHMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgYXdhaXQgd2FpdChjb25maWcpO1xuICBhd2FpdCBkaXNwYXRjaEV2ZW50KFxuICAgIGVsZW1lbnQsXG4gICAgJ21vbWVudHVtU2Nyb2xsQmVnaW4nLFxuICAgIEV2ZW50QnVpbGRlci5TY3JvbGxWaWV3LnNjcm9sbChzY3JvbGxTdGVwc1swXSwgc2Nyb2xsT3B0aW9ucyksXG4gICk7XG5cbiAgLy8gTm90ZTogZXhwZXJpbWVudGFsbHksIGluIGNhc2Ugb2YgbW9tZW50dW0gc2Nyb2xsIHRoZSBsYXN0IHNjcm9sbCBzdGVwXG4gIC8vIHdpbGwgdHJpZ2dlciBgc2Nyb2xsYCBldmVudC5cbiAgLy8gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vY2FsbHN0YWNrL3JlYWN0LW5hdGl2ZS10ZXN0aW5nLWxpYnJhcnkvd2lraS9TY3JvbGxWaWV3LUV2ZW50c1xuICBmb3IgKGxldCBpID0gMTsgaSA8IHNjcm9sbFN0ZXBzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgYXdhaXQgd2FpdChjb25maWcpO1xuICAgIGF3YWl0IGRpc3BhdGNoRXZlbnQoXG4gICAgICBlbGVtZW50LFxuICAgICAgJ3Njcm9sbCcsXG4gICAgICBFdmVudEJ1aWxkZXIuU2Nyb2xsVmlldy5zY3JvbGwoc2Nyb2xsU3RlcHNbaV0sIHNjcm9sbE9wdGlvbnMpLFxuICAgICk7XG4gIH1cblxuICBhd2FpdCB3YWl0KGNvbmZpZyk7XG4gIGNvbnN0IGxhc3RTdGVwID0gc2Nyb2xsU3RlcHMuYXQoLTEpO1xuICBhd2FpdCBkaXNwYXRjaEV2ZW50KFxuICAgIGVsZW1lbnQsXG4gICAgJ21vbWVudHVtU2Nyb2xsRW5kJyxcbiAgICBFdmVudEJ1aWxkZXIuU2Nyb2xsVmlldy5zY3JvbGwobGFzdFN0ZXAsIHNjcm9sbE9wdGlvbnMpLFxuICApO1xufVxuXG5mdW5jdGlvbiBlbnN1cmVTY3JvbGxWaWV3RGlyZWN0aW9uKGVsZW1lbnQ6IFJlYWN0VGVzdEluc3RhbmNlLCBvcHRpb25zOiBTY3JvbGxUb09wdGlvbnMpIHtcbiAgY29uc3QgaXNWZXJ0aWNhbFNjcm9sbFZpZXcgPSBlbGVtZW50LnByb3BzLmhvcml6b250YWwgIT09IHRydWU7XG5cbiAgY29uc3QgaGFzSG9yaXpvbnRhbFNjcm9sbE9wdGlvbnMgPSBvcHRpb25zLnggIT09IHVuZGVmaW5lZCB8fCBvcHRpb25zLm1vbWVudHVtWCAhPT0gdW5kZWZpbmVkO1xuICBpZiAoaXNWZXJ0aWNhbFNjcm9sbFZpZXcgJiYgaGFzSG9yaXpvbnRhbFNjcm9sbE9wdGlvbnMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3JXaXRoU3RhY2soXG4gICAgICBgc2Nyb2xsVG8oKSBleHBlY3RlZCBvbmx5IHZlcnRpY2FsIHNjcm9sbCBvcHRpb25zOiBcInlcIiBhbmQgXCJtb21lbnR1bVlcIiBmb3IgdmVydGljYWwgXCJTY3JvbGxWaWV3XCIgZWxlbWVudCBidXQgcmVjZWl2ZWQgJHtzdHJpbmdpZnkoXG4gICAgICAgIHBpY2sob3B0aW9ucywgWyd4JywgJ21vbWVudHVtWCddKSxcbiAgICAgICl9YCxcbiAgICAgIHNjcm9sbFRvLFxuICAgICk7XG4gIH1cblxuICBjb25zdCBoYXNWZXJ0aWNhbFNjcm9sbE9wdGlvbnMgPSBvcHRpb25zLnkgIT09IHVuZGVmaW5lZCB8fCBvcHRpb25zLm1vbWVudHVtWSAhPT0gdW5kZWZpbmVkO1xuICBpZiAoIWlzVmVydGljYWxTY3JvbGxWaWV3ICYmIGhhc1ZlcnRpY2FsU2Nyb2xsT3B0aW9ucykge1xuICAgIHRocm93IG5ldyBFcnJvcldpdGhTdGFjayhcbiAgICAgIGBzY3JvbGxUbygpIGV4cGVjdGVkIG9ubHkgaG9yaXpvbnRhbCBzY3JvbGwgb3B0aW9uczogXCJ4XCIgYW5kIFwibW9tZW50dW1YXCIgZm9yIGhvcml6b250YWwgXCJTY3JvbGxWaWV3XCIgZWxlbWVudCBidXQgcmVjZWl2ZWQgJHtzdHJpbmdpZnkoXG4gICAgICAgIHBpY2sob3B0aW9ucywgWyd5JywgJ21vbWVudHVtWSddKSxcbiAgICAgICl9YCxcbiAgICAgIHNjcm9sbFRvLFxuICAgICk7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFDQSxJQUFBQSxpQkFBQSxHQUFBQyxPQUFBO0FBRUEsSUFBQUMsT0FBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsbUJBQUEsR0FBQUYsT0FBQTtBQUNBLElBQUFHLE9BQUEsR0FBQUgsT0FBQTtBQUNBLElBQUFJLFlBQUEsR0FBQUosT0FBQTtBQUVBLElBQUFLLGFBQUEsR0FBQUwsT0FBQTtBQUVBLElBQUFNLE1BQUEsR0FBQU4sT0FBQTtBQUNBLElBQUFPLE9BQUEsR0FBQVAsT0FBQTtBQUFBLFNBMkJzQlEsUUFBUUEsQ0FBQUMsRUFBQSxFQUFBQyxHQUFBO0VBQUEsT0FBQUMsU0FBQSxDQUFBQyxLQUFBLE9BQUFDLFNBQUE7QUFBQTtBQUFBLFNBQUFGLFVBQUE7RUFBQUEsU0FBQSxPQUFBRyxrQkFBQSxDQUFBQyxPQUFBLEVBQXZCLFdBRUxDLE9BQTBCLEVBQzFC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