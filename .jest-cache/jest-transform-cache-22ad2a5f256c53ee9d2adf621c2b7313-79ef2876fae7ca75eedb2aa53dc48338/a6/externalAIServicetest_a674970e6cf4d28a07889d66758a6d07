8f33c0d8a9763b6c28f3d06e0cc95379
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _externalAIService = require("../../features/ai/services/externalAIService");
describe('externalAIService heuristic fallback', function () {
  it('returns fallback when service disabled', (0, _asyncToGenerator2.default)(function* () {
    _externalAIService.externalAIService.isEnabled = false;
    var res = yield _externalAIService.externalAIService.getAIResponse([{
      id: '1',
      role: 'user',
      content: 'Merhaba',
      timestamp: new Date()
    }], {});
    expect(res.provider).toBe('local');
    expect(res.fallbackUsed).toBeTruthy();
    expect(typeof res.content).toBe('string');
  }));
  it('uses staged timeouts (3/10/30s) config', (0, _asyncToGenerator2.default)(function* () {
    _externalAIService.externalAIService.isEnabled = true;
    var resPromise = _externalAIService.externalAIService.getAIResponse([], {}, {
      maxTokens: 1
    });
    expect(resPromise).resolves.toBeTruthy();
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXh0ZXJuYWxBSVNlcnZpY2UiLCJyZXF1aXJlIiwiZGVzY3JpYmUiLCJpdCIsIl9hc3luY1RvR2VuZXJhdG9yMiIsImRlZmF1bHQiLCJleHRlcm5hbEFJU2VydmljZSIsImlzRW5hYmxlZCIsInJlcyIsImdldEFJUmVzcG9uc2UiLCJpZCIsInJvbGUiLCJjb250ZW50IiwidGltZXN0YW1wIiwiRGF0ZSIsImV4cGVjdCIsInByb3ZpZGVyIiwidG9CZSIsImZhbGxiYWNrVXNlZCIsInRvQmVUcnV0aHkiLCJyZXNQcm9taXNlIiwibWF4VG9rZW5zIiwicmVzb2x2ZXMiXSwic291cmNlcyI6WyJleHRlcm5hbEFJU2VydmljZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4dGVybmFsQUlTZXJ2aWNlIH0gZnJvbSAnQC9mZWF0dXJlcy9haS9zZXJ2aWNlcy9leHRlcm5hbEFJU2VydmljZSc7XG5cbmRlc2NyaWJlKCdleHRlcm5hbEFJU2VydmljZSBoZXVyaXN0aWMgZmFsbGJhY2snLCAoKSA9PiB7XG4gIGl0KCdyZXR1cm5zIGZhbGxiYWNrIHdoZW4gc2VydmljZSBkaXNhYmxlZCcsIGFzeW5jICgpID0+IHtcbiAgICAvLyBAdHMtaWdub3JlIC0gZm9yY2UgZGlzYWJsZWQgc3RhdGVcbiAgICAoZXh0ZXJuYWxBSVNlcnZpY2UgYXMgYW55KS5pc0VuYWJsZWQgPSBmYWxzZTtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBleHRlcm5hbEFJU2VydmljZS5nZXRBSVJlc3BvbnNlKFtcbiAgICAgIHsgaWQ6ICcxJywgcm9sZTogJ3VzZXInLCBjb250ZW50OiAnTWVyaGFiYScsIHRpbWVzdGFtcDogbmV3IERhdGUoKSB9XG4gICAgXSBhcyBhbnksIHt9IGFzIGFueSk7XG4gICAgZXhwZWN0KHJlcy5wcm92aWRlcikudG9CZSgnbG9jYWwnKTtcbiAgICBleHBlY3QocmVzLmZhbGxiYWNrVXNlZCkudG9CZVRydXRoeSgpO1xuICAgIGV4cGVjdCh0eXBlb2YgcmVzLmNvbnRlbnQpLnRvQmUoJ3N0cmluZycpO1xuICB9KTtcblxuICBpdCgndXNlcyBzdGFnZWQgdGltZW91dHMgKDMvMTAvMzBzKSBjb25maWcnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gVGhpcyB0ZXN0IGVuc3VyZXMgY29kZSBwYXRocyBhcmUgcHJlc2VudDsgbm90IG1lYXN1cmluZyByZWFsIHRpbWUuXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIChleHRlcm5hbEFJU2VydmljZSBhcyBhbnkpLmlzRW5hYmxlZCA9IHRydWU7XG4gICAgY29uc3QgcmVzUHJvbWlzZSA9IGV4dGVybmFsQUlTZXJ2aWNlLmdldEFJUmVzcG9uc2UoW10gYXMgYW55LCB7fSBhcyBhbnksIHsgbWF4VG9rZW5zOiAxIH0gYXMgYW55KTtcbiAgICBleHBlY3QocmVzUHJvbWlzZSkucmVzb2x2ZXMudG9CZVRydXRoeSgpO1xuICB9KTtcbn0pO1xuXG5cbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFBQSxrQkFBQSxHQUFBQyxPQUFBO0FBRUFDLFFBQVEsQ0FBQyxzQ0FBc0MsRUFBRSxZQUFNO0VBQ3JEQyxFQUFFLENBQUMsd0NBQXdDLE1BQUFDLGtCQUFBLENBQUFDLE9BQUEsRUFBRSxhQUFZO0lBRXREQyxvQ0FBaUIsQ0FBU0MsU0FBUyxHQUFHLEtBQUs7SUFDNUMsSUFBTUMsR0FBRyxTQUFTRixvQ0FBaUIsQ0FBQ0csYUFBYSxDQUFDLENBQ2hEO01BQUVDLEVBQUUsRUFBRSxHQUFHO01BQUVDLElBQUksRUFBRSxNQUFNO01BQUVDLE9BQU8sRUFBRSxTQUFTO01BQUVDLFNBQVMsRUFBRSxJQUFJQyxJQUFJLENBQUM7SUFBRSxDQUFDLENBQ3JFLEVBQVMsQ0FBQyxDQUFRLENBQUM7SUFDcEJDLE1BQU0sQ0FBQ1AsR0FBRyxDQUFDUSxRQUFRLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLE9BQU8sQ0FBQztJQUNsQ0YsTUFBTSxDQUFDUCxHQUFHLENBQUNVLFlBQVksQ0FBQyxDQUFDQyxVQUFVLENBQUMsQ0FBQztJQUNyQ0osTUFBTSxDQUFDLE9BQU9QLEdBQUcsQ0FBQ0ksT0FBTyxDQUFDLENBQUNLLElBQUksQ0FBQyxRQUFRLENBQUM7RUFDM0MsQ0FBQyxFQUFDO0VBRUZkLEVBQUUsQ0FBQyx3Q0FBd0MsTUFBQUMsa0JBQUEsQ0FBQUMsT0FBQSxFQUFFLGFBQVk7SUFHdERDLG9DQUFpQixDQUFTQyxTQUFTLEdBQUcsSUFBSTtJQUMzQyxJQUFNYSxVQUFVLEdBQUdkLG9DQUFpQixDQUFDRyxhQUFhLENBQUMsRUFBRSxFQUFTLENBQUMsQ0FBQyxFQUFTO01BQUVZLFNBQVMsRUFBRTtJQUFFLENBQVEsQ0FBQztJQUNqR04sTUFBTSxDQUFDSyxVQUFVLENBQUMsQ0FBQ0UsUUFBUSxDQUFDSCxVQUFVLENBQUMsQ0FBQztFQUMxQyxDQUFDLEVBQUM7QUFDSixDQUFDLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=